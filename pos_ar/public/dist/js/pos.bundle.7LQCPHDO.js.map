{
  "version": 3,
  "sources": ["../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/posController.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_item_selector.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_customer_box.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_selected_item_cart.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_item_details.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_payment_cart.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_history.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_db.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_settings.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_check_in_out.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/data/posSettingsData.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/data/posAppData.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/remoteApi/FetchHandler.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_debt_cart.js"],
  "sourcesContent": ["pos_ar.PointOfSale.Controller = class {\n        constructor(wrapper) {\n\t\t//principales variable\n                this.wrapper = $(wrapper).find(\".layout-main-section\");\n                this.page    = wrapper.page ;\n\n\n                this.selectedItemMaps  = new Map()\n\n                this.selectedItem               = {\"name\"       : \"\"   }\n                this.selectedField              = {\"field_name\" : \"\"   }\n                this.selectedTab                = {\"tabName\"    : \"\"   }\n\t\tthis.selectedPaymentMethod      = {\"methodName\" : \"\"   }\n\t\tthis.defaultCustomer            = {\"name\"       : \"\" , \"customer_name\" : \"\"}\n\t\tthis.defaultPriceList           = {\"name\"       : \"\"   }\n\t\tthis.taxes_and_charges_template = null;\n\t\tthis.taxes_and_charges          = [];\n\t\tthis.payment_methods            = []\n\n\t\t//sell invoice\n\t\tthis.POSOpeningEntry = {}\n\n\t\tthis.invoiceData = { netTotal : 0 , grandTotal : 0 , paidAmount : 0 , toChange : 0 , discount : 0}\n\t\tthis.db          = null;\n\n                this.start_app();\n        }\n\n\t async start_app(){\n\t\ttry{\n\t\t\t//init db\n\t\t\tthis.db            = await pos_ar.PointOfSale.pos_db.openDatabase();\n\t\t\t//data classes\n\t\t\tthis.settings_data = new pos_ar.PointOfSale.posSettingsData(this.db)\n\t\t\t//api fetch handler\n\t\t\tthis.dataHandler   = new pos_ar.PointOfSale.FetchHandler()\n\t\t\t//local app data\n\t\t\tthis.appData       = new pos_ar.PointOfSale.posAppData(this.db , this.dataHandler)\n\t\t\tawait this.appData.getAllData()\n\n\t\t\tthis.toggleKeyboardMode(!this.settings_data.settings.showItemDetails);\n\n\t\t\tconsole.log(\"see app data : \" , this.appData.appData)\n\n\t\t\tthis.prepare_container();\n\t\t\t//prepare app data\n\t\t\tawait  this.prepare_app_data();\n\n\t\t\t//proceed with other initialization only if app data are set correctly\n\t\t\tawait  this.checkForPOSEntry()\n\t\t\tawait  this.prepare_components();\n\t\t\tthis.checkUnSyncedPos();\n\t\t\tthis.setListeners();\n\t\t}catch(err){\n\t\t\tconsole.error(\"halfware POS Err ==> \" , err)\n\t\t}\n\t}\n\n\tasync prepare_app_data(){\n\t\ttry{\n\n\t\t\tawait this.handleAppData();\n\n\t\t\tlet new_pos_invoice               = frappe.model.get_new_doc('POS Invoice');\n\t\t\tnew_pos_invoice.customer          = this.defaultCustomer.name\n\t\t\tnew_pos_invoice.pos_profile       = this.appData.appData.pos_profile.name\n\t\t\tnew_pos_invoice.items             = [];\n\t\t\tnew_pos_invoice.taxes_and_charges = this.appData.appData.pos_profile.taxes_and_charges\n\t\t\tnew_pos_invoice.additional_discount_percentage = 0\n\t\t\tnew_pos_invoice.paid_amount       = 0\n\t\t\tnew_pos_invoice.base_paid_amount  = 0\n\t\t\tnew_pos_invoice.creation_time     = frappe.datetime.now_datetime()\n\t\t\tnew_pos_invoice.payments          = this.getPaymentMethods()\n\t\t\tnew_pos_invoice.is_pos            = 1\n\t\t\tnew_pos_invoice.update_stock      = 1\n\t\t\tnew_pos_invoice.docstatus         = 0\n\t\t\tnew_pos_invoice.status            = 'Draft'\n\t\t\tnew_pos_invoice.priceList         = this.defaultPriceList.name\n\t\t\t//build refNm   posProfile-date-time\n\t\t\tconst date = new Date()\n\t\t\tconst [year,month,day] = date.toISOString().split('T')[0].split('-')\n\t\t\tconst hour    = date.getHours()\n\t\t\tconst minutes = date.getMinutes()\n\t\t\tconst seconds = date.getMilliseconds()\n\t\t\tnew_pos_invoice.refNum            = this.appData.appData.pos_profile.name+\"-\"+year+'-'+month+'-'+day+'-'+hour+minutes+seconds\n\n\t\t\tthis.selectedItemMaps.set(\"C1\" , new_pos_invoice)\n\t\t\tthis.selectedTab.tabName = `C1`\n\n\n\t\t}catch(err){\n\t\t\tconsole.error(\"Hlafware POS Error ==> \" , err)\n\t\t\tthrow err;\n\t\t}\n\n        }\n\n\n\tasync handleAppData(){\n\t\t//check pos profile\n\t\tif(this.appData.appData.pos_profile  == null ){\n\t\t\tfrappe.set_route(\"Form\", \"POS Profile\");\n\t\t\tthrow new Error(\"there is no pos profile\")\n\t\t}\n\n\t\t//check takes and get it if it exist on pos profile\n\t\tif(this.appData.appData.pos_profile.taxes_and_charges != null && this.appData.appData.pos_profile.taxes_and_charges != \"\"){\n\t\t\tthis.taxes_and_charges_template = await this.dataHandler.fetchSalesTaxesAndChargesTemplate(this.appData.appData.pos_profile.taxes_and_charges)\n\t\t\tthis.taxes_and_charges = this.taxes_and_charges_template.taxes\n\t\t}\n\t\t//check company and get it if it exist on pos profile\n\t\tif(this.appData.appData.pos_profile.company != null && this.appData.appData.pos_profile.company != ''){\n\t\t\tthis.company = await this.dataHandler.fetchCompany(this.appData.appData.pos_profile.company)\n\t\t}\n\n\t\t//check customer\n\t\tif(this.appData.appData.customers.length > 0){\n\t\t\tthis.defaultCustomer = structuredClone(this.appData.appData.customers[0])\n\t\t}else{\n\t\t\tfrappe.warn(\n\t\t\t\t\t'You dont have a customer',\n\t\t\t\t\t'please create a customer to continue',\n\t\t\t\t\t()=>{\n\t\t\t\t\t\tfrappe.set_route(\"Form\", \"Customer\");\n\t\t\t\t\t},\n\t\t\t\t\t'Create',\n\t\t\t\t\tfalse\n\t\t\t)\n\t\t\tthrow new Error(\"there is no customer\")\n\t\t}\n\t\t//check price list\n\t\tif(this.appData.appData.price_lists.length > 0){\n\t\t\tthis.defaultPriceList.name = this.appData.appData.pos_profile.selling_price_list\n\t\t}else{\n\t\t\tfrappe.warn(\n\t\t\t\t\t'You dont have a single price list',\n\t\t\t\t\t'please create a priceList to continue',\n\t\t\t\t\t()=>{\n\t\t\t\t\t\tfrappe.set_route(\"Form\", \"Price List\");\n\t\t\t\t\t},\n\t\t\t\t\t'Create',\n\t\t\t\t\tfalse\n\t\t\t)\n\t\t\tthrow new Error(\"there is no price list\")\n\t\t}\n\t}\n\n        /***********************  ui ******************************************/\n\n        prepare_container(){\n                //append css styles\n                this.wrapper.append('<link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/pos_ar/css/selectorBox.css\">')\n                this.wrapper.append('<link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/pos_ar/css/checkInOutCart.css\">')\n                this.wrapper.append('<link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/pos_ar/css/itemDetailsCart.css\">')\n                this.wrapper.append('<link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/pos_ar/css/paymentMethodCart.css\">')\n                this.wrapper.append('<link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/pos_ar/css/customerBox.css\">')\n                this.wrapper.append('<link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/pos_ar/css/cartBox.css\">')\n                this.wrapper.append('<link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/pos_ar/css/historyCarts.css\">')\n\n                this.wrapper.append('<div id=\"MainContainer\" class=\"rowBoxReverse\"></div>');\n                this.$components_wrapper = this.wrapper.find(\"#MainContainer\");\n        }\n\n\tprepare_components(){\n\t\tthis.set_right_and_left_sections();\n\t\tthis.init_item_selector();\n\t\tthis.init_customer_box();\n\t\tthis.init_selected_item();\n\t\tthis.init_item_details();\n\t\tthis.init_paymentCart();\n\t\tthis.init_historyCart();\n\t\tthis.init_checkInOutCart();\n\t\tthis.init_debtCart();\n\t\tthis.init_settingsCart();\n\t}\n\n\tasync checkForPOSEntry(){\n\t\tconst user       = frappe.session.user\n\t\tconst posProfile = this.appData.appData.pos_profile.name\n\t\ttry {\n\t\t\tconst response = await frappe.call({\n\t\t\t\tmethod: 'pos_ar.pos_ar.doctype.pos_info.pos_info.check_opening_entry',\n\t\t\t\targs: { user , posProfile}\n\t\t\t});\n\t\t\tconst r = response.message;\n\t\t\tconsole.log(\"debuging is here\")\n\t\t\tif(r.length === 0 ){\n\t\t\t\tthis.create_opening_voucher()\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t//copy data\n\t\t\tObject.assign(this.POSOpeningEntry ,  r[0])\n\t\t\treturn true\n\t\t} catch (error) {\n\t\t\tconsole.error('error occured : ' , error);\n\t\t\tfrappe.throw('Error checking for POS Opening Entry.')\n\t\t\treturn false;\n\t\t}\n\n\n\t}\n\n\n\n\tcreate_opening_voucher() {\n\t\tconst me = this;\n\t\tconst table_fields = [\n\t\t\t{\n\t\t\t\tfieldname: \"mode_of_payment\",\n\t\t\t\tfieldtype: \"Link\",\n\t\t\t\tin_list_view: 1,\n\t\t\t\tlabel: \"Mode of Payment\",\n\t\t\t\toptions: \"Mode of Payment\",\n\t\t\t\treqd: 1,\n\t\t\t},\n\t\t\t{\n\t\t\t\tfieldname: \"opening_amount\",\n\t\t\t\tfieldtype: \"Currency\",\n\t\t\t\tin_list_view: 1,\n\t\t\t\tlabel: \"Opening Amount\",\n\t\t\t\toptions: \"company:company_currency\",\n\t\t\t\tchange: function () {\n\t\t\t\t\tdialog.fields_dict.balance_details.df.data.some((d) => {\n\t\t\t\t\t\tif (d.idx == this.doc.idx) {\n\t\t\t\t\t\t\td.opening_amount = this.value;\n\t\t\t\t\t\t\tdialog.fields_dict.balance_details.grid.refresh();\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\n\t\tconst fetch_pos_payment_methods = () => {\n\t\t\tconst pos_profile = dialog.fields_dict.pos_profile.get_value();\n\t\t\tconsole.log(\"pos debuging ===> \" , pos_profile)\n\n\t\t\tif (!pos_profile) return;\n\t\t\tfrappe.db.get_doc(\"POS Profile\", pos_profile).then(({ payments }) => {\n\t\t\t\tdialog.fields_dict.balance_details.df.data = [];\n\t\t\t\tthis.payment_methods = payments\n\t\t\t\tpayments.forEach((pay) => {\n\t\t\t\t\tconst { mode_of_payment } = pay;\n\t\t\t\t\tdialog.fields_dict.balance_details.df.data.push({ mode_of_payment, opening_amount: \"0\" });\n\t\t\t\t});\n\t\t\t\tdialog.fields_dict.balance_details.grid.refresh();\n\t\t\t});\n\t\t};\n\t\tconst dialog = new frappe.ui.Dialog({\n\t\t\ttitle: __(\"Create POS Opening Entry\"),\n\t\t\tstatic: true,\n\t\t\tfields: [\n\t\t\t\t{\n\t\t\t\t\tfieldtype: \"Link\",\n\t\t\t\t\tlabel: __(\"Company\"),\n\t\t\t\t\tdefault: frappe.defaults.get_default(\"company\"),\n\t\t\t\t\toptions: \"Company\",\n\t\t\t\t\tfieldname: \"company\",\n\t\t\t\t\treqd: 1,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldtype: \"Link\",\n\t\t\t\t\tlabel: __(\"POS Profile\"),\n\t\t\t\t\toptions: \"POS Profile\",\n\t\t\t\t\tfieldname: \"pos_profile\",\n\t\t\t\t\treqd: 1,\n\t\t\t\t\tget_query: () => pos_profile_query(),\n\t\t\t\t\tonchange: () => fetch_pos_payment_methods(),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: \"balance_details\",\n\t\t\t\t\tfieldtype: \"Table\",\n\t\t\t\t\tlabel: \"Opening Balance Details\",\n\t\t\t\t\tcannot_add_rows: false,\n\t\t\t\t\tin_place_edit: true,\n\t\t\t\t\treqd: 1,\n\t\t\t\t\tdata: [],\n\t\t\t\t\tfields: table_fields,\n\t\t\t\t},\n\t\t\t],\n\t\t\tprimary_action: async function ({ company, pos_profile, balance_details }) {\n\t\t\t\tif (!balance_details.length) {\n\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\tmessage: __(\"Please add Mode of payments and opening balance details.\"),\n\t\t\t\t\t\tindicator: \"red\",\n\t\t\t\t\t});\n\t\t\t\t\treturn frappe.utils.play_sound(\"error\");\n\t\t\t\t}\n\n\t\t\t\t// filter balance details for empty rows\n\t\t\t\tbalance_details = balance_details.filter((d) => d.mode_of_payment);\n\n\t\t\t\tconst method = \"erpnext.selling.page.point_of_sale.point_of_sale.create_opening_voucher\";\n\t\t\t\tconst res = await frappe.call({\n\t\t\t\t\tmethod,\n\t\t\t\t\targs: { pos_profile, company, balance_details },\n\t\t\t\t\tfreeze: true,\n\t\t\t\t});\n\t\t\t\t!res.exc && me.prepare_app_data(res.message);\n\n\t\t\t\tObject.assign(me.POSOpeningEntry    ,  {'name' : res.message.name , 'pos_profile' : res.message.pos_profile ,  'period_start_date' : res.message.period_start_date , 'company' : res.message.company } )\n\n\t\t\t\tdialog.hide();\n\n\t\t\t},\n\t\t\tprimary_action_label: __(\"Submit\"),\n\t\t});\n\t\tdialog.show();\n\t\tconst pos_profile_query = () => {\n\t\t\treturn {\n\t\t\t\tquery: \"erpnext.accounts.doctype.pos_profile.pos_profile.pos_profile_query\",\n\t\t\t\tfilters: { company: dialog.fields_dict.company.get_value() },\n\t\t\t};\n\t\t};\n\t}\n\n\n\n        set_right_and_left_sections(){\n                this.$components_wrapper.append('<div id=\"LeftSection\" class=\"columnBoxReverse\"></div>')\n                this.$components_wrapper.append('<div id=\"RightSection\" class=\"columnBox\"></div>')\n\n\t\tthis.$rightSection = this.$components_wrapper.find(\"#RightSection\")\n\t\tthis.$leftSection  = this.$components_wrapper.find(\"#LeftSection\")\n\n        }\n\n\n\tinit_customer_box(){\n\t\tthis.customer_box  = new pos_ar.PointOfSale.pos_customer_box(\n\t\t\t\t\t\t\t\t\tthis.$leftSection ,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.customers,\n\t\t\t\t\t\t\t\t\tthis.defaultCustomer ,\n\t\t\t\t\t\t\t\t\tthis.backHome.bind(this),\n\t\t\t\t\t\t\t\t\tthis.onSync.bind(this),\n\t\t\t\t\t\t\t\t\tthis.saveCheckInOut.bind(this),\n\t\t\t\t\t\t\t\t\tthis.onMenuClick.bind(this),\n\t\t\t\t\t\t\t\t\tthis.onDebtClick.bind(this)\n\t\t\t\t\t\t\t\t)\n\t}\n\n\n        init_item_selector(){\n\n                this.item_selector = new pos_ar.PointOfSale.pos_item_selector(\n\t\t\t\t\t\tthis.$leftSection                  ,\n\t\t\t\t\t\tthis.appData.appData.items         ,\n\t\t\t\t\t\tthis.appData.appData.item_barcodes ,\n\t\t\t\t\t\tthis.appData.appData.item_groups   ,\n\t\t\t\t\t\tthis.appData.appData.item_prices   ,\n\t\t\t\t\t\tthis.settings_data.settings        ,\n\t\t\t\t\t\tthis.defaultPriceList              ,\n\t\t\t\t\t\tthis.getItemPrice.bind(this)       ,\n\t\t\t\t\t\tthis.auto_select.bind(this)        ,\n\t\t\t\t\t\titem => { this.itemClick_selector(item)  }\n\t\t\t\t\t)\n\t}\n\n        init_selected_item(){\n\t\tthis.selected_item_cart  = new pos_ar.PointOfSale.pos_selected_item_cart(\n\t\t\t\t\t\t\t\t\tthis.$rightSection    ,\n\t\t\t\t\t\t\t\t\tthis.settings_data    ,\n\t\t\t\t\t\t\t\t\tthis.selectedItemMaps ,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.price_lists ,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.customers   ,\n\t\t\t\t\t\t\t\t\tthis.appData.brands   ,\n\t\t\t\t\t\t\t\t\tthis.taxes_and_charges,\n\t\t\t\t\t\t\t\t\tthis.invoiceData      ,\n\t\t\t\t\t\t\t\t\tthis.selectedTab      ,\n\t\t\t\t\t\t\t\t\tthis.selectedItem     ,\n\t\t\t\t\t\t\t\t\tthis.selectedField    ,\n\t\t\t\t\t\t\t\t\tthis.getItemPrice.bind(this),\n\t\t\t\t\t\t\t\t\titem => {\n\t\t\t\t\t\t\t\t\t\tthis.onSelectedItemClick(item)\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\ttab =>{\n\t\t\t\t\t\t\t\t\t\tthis.onClose_details();\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t(action , key) =>{\n\t\t\t\t\t\t\t\t\t\tthis.onKeyPressed(action , key)\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tthis.createNewTab.bind(this),\n\t\t\t\t\t\t\t\t\tthis.onCheckout.bind(this)\n\t\t\t\t\t\t\t\t)\n\t}\n\n\tinit_item_details(){\n\t\tthis.item_details = new pos_ar.PointOfSale.pos_item_details(\n\t\t\t\t\t\t\t\t\tthis.$leftSection,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.pos_profile.warehouse,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.price_lists ,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.item_prices ,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.bins        ,\n\t\t\t\t\t\t\t\t\tthis.selectedItem,\n\t\t\t\t\t\t\t\t\tthis.selectedField,\n\t\t\t\t\t\t\t\t\t(event , field , value) =>{\n\t\t\t\t\t\t\t\t\t\tthis.onInput(event , field , value);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tthis.onClose_details.bind(this)\n\t\t\t\t\t\t\t\t)\n\t}\n\n\n        init_paymentCart(){\n\t\tthis.payment_cart = new pos_ar.PointOfSale.pos_payment_cart(\n\t\t\t\t\t\t\t\t\tthis.$leftSection,\n\t\t\t\t\t\t\t\t\tthis.selectedItemMaps,\n\t\t\t\t\t\t\t\t\tthis.selectedTab,\n\t\t\t\t\t\t\t\t\tthis.appData.appData,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.pos_profile.payments,\n\t\t\t\t\t\t\t\t\tthis.selectedPaymentMethod,\n\t\t\t\t\t\t\t\t\tthis.invoiceData,\n\t\t\t\t\t\t\t\t\tthis.onClose_payment_cart.bind(this),\n\t\t\t\t\t\t\t\t\tthis.onCompleteOrder.bind(this),\n\t\t\t\t\t\t\t\t\t(event , field , value) =>{\n\t\t\t\t\t\t\t\t\t\tthis.onInput(event , field , value);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t)\n        }\n\n        init_historyCart(){\n\t\tthis.history_cart = new pos_ar.PointOfSale.pos_history(\n\t\t\t\t\t\t\t\t\tthis.wrapper,\n\t\t\t\t\t\t\t\t\tthis.db,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.pos_profile,\n\t\t\t\t\t\t\t\t\tthis.company,\n\t\t\t\t\t\t\t\t\tthis.taxes_and_charges,\n\t\t\t\t\t\t\t\t\tthis.historyCartClick.bind(this)\n\t\t\t\t\t\t\t\t)\n        }\n\n        init_checkInOutCart(){\n\t\tthis.check_in_out_cart = new pos_ar.PointOfSale.pos_check_in_out(\n\t\t\t\t\t\t\t\t\tthis.wrapper,\n\t\t\t\t\t\t\t\t\tthis.db\n\t\t\t\t\t\t\t\t)\n        }\n\n        init_debtCart(){\n\t\tthis.debt_cart = new pos_ar.PointOfSale.pos_debt_cart(\n\t\t\t\t\t\t\t\t\tthis.wrapper\n\t\t\t\t\t\t\t\t)\n\t}\n\n\n        init_settingsCart(){\n\t\tthis.settings_cart = new pos_ar.PointOfSale.pos_settings(\n\t\t\t\t\t\t\t\t\tthis.wrapper,\n\t\t\t\t\t\t\t\t\tthis.settings_data,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.pos_profile,\n\t\t\t\t\t\t\t\t\tthis.onSettingsChange.bind(this)\n\t\t\t\t\t\t\t\t)\n        }\n\n\n\n        /*********************  callbacks functions ******************************/\n\n\n\titemClick_selector(item){\n\t\tconst  itemCloned = structuredClone(item);\n\n\t\titemCloned.discount_amount     = 0;\n\t\titemCloned.discount_percentage = 0;\n\n\t\tObject.assign(this.selectedItem , itemCloned)\n\n\t\tthis.addItemToPosInvoice( itemCloned )\n\n\t\tthis.selected_item_cart.calculateNetTotal();\n\t\tthis.selected_item_cart.calculateVAT();\n\t\tthis.selected_item_cart.calculateQnatity();\n\t\tthis.selected_item_cart.calculateGrandTotal();\n\t\tthis.selected_item_cart.refreshSelectedItem();\n\n\n\t\tthis.selectedField.field_name = \"quantity\"\n\t\tthis.selected_item_cart.makeSelectedButtonHighlighted();\n\n\t\tthis.savePosInvoice(true)\n\t}\n\n\n\tonSelectedItemClick(item){\n\t\tconst clonedItem = structuredClone(item)\n\t\tObject.assign(this.selectedItem , clonedItem)\n\n\t\t//show details depend on settings\n\t\tif(this.settings_data.settings.showItemDetails){\n\t\t\tthis.item_details.show_cart();\n\t\t\tthis.item_selector.hideCart();\n\t\t\tthis.selected_item_cart.showKeyboard();\n\t\t\t//close\n\t\t\tthis.payment_cart.hideCart();\n\t\t\tthis.settings_cart.hideCart();\n\t\t\t//change display\n\t\t\tthis.selected_item_cart.setKeyboardOrientation(\"landscape\");\n\n\t\t}\n\n\t\tthis.selectedField.field_name = \"quantity\"\n\t\tthis.selected_item_cart.makeSelectedButtonHighlighted();\n\n\t\t//refresh data\n\t\tthis.item_details.refreshDate(item);\n\t}\n\n\tsaveCheckInOut(checkInOut){\n\t\tthis.appData.saveCheckInOut(\n\t\t\tcheckInOut,\n\t\t\t(res)=>{\n\t\t\t\tthis.check_in_out_cart.getAllCheckInOut();\n\t\t\t},(err)=>{\n\t\t\t\tconsole.log('err to save checkInOut : ' , err)\n\t\t\t}\n\t\t)\n\t}\n\n\n\tonSettingsChange(settingName){\n\t\tif(settingName == \"itemPriceBasedOn\"){\n\t\t\t//refreshing selected_item_cart and item_selector_cart\n\t\t\tthis.item_selector.refreshItemSelector();\n\t\t\t//recalculate price\n\t\t\tthis.selected_item_cart.resetItemRateBaseOnPriceList()\n\t\t\t//redraw\n\t\t\tthis.selected_item_cart.refreshSelectedItem()\n\t\t}\n\t}\n\n\tonDebtClick(){\n\t\tthis.debt_cart.showCart();\n\t}\n\n\tsavePosInvoice(saveWithZeroRate){\n\t\tif(this.checkIfRateZero(this.selectedItemMaps.get(this.selectedTab.tabName)) && !saveWithZeroRate){\n\t\t\tfrappe.throw(\"Item with rate equal 0\")\n\t\t\treturn ;\n\t\t}\n\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).synced = false ;\n\t\tthis.appData.savePosInvoice(this.selectedItemMaps.get(this.selectedTab.tabName))\n\n\t}\n\tonCheckout(){\n\t\tthis.savePosInvoice(true)\n\t\t//show\n\t\tthis.payment_cart.showCart();\n\t\t//hide\n\t\tthis.item_selector.hideCart();\n\t\tthis.item_details.hide_cart();\n\t\tthis.settings_cart.hideCart();\n\t\t//change displayk\n\t\tthis.payment_cart.calculateGrandTotal()\n\t\tthis.selected_item_cart.setKeyboardOrientation(\"landscape\");\n\t\tthis.selected_item_cart.cleanHeighlight();\n\t\tthis.selected_item_cart.showKeyboard();\n\n\t}\n\n\tonClose_details(){\n\t\t//show\n\t\tthis.item_selector.showCart();\n\t\t//hide\n\t\tthis.payment_cart.hideCart() ;\n\t\tthis.item_details.hide_cart();\n\t\tif(this.settings_data.settings.showItemDetails){\n\t\t\tthis.selected_item_cart.hideKeyboard();\n\t\t}\n\t\tthis.settings_cart.hideCart();\n\t\t//change display\n\t\tthis.selected_item_cart.setKeyboardOrientation(\"portrait\");\n\t\tthis.selected_item_cart.cleanHeighlight();\n\t}\n\n\tauto_select(item){\n\t\tthis.itemClick_selector(item)\n\t\tthis.item_selector.refresh()\n\t}\n\n\tonClose_payment_cart(){\n\t\t//show\n\t\tthis.item_selector.showCart();\n\t\t//hide\n\t\tthis.item_details.hide_cart();\n\t\tthis.payment_cart.hideCart();\n\t\tif(this.settings_data.settings.showItemDetails){\n\t\t\tthis.selected_item_cart.hideKeyboard();\n\t\t}\n\t\tthis.settings_cart.hideCart();\n\t\t//update ui\n\t\tthis.selected_item_cart.setKeyboardOrientation(\"portrait\");\n\t\tthis.selected_item_cart.cleanHeighlight();\n\t}\n\n\tonMenuClick(menu){\n\t\tif(menu == 'recent_pos'){\n\t\t\t//show\n\t\t\tthis.history_cart.show_cart()\n\t\t\tthis.customer_box.showHomeBar();\n\t\t\t//hide\n\t\t\tthis.payment_cart.hideCart();\n\t\t\tthis.item_details.hide_cart();\n\t\t\tthis.item_selector.hideCart();\n\t\t\tthis.selected_item_cart.hideCart();\n\t\t\tthis.customer_box.hideSyncBar();\n\t\t\tthis.settings_cart.hideCart();\n\t\t\tthis.check_in_out_cart.hideCart();\n\t\t}\n\t\telse if(menu == 'close_pos'){\n\t\t\tthis.onClosePOS()\n\t\t}\n\t\telse if(menu == 'settings'){\n\t\t\t//show settings\n\t\t\tthis.settings_cart.showCart()\n\t\t\tthis.customer_box.showHomeBar();\n\t\t\t//hide\n\t\t\tthis.item_selector.hideCart();\n\t\t\tthis.selected_item_cart.hideCart();\n\t\t\tthis.item_details.hide_cart() ;\n\t\t\tthis.payment_cart.hideCart()  ;\n\t\t\tthis.history_cart.hide_cart() ;\n\t\t\tthis.check_in_out_cart.hideCart();\n\t\t\t//hide section\n\t\t\tthis.customer_box.hideSyncBar();\n\t\t}\n\t\telse if(menu == 'checkInOut'){\n\t\t\t//show\n\t\t\tthis.check_in_out_cart.showCart();\n\t\t\tthis.customer_box.showHomeBar();\n\n\t\t\t//hide\n\t\t\tthis.item_selector.hideCart();\n\t\t\tthis.selected_item_cart.hideCart();\n\t\t\tthis.item_details.hide_cart() ;\n\t\t\tthis.payment_cart.hideCart()  ;\n\t\t\tthis.history_cart.hide_cart() ;\n\t\t\tthis.settings_cart.hideCart() ;\n\t\t\t//hide section\n\t\t\tthis.customer_box.hideSyncBar();\n\t\t}\n\t}\n\n\tbackHome(){\n\t\t//show\n\t\tthis.item_selector.showCart()      ;\n\t\tthis.customer_box.showSyncBar()    ;\n\t\tthis.selected_item_cart.showCart() ;\n\n\t\t//hide\n\t\tthis.payment_cart.hideCart()   ;\n\t\tthis.customer_box.hideHomeBar();\n\t\tthis.item_details.hide_cart()  ;\n\t\tthis.history_cart.hide_cart()  ;\n\t\tthis.settings_cart.hideCart()  ;\n\t\tthis.check_in_out_cart.hideCart();\n\t}\n\n\tgetDefaultPaymentMethod(){\n\t\tlet result = null;\n\t\tthis.appData.appData.pos_profile.payments.forEach(method =>{\n\t\t\tif(method.default){\n\t\t\t\tresult = method\n\t\t\t}\n\t\t})\n\n\t\treturn result\n\t}\n\n\tgetPaymentMethods(){\n\t\tlet result = [];\n\t\tthis.appData.appData.pos_profile.payments.forEach(method =>{\n\t\t\tresult.push({'mode_of_payment' : method.mode_of_payment , 'default' : method.default , 'amount' : 0})\n\t\t})\n\n\t\treturn result\n\t}\n\n\tcreateNewTab(counter){\n\n\t\tlet new_pos_invoice = frappe.model.get_new_doc('POS Invoice');\n\t\tnew_pos_invoice.customer          = this.defaultCustomer.name\n\t\tnew_pos_invoice.pos_profile       = this.appData.appData.pos_profile.name\n\t\tnew_pos_invoice.items             = [];\n\t\tnew_pos_invoice.taxes_and_charges = this.appData.appData.pos_profile.taxes_and_charges\n\t\tnew_pos_invoice.additional_discount_percentage = 0\n\t\tnew_pos_invoice.paid_amount       = 0\n\t\tnew_pos_invoice.base_paid_amount  = 0\n\t\tnew_pos_invoice.creation_time     = frappe.datetime.now_datetime()\n\t\tnew_pos_invoice.payments          = this.getPaymentMethods()\n\t\tnew_pos_invoice.is_pos            = 1\n\t\tnew_pos_invoice.update_stock      = 1\n\t\tnew_pos_invoice.docstatus         = 0\n\t\tnew_pos_invoice.synced            = false\n\t\tnew_pos_invoice.status            = 'Draft'\n\t\tnew_pos_invoice.priceList         = this.defaultPriceList.name\n\t\t//build refNm   posProfile-date-time\n\t\tconst date = new Date()\n\t\tconst [year,month,day] = date.toISOString().split('T')[0].split('-')\n\t\tconst hour    = date.getHours()\n\t\tconst minutes = date.getMinutes()\n\t\tconst seconds = date.getMilliseconds()\n\t\tnew_pos_invoice.refNum            = this.appData.appData.pos_profile.name+\"-\"+year+'-'+month+'-'+day+'-'+hour+minutes+seconds\n\n\t\tthis.selectedItemMaps.set(`C${counter}` , new_pos_invoice)\n\t\tthis.selectedTab.tabName = `C${counter}`\n\n\t\t//hide item details\n\t\tthis.item_details.hide_cart() ;\n\t}\n\n\n\thistoryCartClick(event , message){\n\t\t//go back to edit pos draft\n\t\tif(event == 'edit'){\n\t\t\tconst tab = this.selected_item_cart.createTabForEditPOS()\n\n\t\t\tthis.selectedItemMaps.set(`C${tab}` , message)\n\t\t\tthis.selectedTab.tabName = `C${tab}`\n\n\t\t\t//show\n\t\t\tthis.item_selector.showCart();\n\t\t\tthis.customer_box.showHomeBar();\n\t\t\tthis.selected_item_cart.showCart()\n\n\t\t\t//hide\n\t\t\tthis.item_details.hide_cart() ;\n\t\t\tthis.payment_cart.hideCart()  ;\n\t\t\tthis.history_cart.hide_cart() ;\n\t\t\tthis.settings_cart.hideCart();\n\n\t\t\t//refresh the data :\n\t\t\tthis.selected_item_cart.refreshTabs()\n                        this.selected_item_cart.refreshSelectedItem()\n\t\t}\n\t\telse if(event == 'return'){\n\t\t\tthis.backHome();\n\t\t}\n\t}\n\n\tonInput( event , field , value){\n\n\t\tif(event == \"focus\" || event == \"blur\"){\n\t\t\tif(event == \"focus\")\n\t\t\t\tObject.assign(this.selectedField , {field_name : field})\n\t\t\tif(event == \"blur\")\n\t\t\t\tObject.assign(this.selectedField , {field_name : null})\n\n\t\t\tthis.item_details.makeSelectedFieldHighlighted()\n\t\t\tthis.selected_item_cart.makeSelectedButtonHighlighted();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif( field ==  \"quantity\" ){\n\t\t\tthis.selectedItem.qty = parseFloat(value);\n\t\t\tthis.editPosItemQty(this.selectedItem.name , this.selectedItem.qty);\n\n\t\t\t//redrawing\n\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t}\n\t\telse if( field ==  \"rate\" ){\n\t\t\tthis.selectedItem.rate = parseFloat(value);\n\n\t\t\t//recalculate the rate\n\t\t\tlet oldRate = this.selectedItem.rate;\n\t\t\tlet persont = this.selectedItem.discount_percentage\n\t\t\tlet montant = oldRate * (persont / 100)\n\n\t\t\tthis.selectedItem.discount_percentage = persont;\n\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\tthis.editPosItemDiscountAmount(this.selectedItem.name , this.selectedItem.discount_amount);\n\t\t\tthis.editPosItemRate(this.selectedItem.name , this.selectedItem.rate);\n\n\t\t\t//redrawing\n\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\tthis.item_details.refreshDate(this.selectedItem);\n\n\t\t}\n\t\telse if( field == \"discount_percentage\"){\n\n\t\t\t//recalculate the rate\n\t\t\tlet oldRate = this.selectedItem.rate;\n\t\t\tlet montant = oldRate * (parseFloat(value) / 100)\n\n\t\t\tthis.selectedItem.discount_percentage = parseFloat(value);\n\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\tthis.editPosItemDiscountAmount(this.selectedItem.name , this.selectedItem.discount_amount);\n\t\t\tthis.editPosItemDiscountPercentage(this.selectedItem.name ,  this.selectedItem.discount_percentage);\n\n\t\t\t//redrawing\n\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\tthis.item_details.refreshDate(this.selectedItem);\n\t\t}\n\t\telse if( field == \"discount_amount\"){\n\n\t\t\t//recalculate the rate\n\t\t\tlet oldRate = this.selectedItem.rate;\n\t\t\tlet persent = ((parseFloat(value) * 100) / oldRate).toFixed(2);\n\t\t\tlet montant = parseFloat(value);\n\n\t\t\t//prevent negatif result\n\t\t\tif(persent > 100){\n\t\t\t\tpersent = 100 ;\n\t\t\t}\n\t\t\tif(parseFloat(value) > oldRate){\n\t\t\t\tmontant = oldRate;\n\t\t\t}\n\n\t\t\tthis.selectedItem.discount_percentage = parseFloat(persent);\n\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\tthis.editPosItemDiscountAmount(this.selectedItem.name , this.selectedItem.discount_amount);\n\t\t\tthis.editPosItemDiscountPercentage(this.selectedItem.name , this.selectedItem.discount_percentage);\n\n\t\t\t//redrawing\n\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\tthis.item_details.refreshDate(this.selectedItem);\n\n\t\t}\n\n\t\tthis.savePosInvoice(true)\n\t}\n\n\n\tonKeyPressed( action  , key){\n\n\t\tif(action == \"quantity\"){\n\t\t\tthis.selectedField.field_name = \"quantity\"\n\t\t\tthis.selected_item_cart.makeSelectedButtonHighlighted();\n\t\t\t//this.item_details.requestFocus(\"quantity\")\n\t\t}\n\t\telse if(action == \"rate\"){\n\t\t\tthis.selectedField.field_name = \"rate\"\n\t\t\tthis.selected_item_cart.makeSelectedButtonHighlighted();\n\t\t\t//this.item_details.requestFocus(\"rate\")\n\t\t}\n\t\telse if(action == \"discount\"){\n\t\t\t//this.item_details.requestFocus(\"discount_percentage\")\n\t\t}\n\t\telse if(action == \"remove\"){\n\t\t\tthis.deleteItemFromPOsInvoice(this.selectedItem.name)\n\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\tthis.onClose_details()\n\t\t}\n\t\telse if(action == \"delete\"){\n\n\t\t\tlet newValue =  parseFloat(this.item_details.deleteCharacter())\n\n\t\t\tif(this.selectedField.field_name == \"quantity\"){\n\t\t\t\tthis.selectedItem.qty = newValue;\n\t\t\t\tconst posItems = this.selectedItemMaps.get(this.selectedTab.tabName)\n\t\t\t}\n\t\t\telse if(this.selectedField.field_name == \"rate\"){\n\n\t\t\t\tthis.selectedItem.rate = newValue;\n\t\t\t\tconst posItems = this.selectedItemMaps.get(this.selectedTab.tabName)\n\n\t\t\t\t//recalculate the rate\n\t\t\t\tlet oldRate = this.selectedItem.rate;\n\t\t\t\tlet persont = this.selectedItem.discount_percentage\n\t\t\t\tlet montant = oldRate * (persont / 100)\n\n\t\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\t}\n\t\t\telse if(this.selectedField.field_name == \"discount_percentage\"){\n\t\t\t\t//recalculate the rate\n\t\t\t\tlet oldRate = this.selectedItem.rate;\n\t\t\t\tlet montant = oldRate * (newValue / 100)\n\n\t\t\t\tthis.selectedItem.discount_percentage = newValue;\n\t\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\t}\n\t\t\telse if(this.selectedField.field_name == \"discount_percentage\"){\n\t\t\t\t//recalculate the rate\n\t\t\t\tlet oldRate = this.selectedItem.rate;\n\t\t\t\tlet montant = oldRate * (newValue / 100)\n\n\t\t\t\t//asign the values to the selectedItem refrence\n\t\t\t\tthis.selectedItem.discount_percentage = newValue;\n\t\t\t\tthis.selectedItem.discount_rate       = montant;\n\n\t\t\t}\n\t\t\telse if(this.selectedField.field_name == \"cash\"){\n\t\t\t\tthis.payment_cart.deleteKeyPress();\n\t\t\t}\n\n\n\n\t\t}\n\t\telse if(action == \"addToField\"){\n\n\t\t\tif(this.selectedField.field_name == \"cash\"){\n\t\t\t\tthis.payment_cart.handleInput(key);\n\t\t\t}\n\t\t\telse{\n\n\t\t\t\tif( this.selectedField.field_name ==  \"quantity\" ){\n\t\t\t\t\tconst newVal = this.selectedItem.qty + key\n\t\t\t\t\tthis.selectedItem.qty = parseFloat(newVal);\n\t\t\t\t}\n\t\t\t\telse if( this.selectedField.field_name ==  \"rate\" ){\n\t\t\t\t\tconst newVal = this.selectedItem.rate + key\n\t\t\t\t\tthis.selectedItem.rate = parseFloat(newVal);\n\n\t\t\t\t}\n\t\t\t\telse if( this.selectedField.field_name ==  \"discount_percentage\" ){\n\t\t\t\t\t//recalculate the rate\n\t\t\t\t\tlet oldRate        = this.selectedItem.rate;\n\t\t\t\t\tlet old_percentage = this.selectedItem.discount_percentage ?? 0;\n\t\t\t\t\tlet input          = `${old_percentage}` + key ;\n\t\t\t\t\tlet discount_percentage = parseFloat(input);\n\t\t\t\t\tif(discount_percentage > 100){\n\t\t\t\t\t\tdiscount_percentage = 100;\n\t\t\t\t\t}\n\t\t\t\t\tlet montant = oldRate * ( discount_percentage / 100)\n\t\t\t\t\tlet newRate = oldRate - montant\n\n\n\t\t\t\t\tthis.selectedItem.discount_percentage = (discount_percentage);\n\t\t\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t}\n\n\n\t\t//update the posInvoice\n\t\tthis.editPosItemDiscountAmount(this.selectedItem.name , this.selectedItem.discount_amount);\n\t\tthis.editPosItemRate(this.selectedItem.name , this.selectedItem.rate);\n\t\tthis.editPosItemQty(this.selectedItem.name , this.selectedItem.qty);\n\n\t\t//update the ui\n\t\tthis.selected_item_cart.refreshSelectedItem()\n\t\tthis.item_details.refreshDate(this.selectedItem);\n\n\t\tthis.savePosInvoice(true)\n\t}\n\n\n\tonCompleteOrder(){\n\n\t\tthis.savePosInvoice(true)\n\n\t\t//check if they set a customer\n\t\tif(this.defaultCustomer.name == \"\"){\n\t\t\tfrappe.warn(\n\t\t\t\t\t'Customer didnt selected!',\n\t\t\t\t\t'you have to select a customer',\n\t\t\t\t\t()=>{\n\t\t\t\t\t},\n\t\t\t\t\t'Done',\n\t\t\t\t\tfalse\n\t\t\t)\n\t\t\treturn ;\n\t\t}\n\t\tlet items = []\n\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).items.forEach(  item  =>{\n\t\t\t// we still didnt implement the price_list_rate and base_price_list_rate\n\t\t\t// same thing with actual_qty refering to the stock quantity\n\t\t\tlet newItem = {\n\t\t\t\t'item_name'               : item.item_name,\n\t\t\t\t'item_code'               : item.name,\n\t\t\t\t'rate'                    : item.rate,\n\t\t\t\t'qty'                     : item.qty,\n\t\t\t\t'description'             : item.name,\n\t\t\t\t'image'                   : item.image,\n\t\t\t\t'use_serial_batch_fields' : 1,\n\t\t\t\t'cost_center'             : this.appData.appData.pos_profile.cost_center,\n\t\t\t\t'discount_percentage'     : item.discount_percentage,\n\t\t\t\t'discount_amount'         : item.discount_amount,\n\t\t\t\t'warehouse'               : this.appData.appData.pos_profile.warehouse,\n\t\t\t\t'income_account'          : this.appData.appData.pos_profile.income_account,\n\t\t\t}\n\t\t\titems.push(newItem)\n\t\t})\n\n\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).items = items\n\t\tif(items.length ==0)\n\t\t\treturn\n\n\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).paid_amount        = this.calculatePaidAmount(this.selectedItemMaps.get(this.selectedTab.tabName))\n\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).base_paid_amount   = this.calculatePaidAmount(this.selectedItemMaps.get(this.selectedTab.tabName))\n\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).outstanding_amount = this.invoiceData.grandTotal - this.calculatePaidAmount(this.selectedItemMaps.get(this.selectedTab.tabName))\n\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).docstatus          = 1\n\n\t\t//set status\n\t\tconst status = this.checkIfPaid(this.selectedItemMaps.get(this.selectedTab.tabName))\n\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).status            = status\n\n\t\t//copy the pos is important otherwise it will deleted and the selectedTab change and then it will save the\n\t\t//wrong one. because insert take a while after the callback will called.\n\t\tconst pos = structuredClone(this.selectedItemMaps.get(this.selectedTab.tabName))\n\n\n\n\t\tif(status == 'Unpaid'){\n\t\t\tpos.synced = true\n\t\t\tfrappe.db.insert(\n\t\t\t\tpos\n\t\t\t).then(r =>{\n\t\t\t\tthis.appData.updatePosInvoice(pos)\n\t\t\t}).catch(err=>{\n\t\t\t\tconsole.log(\"cant push pos invoice : \" , err);\n\t\t\t})\n\t\t}\n\t\telse{\n\t\t\tpos.synced = false ;\n\t\t\tthis.appData.updatePosInvoice(pos)\n\t\t\tthis.unsyncedPos += 1 ;\n\t\t\tthis.customer_box.setNotSynced(this.unsyncedPos);\n\t\t}\n\t\t//print the pos\n\t\tthis.history_cart.print_receipt(pos)\n\n\t\tthis.selectedItemMaps.delete(this.selectedTab.tabName)\n\n\t\t//tabs\n\t\tlet tabs = Array.from(this.selectedItemMaps.keys())\n\t\t//if there are still tabs it will just set the first as selected\n\t\t//otherwise it will create one using the selected_item_cart class and set it as selected\n\t\tif(tabs.length > 0){\n\t\t\tthis.selectedTab.tabName = tabs[0]\n\t\t\tthis.selected_item_cart.refreshTabs();\n\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t}\n\t\telse{\n\t\t\tthis.selected_item_cart.createNewTab();\n\t\t}\n\t\tthis.onClose_payment_cart()\n\t}\n\n\n\tonSync(){\n\t\tif(this.POSOpeningEntry.name == '' ){\n\t\t\tthis.checkForPOSEntry();\n\t\t\treturn;\n\t\t}\n\n\t\t//check if there is a pos to sync\n\t\tif(this.unsyncedPos == 0){\n\t\t\t// with options\n\t\t\tfrappe.msgprint({\n\t\t\t\ttitle: __('Sync Complete'),\n\t\t\t\tindicator: 'green',\n\t\t\t\tmessage: __('All data is already synchronized.')\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tlet counter     = 0  ;\n\t\tlet failure     = 0  ;\n\t\tlet seccess     = 0  ;\n\n\t\tthis.appData.getNotSyncedPos(\n\t\t\t(allUnsyncedPos) =>{\n\t\t\t\t//create progress bar\n\t\t\t\tfrappe.show_progress('Syncing Invoices...' , 0 , allUnsyncedPos.length , 'syncing')\n\t\t\t\tallUnsyncedPos.forEach(pos=>{\n\t\t\t\t\t// we still didnt implement the  base_paid_amount and amount_eligible_for_commissionseen\n\t\t\t\t\t// value in deafault pos ==>  [\"Administrator\"]. i think it is an array.\n\t\t\t\t\tfrappe.db.insert(\n\t\t\t\t\t\tpos\n\t\t\t\t\t).then(r =>{\n\t\t\t\t\t\tconst updatedPos = structuredClone(pos)\n\t\t\t\t\t\tupdatedPos.synced = true;\n\t\t\t\t\t\tthis.appData.updatePosInvoice(updatedPos)\n\t\t\t\t\t\tcounter += 1 ;\n\t\t\t\t\t\tfrappe.show_progress('Syncing Invoices...' , counter , allUnsyncedPos.length , 'syncing')\n\t\t\t\t\t\t//if the last pos save seccessfully then hide the progress bar\n\t\t\t\t\t\tif(counter == allUnsyncedPos.length){\n\t\t\t\t\t\t\tfrappe.hide_progress();\n\t\t\t\t\t\t\tthis.customer_box.setSynced();\n\t\t\t\t\t\t\tthis.unsyncedPos = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}).catch(err =>{\n\t\t\t\t\t\tcounter += 1 ;\n\t\t\t\t\t\tfailure += 1 ;\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t},\n\t\t\t(err) =>{\n\t\t\t\tconsole.log(\"cant get the unseced POS from local\")\n\t\t\t}\n\t\t);\n\n\n\t}\n\n\n\tcheckIfPaid(pos){\n\n\t\tlet netTotal   = 0 ;\n\t\tlet grandTotal = 0 ;\n\t\tlet allTaxes   = 0 ;\n\t\tlet discount   = 0 ;\n\n\t\t//net total\n\t\tpos.items.forEach( item => {\n\t\t\tnetTotal += item.qty * item.rate\n\t\t})\n\n\t\tthis.taxes_and_charges.forEach(tax =>{\n\t\t\tallTaxes += (tax.rate / 100) * netTotal\n\t\t})\n\n\t\t//discount\n\t\tdiscount = (pos.additional_discount_percentage / 100) * netTotal\n\n\t\tgrandTotal  = netTotal + allTaxes - discount\n\n\t\tif(pos.paid_amount == 0){\n\t\t\treturn \"Unpaid\"\n\t\t}\n\t\telse if(pos.paid_amount < grandTotal){\n\t\t\treturn \"Unpaid\"\n\t\t}\n\t\telse{\n\t\t\treturn \"Paid\"\n\t\t}\n\n\t}\n\n\n\tcheckIfRateZero(pos){\n\t\treturn pos.items.some(item => item.rate == 0)\n\t}\n\n\n\tonClosePOS(){\n\t\t//check if you still have an invoice to sync\n\t\tif(this.unsyncedPos > 0){\n\t\t\tfrappe.throw(__(`you have ${all_tabs.length} invoice to sync first.`))\n\t\t}\n\t\t//otherwise you can close the voucher\n\t\tlet voucher               = frappe.model.get_new_doc(\"POS Closing Entry\");\n\t\tvoucher.pos_opening_entry = this.POSOpeningEntry.name;\n\t\tvoucher.pos_profile       = this.POSOpeningEntry.pos_profile;\n\t\tvoucher.company           = this.POSOpeningEntry.company ;\n\t\tvoucher.user              = frappe.session.user  ;\n\t\tvoucher.posting_date      = frappe.datetime.now_date();\n\t\tvoucher.posting_time      = frappe.datetime.now_time();\n\n\n\t\tthis.check_in_out_cart.checkList.forEach(check =>{\n\t\t\tlet child = frappe.model.add_child(voucher , 'check_in_out' , 'custom_check_in_out' )\n\t\t\tchild.check_type    = check.check_type\n\t\t\tchild.creation_time = check.creation_time\n\t\t\tchild.amount        = check.amount\n\t\t\tchild.reason        = check.reason\n\t\t\tchild.user          = check.owner\n\t\t})\n\n\t\tfrappe.set_route(\"Form\", \"POS Closing Entry\", voucher.name);\n\t\t//delete the open entry because you create the closing entr,\n\t\t//that my the user submited it, so when the code find its name empty,\n\t\t//it will try to fetch an open pos entry if there is no one opening,\n\t\t//it will force the user to create one.\n\t\tthis.POSOpeningEntry.name = '' ;\n\t}\n\n\n\t/****************************  listeners *******************************/\n\n\tsetListeners(){\n\t\twindow.addEventListener('offline' , function(){\n\t\t\tfrappe.msgprint('you lose the connection (offline mode)')\n\t\t})\n\n\t\twindow.addEventListener('online' , function(){\n\t\t\tfrappe.msgprint('the connection is back (online mode)')\n\t\t})\n\t}\n\n\t/*****************************  tools  **********************************/\n\n\ttoggleKeyboardMode(active){\n\t\tif(active){\n\t\t\tdocument.addEventListener('keydown', event =>{\n\t\t\t\tconsole.log(event.key)\n\t\t\t\tif(event.key == \"q\"){\n\t\t\t\t\tthis.selectedField.field_name = \"quantity\"\n\t\t\t\t\tthis.selected_item_cart.makeSelectedButtonHighlighted();\n\t\t\t\t}else if(event.key == \"p\"){\n\t\t\t\t\tthis.selectedField.field_name = \"rate\"\n\t\t\t\t\tthis.selected_item_cart.makeSelectedButtonHighlighted();\n\t\t\t\t}else if(event.key == \"Backspace\"){\n\t\t\t\t\tif(this.selectedField.field_name == \"quantity\"){\n\t\t\t\t\t\tconst lastValue = parseFloat(this.selectedItem.qty)\n\t\t\t\t\t\tlet newValue    = 0\n\n\t\t\t\t\t\t// Remove the last character and parse the remaining value\n\t\t\t\t\t\tnewValue = parseFloat(`${lastValue}`.slice(0, -1)) || 0;\n\n\t\t\t\t\t\tthis.selectedItem.qty = parseFloat(newValue);\n\t\t\t\t\t\tthis.editPosItemQty(this.selectedItem.name , this.selectedItem.qty);\n\t\t\t\t\t\t//redrawing\n\t\t\t\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\t\t\t}else if(this.selectedField.field_name == \"rate\"){\n\t\t\t\t\t\tconst lastValue = parseFloat(this.selectedItem.rate)\n\t\t\t\t\t\tlet newValue = parseFloat(`${lastValue}`.slice(0,-1)) || 0 ;\n\t\t\t\t\t\tthis.selectedItem.rate = parseFloat(newValue);\n\n\t\t\t\t\t\t//recalculate the rate\n\t\t\t\t\t\tlet oldRate = this.selectedItem.rate;\n\t\t\t\t\t\tlet persont = this.selectedItem.discount_percentage\n\t\t\t\t\t\tlet montant = oldRate * (persont / 100)\n\n\t\t\t\t\t\tthis.selectedItem.discount_percentage = persont;\n\t\t\t\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\t\t\t\tthis.editPosItemDiscountAmount(this.selectedItem.name , this.selectedItem.discount_amount);\n\t\t\t\t\t\tthis.editPosItemRate(this.selectedItem.name , this.selectedItem.rate);\n\n\t\t\t\t\t\t//redrawing\n\t\t\t\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\t\t\t\tthis.item_details.refreshDate(this.selectedItem);\n\t\t\t\t\t}\n\t\t\t\t}else if(this.selectedField.field_name == \"quantity\"){\n\t\t\t\t\tif(parseFloat(event.key) || event.key == \"0\"){\n\t\t\t\t\t\tconst lastValue = parseFloat(this.selectedItem.qty)\n\t\t\t\t\t\tconst newValue  = `${lastValue}` + event.key\n\t\t\t\t\t\tthis.selectedItem.qty = parseFloat(newValue);\n\t\t\t\t\t\tthis.editPosItemQty(this.selectedItem.name , this.selectedItem.qty);\n\t\t\t\t\t\t//redrawing\n\t\t\t\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\t\t\t}\n\t\t\t\t}else if(this.selectedField.field_name == \"rate\"){\n\t\t\t\t\tif(parseFloat(event.key) ||  event.key == \"0\"){\n\t\t\t\t\t\tconst lastValue = parseFloat(this.selectedItem.rate)\n\t\t\t\t\t\tconst newValue  = `${lastValue}` + event.key\n\t\t\t\t\t\tthis.selectedItem.rate = parseFloat(newValue);\n\n\t\t\t\t\t\t//recalculate the rate\n\t\t\t\t\t\tlet oldRate = this.selectedItem.rate;\n\t\t\t\t\t\tlet persont = this.selectedItem.discount_percentage\n\t\t\t\t\t\tlet montant = oldRate * (persont / 100)\n\n\t\t\t\t\t\tthis.selectedItem.discount_percentage = persont;\n\t\t\t\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\t\t\t\tthis.editPosItemDiscountAmount(this.selectedItem.name , this.selectedItem.discount_amount);\n\t\t\t\t\t\tthis.editPosItemRate(this.selectedItem.name , this.selectedItem.rate);\n\n\t\t\t\t\t\t//redrawing\n\t\t\t\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\t\t\t\tthis.item_details.refreshDate(this.selectedItem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\n\t\t}else{\n\t\t\tdocument.removeEventListener('keydown' , event =>{})\n\t\t}\n\t}\n\n\n\tgetItemPrice(item , priceList){\n\t\t//check the mode\n\t\tconst mode = this.settings_data.settings.itemPriceBasedOn\n\n\t\tif(mode == 'brand'){\n\t\t\tif(item.brand == null)\n\t\t\t\treturn 0 ;\n\t\t\tconst price = this.appData.appData.item_prices.find(itemPrice => itemPrice.brand == item.brand && itemPrice.price_list == priceList)\n\t\t\treturn price ? price.price_list_rate  : 0\n\t\t}else if(mode == 'priceList'){\n\t\t\tconst price = this.appData.appData.item_prices.find(itemPrice => itemPrice.item_code == item.item_name && itemPrice.price_list == priceList)\n\t\t\treturn price ? price.price_list_rate  : 0\n\t\t}\n        }\n\n\tcheckServiceWorker(){\n\n\t\t// Check if service workers are supported\n\t\tif (!('serviceWorker' in navigator)) {\n\t\t\treturn;\n\t\t}\n\n\n\t\t// Register the service worker on window load\n \t\twindow.addEventListener('DOMContentLoaded', () => {\n\t\tnavigator.serviceWorker\n\t\t\t.register('./sw.js')\n\t\t\t.then(reg => console.log(\"Service Worker registered successfully.\"))\n\t\t\t.catch(err => console.log(`Service Worker registration failed: ${err}`));\n\t\t});\n\n\n\t\tthis.sw = new pos_ar.PointOfSale.Sw()\n\n\t\t// Additionally, check if DOM is already loaded\n\t\tif (document.readyState === 'complete') {\n\t\t\tnavigator.serviceWorker\n\t\t\t\t.register('../assets/pos_ar/public/js/sw.js')\n\t\t\t\t.then(reg => console.log(\"Service Worker registered successfully.\"))\n\t\t\t\t.catch(err => console.log(`Service Worker registration failed: ${err}`));\n\t\t}\n\n\n\t}\n\n\tcheckUnSyncedPos(){\n\t\tthis.appData.getNotSyncedPosNumber(\n\t\t\t(result)=>{\n\t\t\t\tthis.unsyncedPos = result\n\t\t\t\tif(this.unsyncedPos == 0){\n\t\t\t\t\tthis.customer_box.setSynced(result);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tthis.customer_box.setNotSynced(result);\n\t\t\t\t}\n\t\t\t},\n\t\t\t(err)=>{\n\t\t\t\tconsole.log(`error occured when check unSynced POS : ${err} `)\n\t\t\t}\n\t\t)\n\t}\n\n\taddItemToPosInvoice( clickedItem ){\n\t\tlet clonedItem = structuredClone(clickedItem) ;\n\n\t\tconst posInvoice = this.selectedItemMaps.get(this.selectedTab.tabName);\n\t\tconst posItems   = posInvoice.items;\n\n\t\tlet exist = false ;\n\n\t\tposItems.forEach(item => {\n\t\t\tif(item.name == clickedItem.name){\n\t\t\t\texist = true;\n\t\t\t\titem.qty += 1 ;\n\t\t\t\tconst clone = structuredClone(item)\n\t\t\t\tObject.assign(this.selectedItem , clone)\n\t\t\t}\n\t\t})\n\n\t\tif(!exist){\n\t\t\tclonedItem.discount_amount     = 0 ;\n\t\t\tclonedItem.discount_percentage = 0 ;\n\t\t\tclonedItem.qty                 = 1 ;\n\t\t\tclonedItem.rate                = this.getItemPrice(clickedItem , this.selectedItemMaps.get(this.selectedTab.tabName).priceList);\n\t\t\tposItems.push(clonedItem)\n\n\t\t\tconst clone = structuredClone(clonedItem)\n\t\t\tObject.assign(this.selectedItem , clone)\n\n\t\t}\n\n\n\t}\n\n\tdeleteItemFromPOsInvoice( itemId ){\n\t\tconst posInvoice = this.selectedItemMaps.get(this.selectedTab.tabName);\n\t\tconst posItems   = posInvoice.items ;\n\n\t\tposInvoice.items  = posItems.filter( item => item.name != itemId )\n\n\t\tthis.selectedItem = structuredClone({ name : \"\"})\n\t}\n\n\teditPosItemQty(itemName , qty){\n\t\tlet items = this.selectedItemMaps.get(this.selectedTab.tabName).items\n\t\titems.forEach(item => {\n\t\t\tif(item.name == itemName){\n\t\t\t\titem.qty = qty\n\t\t\t}\n\t\t})\n\t}\n\teditPosItemRate(itemName , rate){\n\t\tlet items = this.selectedItemMaps.get(this.selectedTab.tabName).items\n\t\titems.forEach(item => {\n\t\t\tif(item.name == itemName){\n\t\t\t\titem.rate = rate\n\t\t\t}\n\t\t})\n\t}\n\teditPosItemDiscountPercentage(itemName , discountPercentage){\n\t\tlet items = this.selectedItemMaps.get(this.selectedTab.tabName).items\n\t\titems.forEach(item => {\n\t\t\tif(item.name == itemName){\n\t\t\t\titem.discount_percentage = discountPercentage\n\t\t\t}\n\t\t})\n\t}\n\teditPosItemDiscountAmount(itemName , discountAmount){\n\t\tlet items = this.selectedItemMaps.get(this.selectedTab.tabName).items\n\t\titems.forEach(item => {\n\t\t\tif(item.name == itemName){\n\t\t\t\titem.discount_amount = discountAmount\n\t\t\t}\n\t\t})\n\t}\n\n\tcalculatePaidAmount(posInvoice){\n\t\tlet paidAmountDA = 0;\n\t\tposInvoice.payments.forEach(mode =>{\n\t\t\tpaidAmountDA += mode.amount\n\t\t})\n\t\treturn paidAmountDA\n\t}\n\n};\n", "pos_ar.PointOfSale.pos_item_selector = class {\n\n\tconstructor(\n\t\twrapper           ,\n\t\titem_list         ,\n\t\titemBarcodes      ,\n\t\titem_group_list   ,\n\t\titem_prices       ,\n\t\tsettingsData      ,\n\t\tselectedPriceList ,\n\t\tgetItemPrice      ,\n\t\tautoSelect        ,\n\t\tonItemClick\n\t){\n\t\tthis.wrapper             = wrapper           ;\n\t\tthis.item_list           = item_list         ;\n\t\tthis.item_barcodes       = itemBarcodes      ;\n\t\tthis.item_group_list     = item_group_list   ;\n\t\tthis.item_prices         = item_prices       ;\n\t\tthis.settings_data       = settingsData      ;\n\t\tthis.selected_price_list = selectedPriceList ;\n\t\tthis.get_item_price      = getItemPrice      ;\n\t\tthis.auto_select         = autoSelect        ;\n\t\tthis.on_item_click       = onItemClick       ;\n\n\t\t//class functions invocation\n\t\tthis.start_item_selector();\n        }\n\n\n\tstart_item_selector(){\n\t\tthis.prepare_select_box();\n\t\tthis.setItemGroupsInList();\n\t\tthis.setItemInFlow(this.getItemByItemGroup(\"\"))\n\t\tthis.setListeners();\n\t}\n\n\trefresh(){\n\t\tthis.setItemInFlow(this.getItemByItemGroup(\"\"))\n\t}\n\n\t/***********************  ui  functions  ***************************************/\n\tprepare_select_box(){\n\t\tthis.wrapper.append('<div id=\"SelectorBox\" class=\"columnBox\" ></div>')\n\n\t\tthis.selectorBox  = this.wrapper.find(\"#SelectorBox\");\n\t\tthis.selectorBox.append('<div id=\"selectorBoxHeader\" class=\"rowBox header\"></div>')\n\n\t\tthis.header       = this.selectorBox.find(\"#selectorBoxHeader\");\n\t\tthis.header.append('<h4 class=\"CartTitle\">Items</h4>')\n\t\tthis.header.append('<div id=\"inputsBox\" class=\"rowBox align_center\"></div>')\n\n\t\tthis.inputBox     = this.header.find(\"#inputsBox\");\n\t\tthis.inputBox.append('<input type=\"text\" autocomplete=\"off\"  maxlength=\"140\" placeholder=\"Search by item code, item name or barcode\" id=\"ItemInput\" name=\"item\" placeHolder=\"Enter the customer\">')\n\t\tthis.inputBox.append('<input list=\"ItemGroupList\"  id=\"ItemGroupInput\" name=\"ItemGroup\" placeHolder=\"Item Group\">')\n\t\tthis.inputBox.append('<datalist id=\"ItemGroupList\"></datalist>')\n\n\t\tthis.itemGroupList = this.inputBox.find(\"#ItemGroupList\");\n\t\tthis.itemGroupList.append('<option>fetching Item Groups ...</option>')\n\n\t\tif(!this.settings_data.search_by_group){\n\t\t\tconsole.log(\" see settings \" , this.settings_data)\n\t\t\tthis.inputBox.find(\"#ItemGroupInput\").hide();\n\t\t}\n\n\t\tthis.selectorBox.append('<div id=\"itemsContainer\" class=\"rowBox row_wrap\"></div>')\n\t\tthis.itemsContainer = this.selectorBox.find('#itemsContainer')\n\t}\n\n\n\tsetItemGroupsInList(){\n\t\tconst groupItemList_html = document.getElementById(\"ItemGroupList\");\n\t\tgroupItemList_html.innerHTML = \"\" ;\n\t\tthis.item_group_list.forEach(group_item =>{\n\t\t\tconst option = document.createElement(\"option\");\n\t\t\toption.value = group_item.name;\n\t\t\toption.textContent = group_item.customer_name;\n\t\t\tgroupItemList_html.appendChild(option);\n\t\t})\n\t}\n\n\trefreshItemSelector(){\n\t\tconst seachField = document.getElementById(\"ItemInput\");\n\t\tseachField.value = \"\";\n\n\t\tconst groupItemListInput = document.getElementById(\"ItemGroupInput\");\n\t\tthis.setItemInFlow(this.getItemByItemGroup(groupItemListInput.value))\n\n\t}\n\tsetItemInFlow(filtered_item_list){\n        \tconst itemsContainer_html = document.getElementById(\"itemsContainer\");\n        \titemsContainer_html.innerHTML = \"\";\n\n\n\t\tfor(let i=0 ; i<filtered_item_list.length && i<700 ; i++){\n\t\t\tlet item = filtered_item_list[i];\n                \tconst itemBox = document.createElement(\"div\");\n                \titemBox.classList.add(\"itemBox\");\n                \titemBox.classList.add(\"columnBox\");\n                \titemBox.classList.add(\"C_A_Center\");\n\n                \titemBox.addEventListener('click' , event => {\n\t\t\t\tthis.on_item_click(item);\n                \t});\n\n                \tif(item.image){\n                        \tconst itemImage = document.createElement(\"img\");\n                        \titemImage.classList.add(\"itemImage\");\n                        \titemImage.src = item.image\n                        \titemBox.appendChild(itemImage);\n                \t}\n                \telse{\n                        \tconst itemImageHolder = document.createElement(\"div\");\n                        \titemImageHolder.classList.add(\"itemImage\");\n                        \titemImageHolder.classList.add(\"rowBox\");\n                        \titemImageHolder.classList.add(\"centerItem\");\n                        \tconst firstLatter = document.createElement(\"h1\");\n                        \tfirstLatter.textContent = item.item_name[0];\n                        \tfirstLatter.style.color = \"#707070\";\n                        \titemImageHolder.appendChild(firstLatter);\n                        \titemBox.appendChild(itemImageHolder);\n                \t}\n                \tconst itemName = document.createElement(\"div\");\n                \titemName.textContent = item.item_name ;\n                \titemName.classList.add(\"itemTitle\");\n                \titemBox.appendChild(itemName);\n\n                \tconst price = document.createElement(\"div\");\n                \tprice.classList.add(\"itemPrice\");\n                \tprice.textContent = this.get_item_price(item , this.selected_price_list.name) + \" DA\";\n                \titemBox.appendChild(price);\n                \titemsContainer_html.appendChild(itemBox);\n\n\t\t}\n\t}\n\n\n\t//show and hide\n\tshowCart(){\n\t\tthis.selectorBox.css(\"display\" , \"flex\")\n\t}\n\n\thideCart(){\n\t\tthis.selectorBox.css(\"display\" , \"none\")\n\t}\n\n\t//**************** set listeners method ****************************//\n\tsetListeners(){\n\t\tconst groupItemListInput = document.getElementById(\"ItemGroupInput\");\n                groupItemListInput.addEventListener('input' , (even)=>{\n\t\t\tthis.setItemInFlow(this.getItemByItemGroup(event.target.value))\n\t\t})\n\n\t\tconst itemInput = document.getElementById(\"ItemInput\");\n\t\titemInput.addEventListener('input' , (event)=>{\n\t\t\tthis.setItemInFlow(this.filterListByItemData(event.target.value))\n\t\t})\n\t}\n\n\t//**************** tools method ****************************//\n\n\t//filter list by item code or barcode\n\tfilterListByItemData( value ){\n\n\t\t// Filter barcodes that match the value\n\t\tconst filteredBarcodes = this.item_barcodes.filter(BarCode=> BarCode.barcode == value)\n\n\t\t// Extract the parent item IDs from the filtered barcodes\n\t\tconst barcodeItemIds   = filteredBarcodes.map(cod => cod.parent)\n\t\tif(barcodeItemIds.length == 1){\n\t\t\t//auto fill\n\t\t\tthis.auto_select(this.item_list.find(item => item.name==barcodeItemIds[0] ) )\n\t\t\tconst itemInput = document.getElementById(\"ItemInput\");\n\t\t\titemInput.value = ''\n\t\t\treturn this.item_list\n\t\t}\n\n\t\treturn this.item_list.filter(item =>  barcodeItemIds.includes(item.name)  || item.item_name.toLowerCase().includes(value.toLowerCase()))\n\t}\n\n\n\tgetItemByItemGroup(item_group){\n\n\n\t\tlet groups = [];\n\n\t\tlet getChild = (grp)=>{\n\t\t\tgroups.push(grp);\n\t\t\tthis.item_group_list.forEach(g=>{\n\t\t\t\tif(g.parent_item_group == grp){\n\t\t\t\t\tgroups.push(g.name)\n\t\t\t\t\tif(g.is_group){\n\t\t\t\t\t\tgetChild(g.name)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t};\n\n\n\t\tgetChild(item_group);\n\n\n\t\tlet filtredItemList = [];\n\n\t\tlet getFiltredItems = (group)=>{\n\t\t\tthis.item_list.forEach(item =>{\n\t\t\t\tif(item.item_group == group){\n\t\t\t\t\tfiltredItemList.push(item);\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\n\t\tgroups.forEach(group =>{\n\t\t\tgetFiltredItems(group);\n\t\t})\n\n\n\t\treturn filtredItemList ;\n\t}\n}\n", "pos_ar.PointOfSale.pos_customer_box = class{\n\n\tconstructor(\n\t\twrapper          ,\n\t\tcustomersList    ,\n\t\tselectedCustomer ,\n\t\tbackHome         ,\n\t\tonSync           ,\n\t\tsaveCheckInOut   ,\n\t\tonMenuClick      ,\n\t\tonDebtClick      ,\n\t){\n\t\tthis.wrapper           = wrapper          ;\n\t\tthis.customers_list    = customersList    ;\n\t\tthis.selected_customer = selectedCustomer ;\n\t\tthis.back_home         = backHome         ;\n\t\tthis.on_sync           = onSync           ;\n\t\tthis.on_menu_click     = onMenuClick      ;\n\t\tthis.save_check_in_out = saveCheckInOut   ;\n\t\tthis.on_debt_click     = onDebtClick      ;\n\n\t\t//local\n\t\tthis.online       = true  ;\n\t\tthis.show_menu    = false ;\n\n\t\tthis.start_work()      ;\n\t}\n\n\tstart_work(){\n\t\tthis.prepare_customer_box();\n\t\tthis.checkForSync();\n\t\tthis.setListeners();\n\t}\n\n\tprepare_customer_box(){\n\n\t\tthis.wrapper.append('<div id=\"ActionsContainerBox\" class=\"rowBox align_center\" style=\"order:1;\">');\n\t\tthis.actionContainer = this.wrapper.find('#ActionsContainerBox');\n\n\t\tthis.actionContainer.append('<div id=\"SyncBox\"     class=\"rowBox centerItem\" >');\n\t\tthis.actionContainer.append('<div id=\"HomeBox\"     class=\"rowBox centerItem\"  style=\"display:none;\">');\n\t\tthis.actionContainer.append('<div id=\"DebtBox\"     class=\"rowBox centerItem\" >');\n\t\tthis.actionContainer.append('<div id=\"exchangeBtn\" class=\"rowBox centerItem\" style=\"margin-right:16px;\" >  <img src=\"/assets/pos_ar/images/exchange.png\">  </div>');\n\t\tthis.actionContainer.append('<div id=\"MenuBox\"     class=\"rowBox centerItem\" >');\n\n\t\t//sync btn\n\t\tthis.sync_btn = this.actionContainer.find('#SyncBox')\n\t\tthis.sync_btn.append('<div id=\"syncBoxContent\"> Sync </div>')\n\t\tthis.sync_btn_content = this.sync_btn.find('#syncBoxContent')\n\t\t//exchange btn\n\t\tthis.exchange_btn = this.actionContainer.find('#exchangeBtn')\n\t\t//home btn\n\t\tthis.home = this.actionContainer.find('#HomeBox')\n\t\tthis.home.append('<img src=\"/assets/pos_ar/images/home.png\" alt=\"Home\" id=\"homeBoxIcon\">')\n\t\t//debt btn\n\t\tthis.debt = this.actionContainer.find('#DebtBox')\n\t\tthis.debt.append('<img src=\"/assets/pos_ar/images/debt.png\" alt=\"Debt\" id=\"debtBoxIcon\">')\n\t\t//menu btn\n\t\tthis.menu = this.actionContainer.find('#MenuBox')\n\t\tthis.menu.append('<img src=\"/assets/pos_ar/images/menu.png\" alt=\"Menu\" id=\"MenuBtn\" >')\n\t\tthis.menu.append('<div id=\"menuItemsContainer\"     class=\"columnBox\">');\n\n\t\tthis.menuItemsContainer = this.actionContainer.find('#menuItemsContainer')\n\t\tthis.menuItemsContainer.append('<div id=\"posInvoiceMenuItem\" class=\"menuItem\">Recent POS Invoices</div>')\n\t\tthis.menuItemsContainer.append('<div id=\"checkInOutMenuItem\" class=\"menuItem\">Check In/Out</div>')\n\t\tthis.menuItemsContainer.append('<div id=\"closePosMenuItem\"   class=\"menuItem\">Close the POS</div>')\n\t\tthis.menuItemsContainer.append('<div id=\"settingMenuItem\"    class=\"menuItem\">About</div>')\n\n\t\tthis.pos_invoices = this.menuItemsContainer.find('#posInvoiceMenuItem')\n\t\tthis.check_in_out = this.menuItemsContainer.find('#checkInOutMenuItem')\n\t\tthis.close_pos    = this.menuItemsContainer.find('#closePosMenuItem')\n\t\tthis.setting      = this.menuItemsContainer.find('#settingMenuItem')\n\n\t\t//check in out dialog\n\t\tthis.wrapper.append('<div id=\"darkFloatingBackground\"></div>')\n\t\tthis.dark_floating_background = this.wrapper.find('#darkFloatingBackground');\n\n\t\tthis.wrapper.append('<div id=\"checkInOutDialog\"></div>')\n\t\tthis.check_in_out_dialog = this.wrapper.find('#checkInOutDialog');\n\t\tthis.check_in_out_dialog.css('flex-direction','column')\n\n\t\tthis.check_in_out_dialog.append('<div id=\"checkTypeContainer\"></div>')\n\t\tthis.check_type_container = this.check_in_out_dialog.find('#checkTypeContainer')\n\t\tthis.check_type_container.append('<div id=\"checkInType\"  class=\"rowBox centerItem checkType selected \"><div>Check In</div>  <img src=\"\"></div>')\n\t\tthis.check_type_container.append('<div id=\"checkOutType\" class=\"rowBox centerItem checkType\">  <div>Check Out</div>  <img src=\"\">  </div>')\n\t\t//check type\n\t\tthis.check_in_box  = this.check_type_container.find('#checkInType')\n\t\tthis.check_out_box = this.check_type_container.find('#checkOutType')\n\t\tthis.check_in_out_type = 'In'\n\t\t//input\n\t\tthis.check_in_out_dialog.append('<div class=\"inputGroup\">  <input autocomplete=\"off\" required=\"\" type=\"number\" id=\"check_in_out_input\"><label for=\"name\">Amount</label>   </div>')\n\t\tthis.check_in_out_dialog.append('<div class=\"inputGroup\">  <textarea type=\"text\" id=\"check_in_out_note_textarea\"></textarea><label for=\"name\">Reason</label>   </div>')\n\t\tthis.check_in_out_input = this.check_in_out_dialog.find('#check_in_out_input');\n\t\tthis.check_in_out_note  = this.check_in_out_dialog.find('#check_in_out_note_textarea');\n\t\t//cancel and confirm btn\n\t\tthis.check_in_out_dialog.append('<div id=\"btnsContainers\" class=\"rowBox\"> <div id=\"cancelBtn\" class=\"dialogBtn rowBox centerItem\">Cancel</div><div id=\"confirmBtn\" class=\"dialogBtn rowBox centerItem\">Done</div> </div>')\n\t\tthis.cancel_dialog_btn = this.check_in_out_dialog.find('#cancelBtn')\n\t\tthis.confirm_dialog_btn = this.check_in_out_dialog.find('#confirmBtn')\n\t}\n\n\n\t//show and hide\n\tshowHomeBar(){\n\t\tthis.home.css('display' , 'flex');\n\t}\n\thideHomeBar(){\n\t\tthis.home.css('display' , 'none');\n\t}\n\tshowSyncBar(){\n\t\tthis.sync_btn.css('display' , 'flex');\n\t}\n\thideSyncBar(){\n\t\tthis.sync_btn.css('display' , 'none');\n\t}\n\n\tshowCheckInOutDialog(){\n\t\tthis.check_in_out_dialog.css('display','flex')\n\t\tthis.dark_floating_background.css('display','flex')\n\t}\n\thideCheckInOutDialog(){\n\t\tthis.checkAmount = 0 ;\n\t\tthis.check_in_out_dialog.css('display','none')\n\t\tthis.dark_floating_background.css('display','none')\n\t\tthis.check_in_out_input.val(0)\n\t}\n\n\n\tcheckForSync(){\n\t\tthis.sync_btn.addClass('Synced');\n\t}\n\n\tsetListeners(){\n\n\t\tthis.sync_btn.on('click' , (event)=>{\n\t\t\tfrappe.confirm('Are you sure you want to sync',\n\t\t\t()=>{\n\t\t\t\tthis.on_sync();\n\t\t\t},\n\t\t\t()=>{\n\t\t\t\treturn;\n\t\t\t})\n\t\t})\n\n\t\tthis.close_pos.on('click' , (event)=>{\n\t\t\tthis.on_menu_click('close_pos');\n\t\t})\n\n\t\tthis.pos_invoices.on('click' , (event)=>{\n\t\t\tthis.on_menu_click('recent_pos');\n\t\t})\n\n\t\tthis.setting.on('click' , (event)=>{\n\t\t\tthis.on_menu_click('settings');\n\t\t})\n\n\t\tthis.check_in_out.on('click' , (event)=>{\n\t\t\tthis.on_menu_click('checkInOut');\n\t\t})\n\n\n\t\tthis.menu.on('click' , (event)=>{\n\n\t\t\tif(this.show_menu){\n\t\t\t\tthis.show_menu = !this.show_menu\n\t\t\t\tthis.menuItemsContainer.css('visibility' , 'hidden')\n\t\t\t\tthis.menuItemsContainer.css('opacity' , '0')\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.show_menu = !this.show_menu\n\t\t\t\tthis.menuItemsContainer.css('visibility' , 'visible')\n\t\t\t\tthis.menuItemsContainer.css('opacity' , '1')\n\t\t\t}\n\n\t\t})\n\n\t\tthis.home.on('click' , (event)=>{\n\t\t\tthis.back_home()\n\t\t})\n\n\t\tthis.debt.on('click' , (event)=>{\n\t\t\tthis.on_debt_click()\n\t\t})\n\n\t\tthis.exchange_btn.on('click' , (event)=>{\n\t\t\tthis.showCheckInOutDialog();\n\t\t})\n\n\t\tthis.dark_floating_background.on('click' , (event)=>{\n\t\t\tthis.hideCheckInOutDialog();\n\t\t})\n\n\t\tthis.check_in_box.on('click' , (event)=>{\n\t\t\tthis.check_in_out_type = 'In';\n\t\t\tthis.check_in_box.css('border' , '3px solid #9B5788')\n\t\t\tthis.check_in_box.css('background' , '#ffffff')\n\t\t\tthis.check_out_box.css('border' , '2px solid #e0e0e0')\n\t\t\tthis.check_out_box.css('background' , '#fafafa')\n\t\t})\n\n\t\tthis.check_out_box.on('click' , (event)=>{\n\t\t\tthis.check_in_out_type = 'Out';\n\t\t\tthis.check_out_box.css('border' , '3px solid #9B5788')\n\t\t\tthis.check_out_box.css('background' , '#ffffff')\n\t\t\tthis.check_in_box.css('border' , '2px solid #e0e0e0')\n\t\t\tthis.check_in_box.css('background' , '#fafafa')\n\t\t})\n\n\t\tthis.check_in_out_input.on('input' , (event)=>{\n\t\t})\n\n\t\tthis.cancel_dialog_btn.on('click' , (event)=>{\n\t\t\tconsole.log(\"cancel\")\n\t\t\tthis.hideCheckInOutDialog();\n\t\t})\n\t\tthis.confirm_dialog_btn.on('click' , (event)=>{\n\t\t\tconst checkInOut         = frappe.model.get_new_doc('check_in_out')\n\t\t\tcheckInOut.creation_time = frappe.datetime.now_datetime();\n\t\t\tcheckInOut.user          = frappe.session.user;\n\t\t\tcheckInOut.check_type    = this.check_in_out_type;\n\t\t\tcheckInOut.amount        = parseFloat(this.check_in_out_input.val());\n\t\t\tcheckInOut.reason        = this.check_in_out_note.val()\n\t\t\t//valid inputs\n\t\t\tif(parseFloat(this.check_in_out_input.val()) <= 0 || this.check_in_out_note.val() == ''){\n\t\t\t\tfrappe.msgprint('you should fulfilled fileds.')\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.save_check_in_out(checkInOut);\n\t\t\tthis.hideCheckInOutDialog();\n\t\t\tconsole.log('checkInOut : ' , checkInOut);\n\t\t})\n\t}\n\n\tsetSynced(){\n\t\tthis.sync_btn.addClass('Synced')\n\t\tthis.sync_btn.removeClass('NotSynced')\n\t\tthis.sync_btn_content.html(`Synced`)\n\t}\n\n\tsetNotSynced(counter){\n\t\tthis.sync_btn.addClass('NotSynced')\n\t\tthis.sync_btn.removeClass('Synced')\n\t\tthis.sync_btn_content.html(`Sync (${counter})`)\n\t}\n\n\n\n\n\n}\n", "\npos_ar.PointOfSale.pos_selected_item_cart = class{\n\n\tconstructor(\n\t\twrapper            ,\n\t\tsettingsData       ,\n\t\tselectedItemMaps   ,\n\t\tpriceLists         ,\n\t\tcustomerList       ,\n\t\tbrandList          ,\n\t\tsalesTaxes         ,\n\t\tinvoiceData        ,\n\t\tselectedTab        ,\n\t\tselectedItem       ,\n\t\tselectedField      ,\n\t\tgetItemPrice       ,\n\t\tonSelectedItemClick,\n\t\tonTabClick         ,\n\t\tonKeyPressed       ,\n\t\tcreateNewTab       ,\n\t\tonCheckoutClick    ,\n\t){\n\n\n\t\tthis.wrapper                 = wrapper         ;\n\t\tthis.settings_data           = settingsData    ;\n\t\tthis.selected_item_maps      = selectedItemMaps;\n\t\tthis.price_lists             = priceLists      ;\n\t\tthis.customer_list           = customerList    ;\n\t\tthis.brand_list              = brandList       ;\n\t\tthis.sales_taxes             = salesTaxes      ;\n\t\tthis.invoice_data            = invoiceData     ;\n\t\tthis.selected_tab            = selectedTab     ;\n\t\tthis.selected_item           = selectedItem    ;\n\t\tthis.selected_field          = selectedField   ;\n\t\tthis.get_item_price          = getItemPrice    ;\n\t\tthis.on_key_pressed          = onKeyPressed    ;\n\t\tthis.on_checkout_click       = onCheckoutClick ;\n\t\tthis.on_selected_item_click  = onSelectedItemClick;\n\t\tthis.on_tab_click            = onTabClick      ;\n\t\tthis.create_new_tab          = createNewTab    ;\n\n\t\t//local\n\t\tthis.taxes_map   = new Map();\n\t\tthis.total_tax_amout = 0 ;\n\t\tthis.counter    = 1 ;\n\t\tthis.show_discount = false ;\n\n\t\tthis.start_work();\n\t}\n\n\n\n\t// start the class function\n\tstart_work(){\n\t\tthis.prepare_selected_item_cart();\n\t\tthis.fulfillingSelects();\n\t\tthis.setButtonsListeners();\n\t\tthis.setListener()\n\t}\n\n\t/********************************* ui *****************************************/\n\n\tprepare_selected_item_cart(){\n\n\t\tthis.wrapper.append('<div id=\"tabs\"    class=\"rowBox\"><div id=\"tabs_container\" class=\"rowBox\"></div></div>')\n\t\tthis.wrapper.append('<div id=\"CartBox\" class=\"columnBox\"></div>')\n\n\n\t\tthis.tabs_bar       = this.wrapper.find(\"#tabs\")\n\t\tthis.tabs_container = this.tabs_bar.find('#tabs_container')\n\t\tthis.cartBox        = this.wrapper.find(\"#CartBox\")\n\n\n\t\tthis.tabs_container.append('<div class=\"tab selected rowBox align_center\"><div class=\"tabName\">C1</div><img src=\"/assets/pos_ar/images/cancel.png\" width=\"10px\" height=\"10px\" class=\"tabDeleteBtn\"></div>')\n\t\tthis.tabs_bar.append('<div id=\"addTabBtn\" class=\"tab unselected\">+</div>')\n\n\n\t\tthis.add_tab_button = this.tabs_bar.find('#addTabBtn')\n\n\t\tthis.cartBox.append('<div id=\"CartBoxTopBar\" class=\" rowBox align_center  row_sbtw\"><div>')\n\t\tthis.cartBox.append('<div id=\"cartHeader\" class=\"rowBox row_sbtw align_center\"></div>')\n\t\tthis.cartBox.append('<div id=\"selectedItemsContainer\" class=\"columnBox\"></div>')\n\t\tthis.cartBox.append('<div id=\"cartFooter\" class=\"columnBox\"></div>')\n\n\t\tthis.cartTopBar = this.cartBox.find('#CartBoxTopBar')\n\t\tthis.cartTopBar.append('<div id=\"selectedCustomerInput\"></div>')\n\t\tthis.cartTopBar.append('<div id=\"selectedBrandInput\"></div>')\n\t\tthis.cartTopBar.append('<div id=\"selectedItemsPriceListInput\"></div>')\n\n\t\tthis.customerInputContainer = this.cartTopBar.find(\"#selectedCustomerInput\")\n\t\tthis.customerInputContainer.append('<select  id=\"customerInput\"  placeHolder=\"Choice a customer\">')\n\t\tthis.customerInput = this.customerInputContainer.find('#customerInput')\n\n\t\tthis.priceListInputContainer = this.cartTopBar.find(\"#selectedItemsPriceListInput\")\n\t\tthis.priceListInputContainer.append('<select  id=\"PriceListInput\" name=\"PriceList\" placeHolder=\"Choice a Price list\">')\n\t\tthis.priceListInput = this.priceListInputContainer.find('#PriceListInput')\n\n\t\tthis.cartHeader = this.cartBox.find('#cartHeader')\n\t\tthis.cartHeader.append('<div style=\"font-size:16px;font-weight:600;\"><p>Item</p></div>')\n\t\tthis.cartHeader.append('<div id=\"cartHeaderTitles\" class=\"rowBox\"></div>')\n\n\t\tthis.cartHeaderTitles = this.cartHeader.find('#cartHeaderTitles')\n\t\tthis.cartHeaderTitles.append('<div id=\"quantityTitle\" style=\"font-size:16px;font-weight:600;\" >  <p>Quantity</p></div>')\n\t\tthis.cartHeaderTitles.append('<div id=\"amountTitle\"   style=\"font-size:16px;font-weight:600;\" >  <p>Amount  </p></div>')\n\n\t\tthis.selectedItemContainer = this.cartBox.find('#selectedItemsContainer')\n\n\t\tthis.cartFooter    = this.cartBox.find('#cartFooter')\n\t\tthis.cartFooter.append('<div id=\"cartDetails\" class=\"columnBox\"></div>')\n\t\tthis.cartFooter.append('<div id=\"editSelectedItemCart\"></div>')\n\t\tthis.cartFooter.append('<button class=\"posBtn1\" type=\"button\" id=\"checkoutBtn\"> Payment </button>')\n\n\t\tthis.cartDetails   = this.cartFooter.find('#cartDetails')\n\n\t\tthis.cartDetails.append('<div id=\"discount\" class=\"rowBox align_center row_sbtw\"></div>')\n\t\tthis.cartDetails.append('<div id=\"totalQuantity\" class=\"rowBox align_center row_sbtw\"></div>')\n\t\tthis.cartDetails.append('<div id=\"netTotal\" class=\"rowBox align_center row_sbtw\"></div>')\n\t\tthis.cartDetails.append('<div id=\"VAT\" class=\"columnBox\"></div>')\n\t\tthis.cartDetails.append('<div id=\"grandTotal\" class=\"rowBox align_center row_sbtw\"></div>')\n\n\t\tthis.discount      = this.cartDetails.find('#discount')\n\t\tthis.discount.append('<div id=\"addDiscountTitle\">Add Discount % </div>')\n\t\tthis.discount.append('<input type=\"number\" id=\"addGlobalDiscountInput\" value=\"0\" step=\"1\" min=\"0\" max=\"100\" >')\n\t\tthis.discountInput = this.discount.find('#addGlobalDiscountInput')\n\t\tthis.discountTitle = this.discount.find('#addDiscountTitle')\n\n\n\t\tthis.totalQuantity = this.cartDetails.find('#totalQuantity')\n\t\tthis.totalQuantity.append('<div id=\"totalQuantityTitle\">Total Quantity</div>')\n\t\tthis.totalQuantity.append('<div id=\"totalQuantityValue\">0</div>')\n\n\t\tthis.netTotal      = this.cartDetails.find('#netTotal')\n\t\tthis.netTotal.append('<div id=\"netTotalTitle\">Net Total</div>')\n\t\tthis.netTotal.append('<div id=\"netTotalValue\">0.00</div>')\n\n\t\tthis.vat           = this.cartDetails.find('#VAT')\n\t\tthis.sales_taxes.forEach( tax =>{\n\t\t\tthis.vat.append(`<div id=\"taxConatiner_${tax.name}\" class=\"rowBox align_center row_sbtw\"></div>`)\n\t\t\tconst taxContainer = this.vat.find(`#taxConatiner_${tax.name}`)\n\t\t\ttaxContainer.append(`<div id=\"tax_${tax.name}_Title\">${tax.description}</div>`)\n\t\t\ttaxContainer.append(`<div id=\"tax_${tax.name}_Value\">0.00</div>`)\n\t\t})\n\n\t\tthis.grandTotal    = this.cartDetails.find('#grandTotal')\n\t\tthis.grandTotal.append('<div id=\"grandTotalTitle\">Grand Total</div>')\n\t\tthis.grandTotal.append('<div id=\"grandTotalValue\">0.00</div>')\n\n\n\t\tif(!this.settings_data.settings.showDiscountField){\n\t\t\tthis.setKeyboardOrientation('landscape')\n\t\t\tthis.discount.css('display' , 'none')\n\t\t}\n\n\n\t\tthis.editSelectedItem = this.cartFooter.find('#editSelectedItemCart')\n\t\tthis.editSelectedItem.css('display','flex');\n\t\tthis.editSelectedItem.append('<div class=\"grid-container\">')\n\n\t\tthis.buttonsContainer = this.editSelectedItem.find('.grid-container')\n\t\tthis.buttonsContainer.append('<button id=\"key_1\"        class=\"grid-item\"  data-action=\"1\"        > 1         </button>')\n\t\tthis.buttonsContainer.append('<button id=\"key_2\"        class=\"grid-item\"  data-action=\"2\"        > 2         </button>')\n\t\tthis.buttonsContainer.append('<button id=\"key_3\"        class=\"grid-item\"  data-action=\"3\"        > 3         </button>')\n\t\tthis.buttonsContainer.append('<button id=\"key_quantity\" class=\"grid-item\"  data-action=\"Quantity\" > Quantit\u00E9  </button>')\n\t\tthis.buttonsContainer.append('<button id=\"key_4\"        class=\"grid-item\"  data-action=\"4\"        > 4         </button>')\n\t\tthis.buttonsContainer.append('<button id=\"key_5\"        class=\"grid-item\"  data-action=\"5\"        > 5         </button>')\n\t\tthis.buttonsContainer.append('<button id=\"key_6\"        class=\"grid-item\"  data-action=\"6\"        > 6         </button>')\n\t\tthis.buttonsContainer.append('<button id=\"key_rate\"     class=\"grid-item\"  data-action=\"Rate\"     > Prix      </button>')\n\t\tthis.buttonsContainer.append('<button id=\"key_7\"        class=\"grid-item\"  data-action=\"7\"        > 7         </button>')\n\t\tthis.buttonsContainer.append('<button id=\"key_8\"        class=\"grid-item\"  data-action=\"8\"        > 8         </button>')\n\t\tthis.buttonsContainer.append('<button id=\"key_9\"        class=\"grid-item\"  data-action=\"9\"        > 9         </button>')\n\t\tthis.buttonsContainer.append('<button id=\"key_discount\" class=\"grid-item\"  data-action=\"Discount\" > Remise    </button>')\n\t\tthis.buttonsContainer.append('<button id=\"key_point\"    class=\"grid-item\"  data-action=\".\"        > .         </button>')\n\t\tthis.buttonsContainer.append('<button id=\"key_0\"        class=\"grid-item\"  data-action=\"0\"        > 0         </button>')\n\t\tthis.buttonsContainer.append('<button id=\"key_delete\"   class=\"grid-item\"  data-action=\"Delete\"   > Supprimer </button>')\n\t\tthis.buttonsContainer.append('<button id=\"key_remove\"   class=\"grid-item\"  data-action=\"Remove\" style=\"color:red;font-weight:700;\">Retirer</button>')\n\n\t\tthis.checkoutBtn = this.cartFooter.find('#checkoutBtn')\n\t\tthis.checkoutBtn.on('mousedown' , event =>{\n\t\t\tthis.on_checkout_click();\n\t\t})\n\t}\n\n\tfulfillingSelects(){\n\t\tthis.price_lists.forEach(priceList =>{\n\t\t\tthis.priceListInput.append(`<option value=\"${priceList.name}\">${priceList.price_list_name}</option>`)\n\t\t})\n\t\tthis.customer_list.forEach(customer =>{\n\t\t\tthis.customerInput.append(`<option value=\"${customer.name}\">${customer.customer_name}</option>`)\n\t\t})\n\t}\n\n\n\trefreshTabs(){\n\t\t//clear the tabs_container\n\t\tthis.tabs_container.empty()\n\n\t\tfor(let key of this.selected_item_maps.keys() ){\n\t\t\tif(key == this.selected_tab.tabName){\n\t\t\t\tthis.tabs_container.append(`<div class=\"tab selected rowBox align_center\"><div class=\"tabName\">${key}</div>  <img src=\"/assets/pos_ar/images/cancel.png\" width=\"10px\" height=\"10px\"  class=\"tabDeleteBtn\"  >  </div>`)\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.tabs_container.append(`<div class=\"tab\">  <div class=\"tabName\">${key}</div>  </div>`)\n\t\t\t\t//this.tabs_container.append(`<div class=\"tab rowBox\"><div class=\"tabName\">${key}</div> <img src=\"/assets/pos_ar/images/cancel.png\">  </div>`)\n\t\t\t}\n\t\t}\n\n\t\tthis.tabs_container.find(\".tab\").on('click' , (event)=>{\n\n\t\t\tconst clickedTab = $(event.target).closest('.tab').find('.tabName').text();\n\n\n\t\t\t//console.log(\"\")\n\n\n\t\t\tthis.selected_tab.tabName = clickedTab\n\n\t\t\t//update UI\n\t\t\tthis.refreshTabs();\n\t\t\tthis.refreshSelectedItem();\n\n\t\t\tthis.on_tab_click(clickedTab);\n\n\t\t})\n\n\t\tthis.tabs_container.find(\".tabDeleteBtn\").on('click' , (event) => {\n\n\t\t\t//Stop the click event from propagating to the parent .tab\n\t\t        event.stopPropagation();\n\n\t\t\tconst clickedTab = $(event.target).closest('.tab').find('.tabName').text();\n\n\t\t\tthis.selected_item_maps.delete(clickedTab)\n\n\t\t\tif(this.selected_item_maps.size > 0  ){\n\t\t\t\tthis.selected_tab.tabName = Array.from(this.selected_item_maps.keys())[0]\n\t\t\t\tconsole.log(\"this.selected_tab.tabName : \" , this.selected_tab)\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.createNewTab()\n\t\t\t}\n\n\n\t\t\tthis.refreshTabs()\n\t\t\tthis.refreshSelectedItem()\n\n\n\t\t})\n\t}\n\n\n\trefreshSelectedItem(){\n\n\t\t//refresh price list:\n\t\tthis.priceListInput.val(this.selected_item_maps.get(this.selected_tab.tabName).priceList)\n\t\t//refresh customer list:\n\t\tthis.customerInput.val(this.selected_item_maps.get(this.selected_tab.tabName).customer)\n\n\t\tconst selectedItemsContainer = document.getElementById(\"selectedItemsContainer\");\n\t\tselectedItemsContainer.innerHTML = \"\";\n\n\t\tthis.selected_item_maps.get(this.selected_tab.tabName).items.forEach( item  =>{\n\n\t\t\tconst itemElement   = document.createElement(\"div\");\n\t\t\tconst leftGroup     = document.createElement(\"div\");\n\t\t\tconst rightGroup    = document.createElement(\"div\");\n\t\t\tconst itemName      = document.createElement(\"h5\") ;\n\t\t\tconst itemQuantity  = document.createElement(\"div\") ;\n\t\t\tconst itemPrice     = document.createElement(\"div\") ;\n\n\n\t\t\t//image\n\t\t\t//check if there is an image or not\n\t\t\tif(!this.settings_data.settings.showItemImage){\n\t\t\t\t//dont create image\n\t\t\t}else if(item.image){\n\t\t\t\tconst itemImage   = document.createElement(\"img\");\n\t                        itemImage.src = item.image ;\n        \t                itemImage.classList.add(\"selectedItemImage\");\n                \t        leftGroup.appendChild(itemImage);\n\t\t\t}else{\n\t\t\t\tconst itemImageHolder = document.createElement(\"div\");\n\t\t\t\tconst itemImageLatter = document.createElement(\"div\");\n\n\t\t\t\titemImageHolder.classList.add(\"selectedItemImage\" , \"rowBox\" , \"centerItem\");\n\n\t\t\t\titemImageLatter.textContent = item.name[0]\n\t\t\t\titemImageHolder.appendChild(itemImageLatter);\n\t\t\t\tleftGroup.appendChild(itemImageHolder);\n\t\t\t}\n\n\n\t\t\t//name\n\t\t\titemName.textContent = item.item_name;\n\t\t\titemName.classList.add(\"selectedItemName\");\n\t\t\tleftGroup.appendChild(itemName);\n\n\t\t\t//quantity\n\t\t\titemQuantity.textContent = item.qty\n\t\t\titemQuantity.classList.add(\"itemQuantity\");\n\t\t\trightGroup.appendChild(itemQuantity);\n\t\t\t//price\n\t\t\titemPrice.textContent = (item.rate - item.discount_amount) + \" DA\"\n\t\t\titemPrice.classList.add(\"itemPrice\");\n\t\t\trightGroup.appendChild(itemPrice);\n\n\t\t\t//leftGroup\n\t\t\tleftGroup.classList.add(\"rowBox\" , \"align_center\" , \"leftGroup\")\n\t\t\titemElement.appendChild(leftGroup);\n\n\t\t\t//rightGroup\n\t\t\trightGroup.classList.add(\"rowBox\" , \"align_center\" , \"rightGroup\")\n\t\t\titemElement.appendChild(rightGroup);\n\n\n\t\t\t//item\n\t\t\titemElement.classList.add(\"rowBox\" , \"align_center\" , \"row_sbtw\" , \"ItemElement\" , \"pointer\")\n\t\t\tif(item.name == this.selected_item.name)\n\t\t\t\titemElement.classList.add(\"selected\")\n\t\t\titemElement.addEventListener(\"click\" , event =>{\n\t\t\t\tthis.makeItemHighlight(itemElement)\n\t\t\t\tthis.on_selected_item_click(item);\n\t\t\t})\n\n\t\t\tselectedItemsContainer.appendChild(itemElement);\n\n\t\t})\n\n\t\tthis.calculateNetTotal();\n\t\tthis.calculateVAT();\n\t\tthis.calculateQnatity();\n\t\tthis.calculateGrandTotal();\n\t}\n\n\tcreateNewTab(){\n\t\t\tif(this.tabs_container.find('div.tab').length >= 7){\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.counter += 1 ;\n\t\t\tthis.create_new_tab(this.counter);\n\t\t\t//update UI\n\t\t\tthis.refreshTabs()\n\t\t\tthis.refreshSelectedItem()\n\t}\n\n\tcreateTabForEditPOS(){\n\t\tthis.counter += 1 ;\n\t\treturn this.counter;\n\t}\n\n\tshowKeyboard(){\n\t\tthis.editSelectedItem.css('display','flex')\n\t}\n\n\thideKeyboard(){\n\t\tthis.editSelectedItem.css('display','none')\n\t}\n\n\tsetKeyboardOrientation( orientation ){\n\n\t\tconst discount   = this.cartDetails.find('#discount')\n\t\tconst quantity   = this.cartDetails.find('#totalQuantity')\n\t\tconst netTotal   = this.cartDetails.find('#netTotal')\n\t\tconst grandTotal = this.cartDetails.find('#grandTotal')\n\n\t\tif(orientation == \"landscape\"){\n\t\t\tthis.cartDetails.css('display' , 'flex')\n\t\t\tthis.cartDetails.addClass('rowBox align_center')\n\t\t\tthis.cartDetails.removeClass('columnBox')\n\t\t\tdiscount.css('display' , 'none')\n\t\t\tthis.vat.css('display' , 'none')\n\t\t\t//make the text smaller\n\t\t\tquantity.css('font-size' , 'smaller')\n\t\t\tnetTotal.css('font-size' , 'smaller')\n\t\t\tgrandTotal.css('font-size' , 'small')\n\t\t\tgrandTotal.css('font-weight' , '500')\n\t\t}\n\t\telse{\n\t\t\tthis.cartDetails.addClass('columnBox')\n\t\t\tthis.cartDetails.removeClass('rowBox')\n\t\t\tif(this.settings_data.settings.showDiscountField){\n\t\t\t\tdiscount.css('display','flex')\n\t\t\t}\n\t\t\tthis.vat.css('display' , 'flex')\n\n\t\t\t//reset\n\t\t\tquantity.css('font-size'   , 'small' )\n\t\t\tnetTotal.css('font-size'   , 'small' )\n\t\t\tgrandTotal.css('font-size' , 'larger')\n\t\t\tgrandTotal.css('font-weight' , '700' )\n\t\t}\n\t}\n\n\tmakeSelectedButtonHighlighted(){\n\t\tconst quantityButton = this.buttonsContainer.find('#key_quantity')\n\t\tconst rateButton     = this.buttonsContainer.find('#key_rate')\n\t\tconst discountButton = this.buttonsContainer.find('#key_discount')\n\n\t\tif(this.selected_field.field_name == \"quantity\"){\n\t\t\tquantityButton.addClass('selected')\n\t\t\trateButton.removeClass('selected')\n\t\t\tdiscountButton.removeClass('selected')\n\t\t}\n\t\telse if(this.selected_field.field_name == \"rate\"){\n\t\t\tquantityButton.removeClass('selected')\n\t\t\trateButton.addClass('selected')\n\t\t\tdiscountButton.removeClass('selected')\n\t\t}\n\t\telse if(this.selected_field.field_name == \"discount_percentage\"){\n\t\t\tquantityButton.removeClass('selected')\n\t\t\trateButton.removeClass('selected')\n\t\t\tdiscountButton.addClass('selected')\n\t\t}\n\t\telse{\n\t\t\tquantityButton.removeClass('selected')\n\t\t\trateButton.removeClass('selected')\n\t\t\tdiscountButton.removeClass('selected')\n\t\t}\n\n\t}\n\n\n\t//hide\n\thideCart(){\n\t\tthis.tabs_bar.css('display' , 'none');\n\t\tthis.cartBox.css('display' , 'none');\n\t}\n\t//hide\n\tshowCart(){\n\t\tthis.tabs_bar.css('display' , 'flex');\n\t\tthis.cartBox.css('display' , 'flex');\n\t}\n\t/************************  set listeners  ***************************/\n\n\tsetButtonsListeners(){\n\t\tconst key_0        = this.buttonsContainer.find('#key_0')\n\t\tconst key_1        = this.buttonsContainer.find('#key_1')\n\t\tconst key_2        = this.buttonsContainer.find('#key_2')\n\t\tconst key_3        = this.buttonsContainer.find('#key_3')\n\t\tconst key_4        = this.buttonsContainer.find('#key_4')\n\t\tconst key_5        = this.buttonsContainer.find('#key_5')\n\t\tconst key_6        = this.buttonsContainer.find('#key_6')\n\t\tconst key_7        = this.buttonsContainer.find('#key_7')\n\t\tconst key_8        = this.buttonsContainer.find('#key_8')\n\t\tconst key_9        = this.buttonsContainer.find('#key_9')\n\t\tconst key_quantity = this.buttonsContainer.find('#key_quantity')\n\t\tconst key_discount = this.buttonsContainer.find('#key_discount')\n\t\tconst key_rate     = this.buttonsContainer.find('#key_rate')\n\t\tconst key_remove   = this.buttonsContainer.find('#key_remove')\n\t\tconst key_delete   = this.buttonsContainer.find('#key_delete')\n\t\tconst key_point    = this.buttonsContainer.find('#key_point')\n\n\t\tlet keys = [key_0 , key_1 , key_2 , key_3 , key_4 , key_5 , key_6 , key_7 , key_8 , key_9 , key_quantity , key_discount , key_rate , key_remove , key_delete , key_point]\n\n\n\t\tkeys.forEach(key =>{\n\t\t\tkey.on('mousedown' , (event)=>{\n\t\t\t\tevent.preventDefault();\n\t\t\t\tconst keyContent = key.data('action');\n\n\t\t\t\tif(!isNaN(keyContent)){\n\t\t\t\t\tthis.on_key_pressed( \"addToField\" , keyContent)\n\t\t\t\t}\n\t\t\t\telse if(keyContent == \".\"){\n\t\t\t\t\tthis.on_key_pressed( \"addToField\" , keyContent)\n\t\t\t\t}\n\t\t\t\telse if(keyContent == \"Quantity\"){\n\t\t\t\t\tthis.on_key_pressed( \"quantity\" , null)\n\t\t\t\t}\n\t\t\t\telse if(keyContent == \"Rate\"){\n\t\t\t\t\tthis.on_key_pressed( \"rate\" , null)\n\t\t\t\t}\n\t\t\t\telse if(keyContent == \"Discount\" && this.settings_data.settings.showDiscountField){\n\t\t\t\t\tthis.on_key_pressed( \"discount\" , null)\n\t\t\t\t}\n\t\t\t\telse if(keyContent == \"Remove\"){\n\t\t\t\t\tthis.on_key_pressed( \"remove\" , null)\n\t\t\t\t}\n\t\t\t\telse if(keyContent == \"Delete\"){\n\t\t\t\t\tthis.on_key_pressed( \"delete\" , null)\n\t\t\t\t}\n\n\t\t\t})\n\t\t})\n\n\t}\n\n\tsetListener(){\n\n\t\tthis.add_tab_button.on('mousedown' , (event)=>{\n\t\t\tthis.createNewTab()\n\t\t})\n\n\n\t\tthis.tabs_container.find(\".tabDeleteBtn\").on('click' , (event) => {\n\t\t\t//Stop the click event from propagating to the parent .tab\n\t\t        event.stopPropagation();\n\n\t\t\tconst clickedTab = $(event.target).closest('.tab').find('.tabName').text();\n\n\t\t\tthis.selected_item_maps.delete(clickedTab)\n\n\t\t\tif(this.selected_item_maps.size > 0  ){\n\t\t\t\tthis.selected_tab.tabName = Array.from(this.selected_item_maps.keys())[0]\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.createNewTab()\n\t\t\t}\n\n\n\t\t\tthis.refreshTabs()\n\t\t\tthis.refreshSelectedItem()\n\n\t\t})\n\n\n\t\tthis.discountInput.on('input' , (event)=> {\n\t\t\tif(event.target.value == ''){\n\t\t\t\tthis.selected_item_maps.get(this.selected_tab.tabName).additional_discount_percentage = 0\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse if(event.target.value > 100){\n\t\t\t\tthis.selected_item_maps.get(this.selected_tab.tabName).additional_discount_percentage = 100\n\t\t\t\treturn;\n\t\t\t}\n\n\n\t\t\tthis.selected_item_maps.get(this.selected_tab.tabName).additional_discount_percentage = parseFloat(event.target.value)\n\n\t\t\t//recalculation\n\t\t\tthis.calculateNetTotal()\n\t\t\tthis.calculateVAT()\n\t\t\tthis.calculateGrandTotal()\n\t\t})\n\t\tthis.discountInput.on('blur' , (event)=> {\n\t\t\tif(event.target.value == ''){\n\t\t\t\tevent.target.value = 0 ;\n\t\t\t}\n\t\t\telse if(event.target.value > 100){\n\t\t\t\tevent.target.value = 100 ;\n\t\t\t}\n\n\t\t\t//recalculation\n\t\t\tthis.calculateNetTotal()\n\t\t\tthis.calculateVAT()\n\t\t\tthis.calculateGrandTotal()\n\n\t\t})\n\n\n\t\tthis.priceListInput.on('input' , (event) =>{\n\t\t\tthis.selected_item_maps.get(this.selected_tab.tabName).priceList = event.target.value;\n\t\t\t//reset items rate:\n\t\t\tthis.resetItemRateBaseOnPriceList()\n\t\t\t//update the UI\n\t\t\tthis.refreshSelectedItem()\n\t\t})\n\n\t\tthis.customerInput.on('input' , (event)=>{\n\t\t\tthis.selected_item_maps.get(this.selected_tab.tabName).customer = event.target.value;\n\t\t})\n\t}\n\n\t/*************************  tools  **********************************/\n\n\n\tcalculateNetTotal(){\n\n\t\tlet netTotal = 0;\n\t\tthis.selected_item_maps.get(this.selected_tab.tabName).items.forEach( item => {\n\t\t\tnetTotal += item.rate * item.qty\n\t\t})\n\n\t\tif(this.selected_item_maps.get(this.selected_tab.tabName).additional_discount_percentage > 0){\n\t\t\tnetTotal -= (netTotal * (this.selected_item_maps.get(this.selected_tab.tabName).additional_discount_percentage / 100))\n\t\t}\n\t\tconst netTotal_HTML = document.getElementById(\"netTotalValue\");\n\t\tnetTotal_HTML.textContent  = netTotal;\n\t\tthis.invoice_data.netTotal = netTotal;\n\t}\n\n\tcalculateVAT(){\n\t\tthis.sales_taxes.forEach( tax =>{\n\t\t\tlet saleTaxAmount = 0 ;\n\t\t\tlet taxPercentage = (tax.rate / 100)\n\t\t\tconst calculatedTax = (this.invoice_data.netTotal * taxPercentage).toFixed(2)\n\t\t\tthis.taxes_map.set(tax.name , calculatedTax)\n\t\t\tconst tax_HTML = document.getElementById(`tax_${tax.name}_Value`);\n\t\t\ttax_HTML.textContent = this.taxes_map.get(tax.name);\n\n\t\t})\n\t}\n\n\tcalculateTotalTaxAmount(){\n\t\tlet result = 0 ;\n\t\tthis.taxes_map.forEach(tax => {\n\t\t\tresult += tax ;\n\t\t})\n\t\treturn result ;\n\t}\n\n\n\tcalculateQnatity(){\n\t\tlet quantity = 0;\n\t\tthis.selected_item_maps.get(this.selected_tab.tabName).items.forEach( item => {\n\t\t\tquantity += item.qty\n\t\t})\n\t\tconst totalQuantity_HTML = document.getElementById(\"totalQuantityValue\");\n\t\ttotalQuantity_HTML.textContent = quantity;\n\t}\n\n\tcalculateGrandTotal(){\n\t\tlet grandTotal = 0 ;\n\t\tlet netTotal   = this.invoice_data.netTotal ;\n\t\tlet taxAmount  = 0 ;\n\n\t\tthis.taxes_map.forEach(tax =>{\n\t\t\ttaxAmount += parseFloat(tax)\n\t\t})\n\n\t\tgrandTotal = (netTotal + taxAmount) ;\n\t\tconst grandTotal_HTML = document.getElementById(\"grandTotalValue\");\n\t\tgrandTotal_HTML.textContent = (grandTotal).toFixed(2);\n\n\t\tthis.invoice_data.grandTotal = grandTotal\n\t}\n\n\n\tresetItemRateBaseOnPriceList(){\n\t\tthis.selected_item_maps.get(this.selected_tab.tabName).items.forEach( item  => {\n\t\t\titem.rate                = this.get_item_price(item , this.selected_item_maps.get(this.selected_tab.tabName).priceList)\n\t\t\titem.discount_percentage = 0.00\n\t\t\titem.discount_amount     = 0.00\n\t\t})\n\t}\n\n\n\tmakeItemHighlight(itemElement){\n\t\tconst selectedItemsContainer = document.getElementById(\"selectedItemsContainer\");\n\t\tconst selectedItems = selectedItemsContainer.querySelectorAll(\".selected\")\n\t\tselectedItems.forEach(selectedItem=>{\n\t\t\tselectedItem.classList.remove(\"selected\");\n\t\t})\n\t\titemElement.classList.add(\"selected\")\n\t}\n\n\tcleanHeighlight(){\n\t\tconst selectedItemsContainer = document.getElementById(\"selectedItemsContainer\");\n\t\tconst selectedItems = selectedItemsContainer.querySelectorAll(\".selected\")\n\t\tselectedItems.forEach(selectedItem=>{\n\t\t\tselectedItem.classList.remove(\"selected\");\n\t\t})\n\n\t}\n\n\n\n}\n", "pos_ar.PointOfSale.pos_item_details = class{\n\n\tconstructor(\n\t\twrapper,\n\t\twarehouse,\n\t\tpriceLists,\n\t\titemPrices,\n\t\tbinList,\n\t\tselectedItem,\n\t\tselectedField,\n\t\tonInput,\n\t\tonClose,\n\t){\n\t\tthis.wrapper        = wrapper   ;\n\t\tthis.warehouse      = warehouse ;\n\t\tthis.price_lists    = priceLists;\n\t\tthis.item_prices    = itemPrices;\n\t\tthis.selected_item  = selectedItem ;\n\t\tthis.selected_field = selectedField;\n\t\tthis.on_input       = onInput;\n\t\tthis.on_close_cart  = onClose;\n\t\tthis.bin_list       = binList;\n\n\t\tthis.start_the_work();\n\t}\n\n\n\t// start function\n\tstart_the_work(){\n\t\tthis.prepare_item_details_cart();\n\t\tthis.setDetailsFieldsListeners();\n\t}\n\n\n\t/****************************    ui functions   **********************************/\n\n        prepare_item_details_cart(){\n                this.wrapper.append('<div id=\"itemDetailsCart\" class=\"columnBox align_center\"><div>')\n\n                this.item_details_cart = this.wrapper.find(\"#itemDetailsCart\")\n                this.item_details_cart.append('<div id=\"itemDetailsCartHeader\" class=\"rowBox header align_center row_sbtw\"></div>')\n\n                this.cart_header = this.item_details_cart.find('#itemDetailsCartHeader')\n                this.cart_header.append('<h4 class=\"CartTitle\">Item Details</h4>')\n                this.cart_header.append('<img src=\"/assets/pos_ar/images/cancel.png\" alt=\"Cancel Button\" id=\"itemDetailsCartXBtn\" class=\"xBtn\">')\n\n                this.close_btn = this.cart_header.find(\"#itemDetailsCartXBtn\").on(\"click\", (event) =>{\n                        this.on_close_cart();\n                })\n\n\t\tthis.item_details_cart.append('<div id=\"itemDetailsHeader\" class=\"rowBox\"></div>')\n\n\t\tthis.header_details = this.item_details_cart.find('#itemDetailsHeader')\n\t\tthis.header_details.append('<div id=\"detailsItemImage\" class=\"rowBox centerItem\"></div>')\n\t\tthis.header_details.append('<div id=\"price_and_name\" class=\"columnBox\"></div>')\n\n\t\tthis.price_and_name_details = this.header_details.find('#price_and_name')\n\t\tthis.price_and_name_details.append('<div id=\"detailsItemName\" class=\"rowBox align_center\"></div>')\n\t\tthis.price_and_name_details.append('<div id=\"detailsItemGroupWarhouseContainer\" class=\"rowBox align_center row_sa\"></divr>')\n\n\t\tthis.item_group_warehouse_details = this.price_and_name_details.find('#detailsItemGroupWarhouseContainer')\n\t\tthis.item_group_warehouse_details.append('<div id=\"detailsItemGroup\" class=\"rowBox align_center\">Group : ...</div>')\n\t\tthis.item_group_warehouse_details.append('<div id=\"detailsItemWarehouse\" class=\"rowBox align_center\">Warehouse : ...</div>')\n\n\t\tthis.item_details_cart.append('<div id=\"itemDetailsAll\"  class=\"rowBox\"></div>')\n\n\t\tthis.details_all = this.item_details_cart.find('#itemDetailsAll')\n\t\tthis.details_all.append('<div id=\"itemDetails_C1\" class=\"columnBox\"></div>')\n\n\t\tthis.c1 = this.details_all.find('#itemDetails_C1')\n\t\tthis.c1.append('<div class=\"columnBox\"><label for=\"itemDetailsQuantityInput\">Quantity</label><input type=\"float\" id=\"itemDetailsQuantityInput\" class=\"pointerCursor\"></div>')\n\t\tthis.c1.append('<div class=\"columnBox\"><label for=\"itemDetailsRateInput\">Rate</label><input type=\"float\" id=\"itemDetailsRateInput\" class=\"pointerCursor\"></div>')\n\t\tthis.c1.append('<div class=\"columnBox\"><label for=\"itemDetailsDiscountInput\">Discount (%)</label><input type=\"float\" id=\"itemDetailsDiscountInput\" class=\"pointerCursor\"></div>')\n\t\tthis.c1.append('<div class=\"columnBox\"><label for=\"itemDetailsAvailableInput\">Available Qty at Warehouse</label><input type=\"float\" id=\"itemDetailsAvailableInput\" disabled></div>')\n\n\n\t\tthis.details_all.append('<div id=\"itemDetails_C2\" class=\"columnBox\"></div>')\n\n\t\tthis.c2 = this.details_all.find('#itemDetails_C2')\n\t\tthis.c2.append('<div class=\"columnBox\"><label for=\"itemDetailsUomInput\">UOM *</label><input type=\"text\" id=\"itemDetailsUomInput\"  disabled></div>')\n\t\tthis.c2.append('<div class=\"columnBox\"><label for=\"detailsRateWithDescount\">Discounted Rate</label>  <input type=\"text\" id=\"discountedRateInput\" disabled>  </div>')\n\t\tthis.c2.append('<div class=\"columnBox hideMe\"><label for=\"detailsPriceList\">Price List *</label><input list=\"detailsPriceList\" id=\"detailsItemPriceListInput\" class =\"rowBox align_center pointerCursor\"><datalist id=\"detailsPriceList\"><option>fetching Price Lists ...</option></datalist></div>')\n\t\tthis.c2.append('<div class=\"columnBox\"><label for=\"itemDetailsDiscountMontantInput\">Discount (montant)</label><input type=\"float\" id=\"itemDetailsDiscountMontantInput\" class=\"pointerCursor\"></div>')\n\t\tthis.c2.append('<div class=\"columnBox\"><label for=\"itemDetailsPriceListRateInput\">Price List Rate</label><input type=\"text\" id=\"itemDetailsPriceListRateInput\" disabled></div>')\n\n\n\n\t}\n\n\trefreshDate(item){\n\n\t\tconst imageContainer    = document.getElementById(\"detailsItemImage\") ;\n\t\tconst name              = document.getElementById(\"detailsItemName\");\n\t\tconst warehouse         = document.getElementById(\"detailsItemWarehouse\");\n\t\tconst itemGroup         = document.getElementById(\"detailsItemGroup\");\n\n\t\tconst quantity             = document.getElementById(\"itemDetailsQuantityInput\");\n\t\tconst rate                 = document.getElementById(\"itemDetailsRateInput\");\n\t\tconst discountedRate       = document.getElementById(\"discountedRateInput\");\n\t\tconst discount_percentage  = document.getElementById(\"itemDetailsDiscountInput\");\n\t\tconst discount_amount      = document.getElementById(\"itemDetailsDiscountMontantInput\");\n\t\tconst available            = document.getElementById(\"itemDetailsAvailableInput\");\n\n\t\tconst uom           = document.getElementById(\"itemDetailsUomInput\");\n\t\tconst priceList     = document.getElementById(\"detailsItemPriceListInput\");\n\t\tconst priceListRate = document.getElementById(\"itemDetailsPriceListRateInput\");\n\n\t\t//populate\n\t\tif(item.image){\n\t\t\tconst image = document.createElement(\"img\");\n\t\t\timage.src = item.image;\n\t\t\timageContainer.innerHTML = \"\";\n\t\t\timageContainer.appendChild(image);\n\t\t}\n\t\telse{\n\t\t\tconst image = document.createElement(\"div\");\n\t\t\timage.textContent = item.item_name[0];\n\t\t\timage.style.fontSize = \"xx-large\";\n\t\t\timage.style.fontWeight = \"700\";\n\t\t\timageContainer.innerHTML = \"\";\n\t\t\timageContainer.appendChild(image);\n\t\t}\n\n\t\t//name\n\t\tname.textContent  = item.item_name;\n\t\tname.classList.add(\"rowBox\" , \"align_center\");\n\n\n\t\t//quantity\n\t\tquantity.value = item.qty\n\n\t\t//rate\n\t\trate.value = item.rate\n\t\tdiscountedRate.value = item.rate - item.discount_amount\n\n\t\t//discount\n\t\tdiscount_amount.value     = item.discount_amount ?? 0.00;\n\t\tdiscount_percentage.value = item.discount_percentage ?? 0.00;\n\n\n\t\t//available\n\t\tavailable.value = this.getQtyInWarehouse(item.name ,  this.warehouse)\n\n\n\t\t//uom\n\t\tuom.value = item.stock_uom\n\n\n\t\t//priceList\n\t\tpriceList.value = this.price_lists[0].price_list_name\n\t\t//warehouse\n\t\twarehouse.textContent = \"Warehouse : \" + this.warehouse\n\t\t//item group\n\t\titemGroup.textContent = \"Item Group : \" + item.item_group\n\n\t\t//priceListRate\n\t\tpriceListRate.value = this.getItemPrice(item.name) + \"DA\"\n\n\n\t\tconsole.log(\"end ref\")\n\n\n\t\t//hightlited fields\n\t\tthis.makeSelectedFieldHighlighted()\n\t}\n\n\tshow_cart(){\n\t\tthis.item_details_cart.css(\"display\" , \"flex\");\n\t}\n\n\thide_cart(){\n\t\tthis.item_details_cart.css(\"display\" , \"none\");\n\t}\n\n\tmakeSelectedFieldHighlighted(){\n\n\n\t\tif(this.selected_field.field_name == \"quantity\"){\n\t\t\tthis.c1.find('#itemDetailsQuantityInput').addClass('selected')\n\t\t\tthis.c1.find('#itemDetailsRateInput').removeClass('selected')\n\t\t\tthis.c1.find('#itemDetailsDiscountInput').removeClass('selected')\n\t\t}\n\t\telse if(this.selected_field.field_name == \"rate\"){\n\t\t\tthis.c1.find('#itemDetailsQuantityInput').removeClass('selected')\n\t\t\tthis.c1.find('#itemDetailsRateInput').addClass('selected')\n\t\t\tthis.c1.find('#itemDetailsDiscountInput').removeClass('selected')\n\t\t}\n\t\telse if(this.selected_field.field_name == \"discount_percentage\"){\n\t\t\tthis.c1.find('#itemDetailsQuantityInput').removeClass('selected')\n\t\t\tthis.c1.find('#itemDetailsRateInput').removeClass('selected')\n\t\t\tthis.c1.find('#itemDetailsDiscountInput').addClass('selected')\n\t\t}\n\t\telse{\n\t\t\tthis.c1.find('#itemDetailsQuantityInput').removeClass('selected')\n\t\t\tthis.c1.find('#itemDetailsRateInput').removeClass('selected')\n\t\t\tthis.c1.find('#itemDetailsDiscountInput').removeClass('selected')\n\t\t}\n\n\t}\n\n\n\trequestFocus(field){\n\t\tif(field == \"quantity\"){\n\t\t\tthis.c1.find('#itemDetailsQuantityInput').focus();\n\t\t}\n\t\telse if(field == \"rate\"){\n\t\t\tthis.c1.find('#itemDetailsRateInput').focus();\n\t\t}\n\t\telse if(field == \"discount_percentage\"){\n\t\t\tthis.c1.find('#itemDetailsDiscountInput').focus();\n\t\t}\n\t\telse if(field == \"discount_amount\"){\n\t\t\tthis.c1.find('#itemDetailsDiscountMontantInput').focus();\n\t\t}\n\t}\n\n\n/*\n\nelse if(keyContent == \".\" && !selectedField.value.includes(\".\")){\n                                        this.on_key_pressed( \"addToField\" , key.text())\n                                }\n\n*/\n\taddToField(field , value){\n\n\t\tconsole.log('field : ' , field , 'value : ' , value )\n\n\t\tif(field == \"quantity\"){\n\t\t\tthis.c1.find('#itemDetailsQuantityInput').val( (index,currentValue) =>{\n\t\t\t\tif(value == \".\" && currentValue.includes(\".\"))\n\t\t\t\t\treturn currentValue\n\t\t\t\telse\n\t\t\t\t\treturn currentValue + value\n\t\t\t})\n\t\t}\n\t\telse if(field == \"rate\"){\n\t\t\tthis.c1.find('#itemDetailsRateInput').val( (index,currentValue) =>{\n\t\t\t\tif(value == \".\" && currentValue.includes(\".\"))\n\t\t\t\t\treturn currentValue\n\t\t\t\telse\n\t\t\t\t\treturn currentValue + value\n\t\t\t})\n\t\t}\n\t\telse if(field == \"discount_percentage\"){\n\t\t\tthis.c1.find('#itemDetailsDiscountInput').val( (index,currentValue) =>{\n\t\t\t\tif(value == \".\" && currentValue.includes(\".\"))\n\t\t\t\t\treturn currentValue\n\t\t\t\telse\n\t\t\t\t\treturn currentValue + value\n\t\t\t})\n\n\t\t}\n\t\telse if(field == \"discount_amount\"){\n\t\t\tthis.c1.find('#itemDetailsDiscountInput').val( (index,currentValue) =>{\n\t\t\t\tif(value == \".\" && currentValue.includes(\".\"))\n\t\t\t\t\treturn currentValue\n\t\t\t\telse\n\t\t\t\t\treturn currentValue + value\n\t\t\t})\n\n\t\t}\n\n\t}\n\n\tdeleteCharacter(){\n\n\t\tlet field = this.selected_field.field_name\n\n\t\tlet newValue = 0 ;\n\n\t\tif(field == \"quantity\"){\n\n\t\t\tlet field = this.c1.find(\"#itemDetailsQuantityInput\")\n\n\t\t\tlet cursor = field[0].selectionStart;\n\n\t\t\tfield.val( (index , currentValue) =>{\n\n\t\t\t\tconsole.log(\"length : \" , currentValue , \" cursor : \" , cursor);\n\n\t\t\t\tif( currentValue.length < 0 ){\n\t\t\t\t\tnewValue = 0 ;\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\telse if( currentValue.length == 1){\n\t\t\t\t\tnewValue = 0 ;\n\t\t\t\t\treturn 0 ;\n\t\t\t\t}\n\t\t\t\telse if( cursor == 0 ){\n\t\t\t\t\tnewValue = currentValue;\n\t\t\t\t\treturn currentValue;\n\t\t\t\t}\n\t\t\t\telse if( cursor == currentValue.length){\n\t\t\t\t\tnewValue = currentValue.slice(0 , cursor-1)\n\t\t\t\t\treturn currentValue.slice(0 , cursor-1)\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnewValue = currentValue.slice(0,cursor-1) + currentValue.slice(cursor)\n\t\t\t\t\treturn currentValue.slice(0,cursor-1) + currentValue.slice(cursor)\n\t\t\t\t}\n\t\t\t})\n\n\n\t\t\t// Use setTimeout to ensure the new value is set before adjusting cursor\n\t\t\tsetTimeout(() => {\n\t\t\t\tfield[0].setSelectionRange(cursor - 1, cursor - 1); // Move cursor back after deletion\n\t\t\t\tfield[0].focus(); // Ensure the input is focused\n\t\t\t}, 0);\n\n\t\t}\n\t\tif(field == \"rate\"){\n\n\t\t\tlet field = this.c1.find(\"#itemDetailsRateInput\")\n\n\t\t\tlet cursor = field[0].selectionStart;\n\n\t\t\tfield.val( (index , currentValue) =>{\n\n\t\t\t\tif( currentValue.length < 0 ){\n\t\t\t\t\tnewValue = 0 ;\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\telse if( currentValue.length == 1){\n\t\t\t\t\tnewValue = 0 ;\n\t\t\t\t\treturn 0 ;\n\t\t\t\t}\n\t\t\t\telse if( cursor == 0 ){\n\t\t\t\t\tnewValue = currentValue ;\n\t\t\t\t\treturn currentValue;\n\t\t\t\t}\n\t\t\t\telse if( cursor == currentValue.length){\n\t\t\t\t\tnewValue = currentValue.slice(0 , cursor-1) ;\n\t\t\t\t\treturn currentValue.slice(0 , cursor-1)\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnewValue = currentValue.slice(0,cursor-1) + currentValue.slice(cursor)\n\t\t\t\t\treturn currentValue.slice(0,cursor-1) + currentValue.slice(cursor)\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t// Use setTimeout to ensure the new value is set before adjusting cursor\n\t\t\tsetTimeout(() => {\n\t\t\t\tfield[0].setSelectionRange(cursor - 1, cursor - 1); // Move cursor back after deletion\n\t\t\t\tfield[0].focus(); // Ensure the input is focused\n\t\t\t}, 0);\n\n\n\t\t}\n\t\tif(field == \"discount_percentage\"){\n\n\t\t\tlet field = this.c1.find(\"#itemDetailsDiscountInput\")\n\n\t\t\tlet cursor = field[0].selectionStart;\n\n\t\t\tfield.val( (index , currentValue) =>{\n\n\t\t\t\tif( currentValue.length < 0 ){\n\t\t\t\t\tnewValue = 0 ;\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\telse if( currentValue.length == 1){\n\t\t\t\t\tnewValue = 0 ;\n\t\t\t\t\treturn 0 ;\n\t\t\t\t}\n\t\t\t\telse if( cursor == 0 ){\n\t\t\t\t\tnewValue = currentValue;\n\t\t\t\t\treturn currentValue;\n\t\t\t\t}\n\t\t\t\telse if( cursor == currentValue.length){\n\t\t\t\t\tnewValue = currentValue.slice(0 , cursor-1);\n\t\t\t\t\treturn currentValue.slice(0 , cursor-1)\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnewValue = currentValue.slice(0,cursor-1) + currentValue.slice(cursor)\n\t\t\t\t\treturn currentValue.slice(0,cursor-1) + currentValue.slice(cursor)\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t// Use setTimeout to ensure the new value is set before adjusting cursor\n\t\t\tsetTimeout(() => {\n\t\t\t\tfield[0].setSelectionRange(cursor - 1, cursor - 1); // Move cursor back after deletion\n\t\t\t\tfield[0].focus(); // Ensure the input is focused\n\t\t\t}, 0);\n\n\n\t\t}\n\n\t\tconsole.log(\"we reach to here \")\n\t\treturn newValue ;\n\n\t}\n\n\t/**************************  set listener  ****************************/\n\n\tsetDetailsFieldsListeners(){\n\n\t\tthis.quantityInput        = this.c1.find('#itemDetailsQuantityInput')\n\t\tthis.rateInput            = this.c1.find('#itemDetailsRateInput')\n\t\tthis.discountInput        = this.c1.find('#itemDetailsDiscountInput')\n\t\tthis.discountMontantInput = this.c2.find('#itemDetailsDiscountMontantInput')\n\n\t\t//quantity input\n\t\tthis.quantityInput.on('input' , (event)=>{\n\t\t\tconst value = event.target.value;\n\n\t\t\tif(value.length == 0){\n\t\t\t\tevent.target.value = 0\n\t\t\t}\n\t\t\telse if (!value.slice(0,-1).includes(\".\")  && value[value.length-1] == \".\"){\n\t\t\t\tevent.target.value = value\n\t\t\t}\n\t\t\telse if(value[value.length-1] == \".\"){\n\t\t\t\tevent.target.value = value.slice(0,-1);\n\t\t\t}\n\t\t\telse if(value[value.length-1] == \" \"){\n\t\t\t\tevent.target.value = value.slice(0,-1);\n\t\t\t}\n\t\t\telse if(isNaN(value[value.length-1])){\n\t\t\t\tevent.target.value = value.slice(0,-1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tevent.target.value = value\n\t\t\t}\n\n\t\t\t//new quantity\n\t\t\tlet newQuantity = parseFloat(this.quantityInput.val());\n\t\t\tif(isNaN(newQuantity)){\n\t\t\t\tconsole.warn(\"Invaide Quantity value =>\" , this.quantityInput.val())\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse if(newQuantity <= 0){\n\t\t\t\tnewQuantity = 0;\n\t\t\t}\n\n\t\t\tthis.on_input( \"input\" , \"quantity\" , newQuantity)\n\t\t})\n\n\t\tthis.quantityInput.on('focus' , (event)=>{\n\t\t\tthis.on_input( \"focus\" , \"quantity\" , null)\n\t\t})\n\n\t\tthis.quantityInput.on('blur' , (event)=>{\n\t\t\tthis.on_input( \"blur\" , \"quantity\" , null)\n\t\t})\n\n\t\t//rate field listeners\n\t\tthis.rateInput.on('input' , (event)=>{\n\t\t\tconst value = event.target.value ;\n\n\t\t\tif(value.length == 0){\n\t\t\t\tevent.target.value = 0\n\t\t\t}\n\t\t\telse if (!value.slice(0,-1).includes(\".\")  && value[value.length-1] == \".\"){\n\t\t\t\tevent.target.value = value\n\t\t\t}\n\t\t\telse if(value[value.length-1] == \".\"){\n\t\t\t\tevent.target.value = value.slice(0,-1);\n\t\t\t}\n\t\t\telse if(isNaN(value[value.length-1])){\n\t\t\t\tevent.target.value = value.slice(0,-1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tevent.target.value = value;\n\t\t\t}\n\n\t\t\tlet newRate = parseFloat(this.rateInput.val());\n\n\t\t\tconsole.log(\"new rate : \" , newRate)\n\t\t\tif(isNaN(newRate)){\n\t\t\t\tconsole.warn(\"Invalide Rate value\")\n\t\t\t\treturn;\n\t\t\t}\n\n\n\t\t\tthis.on_input( \"input\" , \"rate\" , newRate)\n\t\t})\n\t\tthis.rateInput.on('focus' , (event)=>{\n\t\t\tthis.on_input( \"focus\" , \"rate\" , null)\n\t\t})\n\t\tthis.rateInput.on('blur' , (event)=>{\n\t\t\tthis.on_input( \"blur\" , \"rate\" , null)\n\t\t})\n\n\n\n\n\t\t//discount field listener\n\t\tthis.discountInput.on('input' , (event)=>{\n\t\t\tconst value = event.target.value ;\n\n\t\t\tif(value.length == 0){\n\t\t\t\tevent.target.value = 0;\n\t\t\t}\n\t\t\telse if(!value.slice(0,-1).includes(\".\")  && value[value.length-1] == \".\"){\n\t\t\t\tevent.target.value = value;\n\t\t\t}\n\t\t\telse if(value[value.length-1] == \".\"){\n\t\t\t\tevent.target.value = value.slice(0,-1);\n\t\t\t}\n\t\t\telse if(isNaN(value[value.length-1])){\n\t\t\t\tevent.target.value = value.slice(0,-1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tevent.target.value = value ;\n\t\t\t}\n\n\t\t\tlet newDiscount = this.discountInput.val();\n\n\t\t\tconsole.log(\"the new value \" , newDiscount)\n\n\t\t\tif(isNaN(newDiscount)){\n\t\t\t\tconsole.warn(\"Invalide discount value\")\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t//console.log(\"condition ==> \" , newDiscount<100 )\n\t\t\tif(newDiscount < 100){\n\t\t\t\tthis.on_input( \"input\" , \"discount_percentage\" , newDiscount)\n\t\t\t}\n\t\t\telse{\n\t\t\t\tevent.target.value = 100;\n\t\t\t\tthis.on_input( \"input\" , \"discount_percentage\" , 100)\n\t\t\t}\n\n\t\t})\n\n\t\tthis.discountInput.on('focus' , (event)=>{\n\t\t\tthis.on_input( \"focus\" , \"discount_percentage\" , null)\n\t\t})\n\n\t\tthis.discountInput.on('blur' , (event)=>{\n\t\t\tthis.on_input( \"blur\" , \"discount_percentage\" , null)\n\t\t})\n\n\n\t\t//discount field listener\n\t\tthis.discountMontantInput.on('input' , (event)=>{\n\t\t\tconst value = event.target.value ;\n\n\t\t\tif(value.length == 0){\n\t\t\t\tevent.target.value = 0;\n\t\t\t}\n\t\t\telse if(!value.slice(0,-1).includes(\".\")  && value[value.length-1] == \".\"){\n\t\t\t\tevent.target.value = value;\n\t\t\t}\n\t\t\telse if(value[value.length-1] == \".\"){\n\t\t\t\tevent.target.value = value.slice(0,-1);\n\t\t\t}\n\t\t\telse if(isNaN(value[value.length-1])){\n\t\t\t\tevent.target.value = value.slice(0,-1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tevent.target.value = value ;\n\t\t\t}\n\n\t\t\tlet newDiscount = this.discountMontantInput.val();\n\n\t\t\tif(isNaN(newDiscount)){\n\t\t\t\tconsole.warn(\"Invalide discount value\")\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t//console.log(\"condition ==> \" , newDiscount<100 )\n\t\t\tthis.on_input( \"input\" , \"discount_amount\" , newDiscount)\n\n\t\t})\n\n\t\tthis.discountMontantInput.on('focus' , (event)=>{\n\t\t\tconsole.log(\"we are here\")\n\t\t\tthis.on_input( \"focus\" , \"discount_amount\" , null)\n\t\t})\n\n\t\tthis.discountMontantInput.on('blur' , (event)=>{\n\t\t\tthis.on_input( \"blur\" , \"discount_amount\" , null)\n\t\t})\n\n\t}\n\n\n\t/*************************** funs  ************************************/\n\n\tgetItemPrice(itemId){\n\t\tconst price = this.item_prices.find(itemPrice => itemPrice.item_code == itemId)\n\t\treturn price ? price.price_list_rate  : 0\n\t}\n\n\n\tgetQtyInWarehouse(itemId , warehouseId){\n\t\tconst bin = this.bin_list.find(bin => bin.item_code == itemId && bin.warehouse == warehouseId)\n\t\treturn bin ? bin.actual_qty : 0\n\t}\n\n\n}\n", "\npos_ar.PointOfSale.pos_payment_cart = class{\n\n\tconstructor(\n\t\twrapper,\n\t\tselectedItemMap,\n\t\tselectedTab,\n\t\tappData,\n\t\tpaymentMethods,\n\t\tselectedPaymentMythod,\n\t\tinvoiceData,\n\t\tonClose,\n\t\tonComplete,\n\t\tonInput\n\t){\n\n\n\t\tthis.wrapper                 = wrapper               ;\n\t\tthis.selected_item_map       = selectedItemMap       ;\n\t\tthis.selected_tab            = selectedTab           ;\n\t\tthis.app_data                = appData               ;\n\t\tthis.payment_methods         = paymentMethods        ;\n\t\tthis.selected_payment_method = selectedPaymentMythod ;\n\t\tthis.invoice_data            = invoiceData           ;\n\t\tthis.on_close_cart           = onClose               ;\n\t\tthis.on_complete             = onComplete            ;\n\t\tthis.on_input                = onInput               ;\n\n\t\tthis._payment_method = this.payment_methods[0]\n\n\t\tthis.start_work();\n\t}\n\n\n\t/****************************************  UI ***********************************************/\n\n\tstart_work(){\n\t\tthis.prepare_payment_cart();\n\t\tthis.calculateGrandTotal()\n\t\tthis.setListeners()\n\t}\n\n\tprepare_payment_cart(){\n\t\tthis.wrapper.append('<div id=\"paymentMethodCart\" class=\"columnBox align_center\"></div>')\n\n\t\tthis.cart = this.wrapper.find('#paymentMethodCart')\n\t\tthis.cart.append('<div id=\"paymentMethodCartHeader\" class=\"rowBox header align_center row_sbtw\"></div>')\n\t\tthis.cart.append('<div id=\"paymentMethodContent\" class=\"columnBox align_center\"></div>')\n\t\tthis.cart.append('<div id=\"paymentMethodCartFooter\" class=\"columnBox align_center\"></div>')\n\n\t\tthis.cart_header  = this.cart.find('#paymentMethodCartHeader')\n\t\tthis.cart_content = this.cart.find('#paymentMethodContent')\n\t\tthis.cart_footer  = this.cart.find('#paymentMethodCartFooter')\n\n\t\tthis.cart_header.append('<h4 class=\"CartTitle\">Item Details</h4>')\n\t\tthis.cart_header.append('<img src=\"/assets/pos_ar/images/cancel.png\" alt=\"Cancel Button\" id=\"paymentMethodCartXBtn\" class=\"xBtn\">')\n\n\t\tthis.cart_header.find('#paymentMethodCartXBtn').on('click' , (event)=>{\n\t\t\tthis.on_close_cart();\n\t\t})\n\n\t\tthis.cart_content.append('<div id=\"paymentContentTopSection\" class=\"rowBox\"></div>')\n\t\tthis.cart_content.append('<div id=\"paymentContentBottomSection\" class=\"columnBox\"></div>')\n\n\t\tthis.cart_content_top_section    = this.cart_content.find('#paymentContentTopSection')\n\t\tthis.cart_content_bottom_section = this.cart_content.find('#paymentContentBottomSection')\n\n\n\t\tthis.payment_methods.forEach(method =>{\n\t\t\tconst selected    = this._payment_method.name == method.name ? \"selected\" : \"\" ;\n\t\t\tconst amountField = this.getModeOfPaymentById(method.mode_of_payment).type == 'Phone' ? \"display:none;\" : \"\"\n\t\t\tthis.cart_content_top_section.append(`<div id=\"${method.name}\" class=\"paymentMethodBox ${selected}\"><div id=\"BoxTitle\" class=\"title ${selected}\">${method.mode_of_payment}</div><input type=\"number\" id=\"cachInput\" class=\"paymentInput\" value=\"0\" style=\"${amountField}\"  ></div>`)\n\t\t})\n\n\n\t\tthis.cart_content_bottom_section.append('<h4>Additional Information</h4>')\n\n\t\tthis.cart_footer.append('<div id=\"paymentDetailsContainer\" class=\"rowBox align_center\"></div>');\n\t\tthis.cart_footer.append('<button class=\"posBtn1\" type=\"button\" id=\"completeOrderBtn\">Complete Order</button>');\n\n\t\tthis.payment_details = this.cart_footer.find('#paymentDetailsContainer')\n\t\tthis.payment_details.append('<div class=\"columnBox\"><div id=\"paymentGrandTotalTitle\" class=\"rowBox centerItem\">Grand Total</div><div id=\"paymentGrandTotalValue\" class=\"rowBox centerItem\"></div></div>')\n\t\tthis.payment_details.append('<hr>')\n\t\tthis.payment_details.append(`<div id=\"paymentPaidAmount\" class=\"columnBox\"><div id=\"paymentPaidAmountTitle\" class=\"rowBox centerItem\">Paid Amount</div><div id=\"paimentPaidAmountValue\"  class=\"rowBox centerItem\"> 0 DA </div></div>`)\n\t\tthis.payment_details.append('<hr>')\n\t\tthis.payment_details.append(`<div id=\"paymentToChange\" class=\"columnBox\"><div id=\"paimentToChangeTitle\" class=\"rowBox centerItem\">To Change</div><div id=\"paimentToChangeValue\"  class=\"rowBox centerItem\"> ${this.calculateToChange()} DA </div></div>`)\n\n\t}\n\n\n\n\tpreparDefault(){\n\t\tthis.calculateGrandTotal();\n\t\t// Get the selected payment method's box\n\t\tconst selectedBox = $(`#${this._payment_method.name}`);\n\t\tif (selectedBox.length) {\n\t\t\t// Set the input field value to grandTotal\n\t\t\tselectedBox.find('.paymentInput').val(this.invoice_data.grandTotal);\n\n\t\t\t// Update the payment method amount in the map\n\t\t\tthis.selected_item_map.get(this.selected_tab.tabName).payments.forEach(mode => {\n\t\t\t\tif (mode.mode_of_payment == this._payment_method.mode_of_payment) {\n\t\t\t\t\tmode.amount = this.invoice_data.grandTotal;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Update paid amount and change display\n\t\t\tthis.updatePaidAmount();\n\t\t\tthis.updateToChange();\n\t\t}\n\t}\n\n\n\tshowCart(){\n\t\tthis.cart.css('display' , 'flex');\n\t\tthis.preparDefault();\n\t\t//this.clearData();\n\t}\n\n\thideCart(){\n\t\tthis.cart.css('display' , 'none');\n\t}\n\n\n\t/*clearData(){\n\n\t\tthis.invoice_data.paidAmount = 0 ;\n\t\tthis.invoice_data.toChange = 0 ;\n\n\t\t//this.cashBox.find('#cachInput').val(0)\n\n\t\tthis.calculateGrandTotal();\n\t\tthis.updateToChange();\n\t\tthis.refreshPaidAmount();\n\n\t}*\n\n\n\trefreshData(){\n\t\tconsole.log(\"refreshing data\")\n\n\t\t//this.cashBox.find('#cachInput').val(this.invoice_data.paidAmount)\n\n\t\tthis.calculateGrandTotal();\n\t\tthis.calculateToChange();\n\t\tthis.refreshPaidAmount();\n\n\t}\n\n\t/****************************************  listeners  ***********************************************/\n\n\tsetListeners(){\n\n\t\tconst me = this\n\t\t// Use event delegation to handle clicks\n\t\tthis.cart_content_top_section.on('click', '.paymentMethodBox', function () {\n\t\t\t// Remove 'selected' class from all .paymentMethodBox elements\n\t\t\t$('.paymentMethodBox').removeClass('selected');\n\t\t\t$('.paymentMethodBox div.title').removeClass('selected');\n\t\t\t//add to clicked ones\n\t\t\t$(this).addClass('selected')\n\t\t\t$(this).find('.title').addClass('selected')\n\t\t\tconst clickedId = $(this).attr('id')\n\t\t\tme.payment_methods.forEach(method=>{\n\t\t\t\tif(method.name == clickedId){\n\t\t\t\t\tme._payment_method = method\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t// Reset input fields in all other boxes\n\t\t\t$('.paymentMethodBox').not(this).find('.paymentInput').val(0);\n \t\t\t// Set the selected box input field to grandTotal\n\t\t\t$(this).find('.paymentInput').val(me.invoice_data.grandTotal);\n\n\t\t\tme.selected_item_map.get(me.selected_tab.tabName).payments.forEach(mode =>{\n\t\t\t\tif(mode.mode_of_payment != me._payment_method.mode_of_payment){\n\t\t\t\t\tmode.amount = 0\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\t//check if not pay\n\t\t\t\t\tif(me.getModeOfPaymentById(mode.mode_of_payment).type == \"Phone\" ){\n\t\t\t\t\t\tmode.amount = 0\n\t\t\t\t\t}else{\n\t\t\t\t\t\tmode.amount = me.invoice_data.grandTotal\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\tme.updatePaidAmount()\n\t\t\tme.updateToChange()\n\t\t});\n\n\n\n\t\t// Add a listener for all inputs within .paymentMethodBox\n\t\tthis.cart_content_top_section.on('input', '.paymentInput', function () {\n\n\t\t\tconst inputValue = parseFloat($(this).val()) || 0; // Get the input value\n\t\t\tconst boxId = $(this).closest('.paymentMethodBox').attr('id'); // Get the box ID\n\n\t\t\tme.selected_item_map.get(me.selected_tab.tabName).payments.forEach(mode =>{\n\t\t\t\tif(mode.mode_of_payment == me._payment_method.mode_of_payment){\n\t\t\t\t\tmode.amount = parseFloat(inputValue)\n\t\t\t\t}\n\t\t\t})\n\t\t\tme.updatePaidAmount()\n\t\t\tme.updateToChange()\n\t\t});\n\n\n\t\t/*\n\t\tthis.cashBox.find('#cachInput').on('focus' , (event)=>{\n\t\t\tthis.on_input('focus' , 'cash' , null)\n\t\t})\n\t\t*/\n\n\n\t\tthis.cart_footer.find(\"#completeOrderBtn\").on('click' , (event)=>{\n\n\t\t\tfrappe.confirm('Submit the invoice ?',\n\t\t\t()=>{/*yes*/\n\t\t\t\tthis.on_complete()\n\t\t\t},()=>{\n\n\t\t\t})\n\t\t})\n\n\n\t}\n\n\n\t/************************************ tools  ***************************************/\n\n\n\thandleInput(key){\n\n\t\t/*\n\t\tlet previousValue = this.cashBox.find('#cachInput').val() ;\n\t\t// Check if the previous value contains a period (.)\n\t\tif( previousValue.includes('.') && key == \".\"){\n\t\t\treturn ;\n\t\t}\n\t\t// Append the key to the paidAmount if there is no period\n\t\tthis.invoice_data.paidAmount += key;\n\t\t// Refresh the payment cart\n\t\tthis.refreshData();*/\n\t}\n\n\tdeleteKeyPress(){\n\n\t\tlet cashField = this.cashBox.find('#cachInput');\n\t\tlet newValue = 0 ;\n\t\tlet cursor = cashField[0].selectionStart;\n\n\t\tcashField.val( (index , currentValue) =>{\n\t\t\tif( currentValue.length < 0 ){\n\t\t\t\tconsole.log(\"cnd 1\")\n\t\t\t\tnewValue = 0 ;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\telse if( currentValue.length == 1){\n\t\t\t\tconsole.log(\"cnd 2\")\n\t\t\t\tnewValue = 0 ;\n\t\t\t\treturn 0 ;\n\t\t\t}\n\t\t\telse if( cursor == 0 ){\n\t\t\t\tconsole.log(\"cnd 3\")\n\t\t\t\tnewValue = currentValue;\n\t\t\t\treturn currentValue;\n\t\t\t}\n\t\t\telse if( cursor == currentValue.length){\n\t\t\t\tconsole.log(\"cnd 4\")\n\t\t\t\tnewValue = currentValue.slice(0 , cursor-1)\n\t\t\t\treturn currentValue.slice(0 , cursor-1)\n\t\t\t}\n\t\t\telse{\n\t\t\t\tconsole.log(\"cursor : \" , cursor ,\" current val ==> \" , currentValue , \" cnd 5 newValue ==> \" , currentValue.slice(0,cursor-1) + currentValue.slice(cursor))\n\t\t\t\tnewValue = currentValue.slice(0,cursor-1) + currentValue.slice(cursor)\n\t\t\t\treturn currentValue.slice(0,cursor-1) + currentValue.slice(cursor)\n\t\t\t}\n\t\t})\n\n\t\tconsole.log(\"we are in newValue ==> \" , newValue);\n\n\t\tthis.invoice_data.paidAmount = newValue;\n\n\t\t// Use setTimeout to ensure the new value is set before adjusting cursor\n\t\tsetTimeout(() => {\n\t\t\tcashField[0].setSelectionRange(cursor - 1, cursor - 1); // Move cursor back after deletion\n\t\t\tcashField[0].focus(); // Ensure the input is focused\n\t\t}, 0);\n\n\t\tthis.refreshData();\n\t}\n\n\n\tcalculatePaidAmount(){\n\t\tlet paidAmountDA = 0;\n\t\tthis.selected_item_map.get(this.selected_tab.tabName).payments.forEach(mode =>{\n\t\t\tpaidAmountDA += mode.amount\n\t\t})\n\t\treturn paidAmountDA\n\t}\n\n\tupdatePaidAmount(){\n\t\tthis.payment_details.find('#paimentPaidAmountValue').text(`${this.calculatePaidAmount()} DA`)\n\t}\n\n\n\tcalculateToChange(){\n\t\tconsole.log(\"see why the error \" , \" calculatePaidAmount \" ,  this.calculatePaidAmount() , \" grandTotal \" , this.invoice_data.grandTotal)\n\t\treturn this.calculatePaidAmount() - this.invoice_data.grandTotal\n\t}\n\n\n\tupdateToChange(){\n\t\tthis.payment_details.find('#paimentToChangeValue').text(`${this.calculateToChange().toFixed(2)} DA`)\n\t}\n\n\n\tcalculateGrandTotal(){\n\t\tthis.payment_details.find('#paymentGrandTotalValue').text(`${this.invoice_data.grandTotal.toFixed(2)} DA`)\n\t\treturn parseFloat(this.invoice_data.grandTotal.toFixed(2))\n\t}\n\n\n\n\n\tgetModeOfPaymentById(id){\n\t\tlet r = null\n\t\tthis.app_data.posProfileModeOfPayments.forEach(mode=>{\n\t\t\tif(mode.name == id){\n\t\t\t\tr = mode\n\t\t\t}\n\t\t})\n\t\treturn r\n\t}\n\n}\n", "pos_ar.PointOfSale.pos_history = class {\n\n\tconstructor(\n\t\twrapper,\n\t\tdb,\n\t\tselectedPosProfile,\n\t\tcompany,\n\t\tsalesTaxes,\n\t\tonClick\n\t){\n\t\tthis.wrapper               = wrapper;\n\t\tthis.db                    = db;\n\t\tthis.selected_pos_profile  = selectedPosProfile;\n\t\tthis.company               = company\n\t\tthis.sales_taxes           = salesTaxes;\n\t\tthis.on_click              = onClick;\n\n\t\t//local data\n\t\tthis.localPosInvoice   = { lastTime : null , pos_invoices : [] }\n\t\tthis.filter            = \"\" ;\n\t\tthis.filtered_pos_list = [] ;\n\t\tthis.selected_pos      = null ;\n\n\t\tthis.start_work();\n\t}\n\n\tasync start_work(){\n\t\tthis.prepare_history_cart();\n\t\tconst result = await this.db.getAllPosInvoice()\n\n\t\tconsole.log(\"the db data \" , result)\n\t\tthis.localPosInvoice.pos_invoices = result ;\n\n\t\tthis.filtered_pos_list = this.localPosInvoice.pos_invoices.filter( pos => {\n\t\t\tif(pos.status == 'Draft' ){\n\t\t\t\treturn true ;\n\t\t\t}else{\n\t\t\t\treturn false ;\n\t\t\t}\n\t\t})\n\t\tconsole.log(\"log init data : \" , this.filtered_pos_list)\n\t\tif(this.filtered_pos_list.length == 0){\n\t\t\tthis.selected_pos = null\n\t\t\tconsole.log(\"first condition\")\n\t\t}else{\n\t\t\tthis.selected_pos = structuredClone(this.filtered_pos_list[0])\n\t\t\tconsole.log(\"second condition\")\n\t\t}\n\t\tthis.refreshData()\n\t\tthis.setListener();\n\t}\n\n\n\t/*************************************    UI    *******************************************************/\n\n\tprepare_history_cart(){\n\t\tthis.wrapper.find('#LeftSection').append('<div id=\"historyLeftContainer\" class=\"columnBox\"></div>')\n\t\tthis.wrapper.find('#RightSection').append('<div id=\"historyRightContainer\" class=\"columnBox\"></div>')\n\n\t\tthis.left_container  = this.wrapper.find('#historyLeftContainer')\n\t\tthis.right_container = this.wrapper.find('#historyRightContainer')\n\n\n\t\t//pos details  the container of the pos details\n\t\tthis.left_container.append('<div id=\"PosContentHeader\" class=\"rowBox\" ><div class=\"c1 columnBox\"><div id=\"posCustomer\">Customer</div><div id=\"posSoldBy\"></div></div><div class=\"c2 columnBox\"><div id=\"posCost\">0,0000 DA</div><div id=\"posId\">ACC-PSINV-2024-ID</div><div id=\"posStatus\">POS Status</div></div></div>')\n\n\t\t//first this.selected_pos.taxes_and_charges = \"\"section is the header information\n\t\tthis.pos_header = this.left_container.find('#PosContentHeader');\n\n\t\tthis.left_container.append('<div id=\"posContent\" class=\"columnBox\"></div>')\n\n\t\t//second section is the data like items , cost and payments methods.\n\t\tthis.pos_content = this.left_container.find('#posContent')\n\t\tthis.pos_content.append('<div id=\"posItemContainer\"><div class=\"posSectionTitle\">Items</div><div id=\"posItemList\"></div></div>')\n\n\t\tthis.itemContainer = this.pos_content.find('#posItemContainer')\n\t\tthis.itemList      = this.itemContainer.find('#posItemList')\n\n\t\tthis.pos_content.append('<div id=\"posTotalsContainer\"><div class=\"posSectionTitle\">Totals</div><div id=\"posTotalList\"></div></div>')\n\n\t\tthis.totalsContainer = this.pos_content.find('#posTotalsContainer')\n\t\tthis.totalList       = this.pos_content.find('#posTotalList')\n\n\t\tthis.pos_content.append('<div id=\"posPaymentsContainer\"><div class=\"posSectionTitle\">Payments</div><div id=\"posMethodList\"></div></div>')\n\n\t\tthis.paymentsContainer = this.pos_content.find('#posPaymentsContainer')\n\t\tthis.methodList        = this.pos_content.find('#posMethodList')\n\n\t\tthis.left_container.append('<div id=\"posActionsContainer\" class=\"rowBox align_content\"  style=\"display = none ;\" > <div id=\"posPrintBtn\" class=\"actionBtn rowBox centerItem\"> Print Receipt </div>  <div id=\"posEmailBtn\" class=\"actionBtn rowBox centerItem\"> Email Receipt </div>   <div id=\"posReturnBtn\" class=\"actionBtn rowBox centerItem\"> Return </div>  </div>')\n\t\tthis.left_container.append('<div id=\"posDraftActionsContainer\" class=\"rowBox align_content\" style=\"display = none ;\"> <div id=\"posEditBtn\" class=\"actionBtn rowBox centerItem\"> Edit Invoice </div>  <div id=\"posDeleteBtn\" class=\"actionBtn rowBox centerItem\"> Delete Invoice </div>  </div>')\n\n\t\t//third and last section is the action buttons\n\t\tthis.actionButtonsContainer = this.left_container.find('#posActionsContainer')\n\t\tthis.printBtn  = this.actionButtonsContainer.find('#posPrintBtn')\n\t\tthis.emailBtn  = this.actionButtonsContainer.find('#posEmailBtn')\n\t\tthis.returnBtn = this.actionButtonsContainer.find('#posReturnBtn')\n\n\t\tthis.draftActionButtonsContainer = this.left_container.find('#posDraftActionsContainer')\n\t\tthis.deleteBtn  = this.draftActionButtonsContainer.find('#posDeleteBtn')\n\t\tthis.editBtn    = this.draftActionButtonsContainer.find('#posEditBtn')\n\n\n\t\tthis.right_container.append(`<div id=\"historyRightContainerHeader\" class=\"rowBox align_center\" ><h4 class=\"CartTitle\">Recent Orders</h4></div>`)\n\t\tthis.right_container.append('<div id=\"historyRightSearchContainer\" class=\"rowBox align_center\" ></div>');\n\n\t\tthis.search_container = this.right_container.find('#historyRightSearchContainer');\n\t\tthis.search_container.append('<select  id=\"PosInvoiceTypeInput\" placeholder=\"POS Invoice Type\">');\n\n\t\tthis.filter_input = this.search_container.find(\"#PosInvoiceTypeInput\")\n\t\tthis.filter_input.append('<option value=\"Draft\">Draft</option><option value=\"Paid\">Paid</option> <option value=\"Unpaid\">Unpaid</option>')\n\n\t\tthis.search_container.append('<input type=\"text\" id=\"historyInput\" placeholder=\"Search by invoice id or custumer name\">');\n\n\t\tthis.right_container.append('<div id=\"historyRecentInvoicesContainer\" ></div>');\n\n\t\tthis.right_data_container = this.right_container.find('#historyRecentInvoicesContainer')\n\t}\n\n\n\trefreshData(){\n\t\tthis.right_data_container.html('');\n\n\t\tthis.filtered_pos_list.forEach( record => {\n\n\t\t\tconst posContainer = document.createElement('div');\n\t\t\tposContainer.classList.add('posInvoiceContainer')\n\t\t\tposContainer.classList.add('columnBox')\n\t\t\tposContainer.classList.add('align_content')\n\n\t\t\t//line 1\n\t\t\tconst l1           = document.createElement('div')\n\t\t\tl1.classList.add('l1')\n\t\t\tl1.classList.add('rowBox')\n\t\t\tl1.classList.add('align_content')\n\n\t\t\tconst posName      = document.createElement('div')\n\t\t\tposName.classList.add('posName')\n\t\t\tposName.textContent = record.name\n\t\t\tconst posCost      = document.createElement('div')\n\t\t\tposCost.classList.add('posCost')\n\t\t\tposCost.textContent = record.paid_amount ?? 0 + \" DA\"\n\n\t\t\tl1.appendChild(posName)\n\t\t\tl1.appendChild(posCost)\n\n\t\t\t///////////// line 2\n\t\t\tconst l2           = document.createElement('div')\n\t\t\tl2.classList.add('l2')\n\t\t\tl2.classList.add('rowBox')\n\t\t\tl2.classList.add('align_content')\n\n\t\t\t//l2 customer\n\t\t\tconst customer = document.createElement('div')\n\t\t\tcustomer.classList.add('customer')\n\t\t\tcustomer.classList.add('rowBox')\n\t\t\tcustomer.classList.add('align_content')\n\n\t\t\tconst customerLogo  = document.createElement('img')\n\t\t\tcustomerLogo.src    = '/assets/pos_ar/images/customer.png' ;\n\t\t\tcustomerLogo.width  = 16 ;\n\t\t\tcustomerLogo.height = 16 ;\n\t\t\tcustomerLogo.classList.add('customerLogo');\n\n\t\t\tconst customerName       = document.createElement('div')\n\t\t\tcustomerName.textContent = record.customer\n\t\t\tcustomerName.classList.add('customerName');\n\n\t\t\tcustomer.appendChild(customerLogo);\n\t\t\tcustomer.appendChild(customerName);\n\n\t\t\tl2.appendChild(customer);\n\n\t\t\t//l2 creation time\n\t\t\tconst creationTime  = document.createElement('div')\n\t\t\tcreationTime.textContent = record.creation_time\n\t\t\tl2.appendChild(creationTime);\n\n\t\t\t//add all to container\n\t\t\tposContainer.appendChild(l1)\n\t\t\tposContainer.appendChild(l2)\n\n\t\t\tposContainer.addEventListener('click' , () => {\n\t\t\t\tthis.selected_pos = record\n\t\t\t\tthis.refreshPosDetailsData();\n\t\t\t})\n\n\t\t\tthis.right_data_container.append(posContainer);\n\t\t})\n\n\n\t\t//dont forget to refresh the details cart view because the selected pos may change\n\t\tthis.refreshPosDetailsData();\n\n\t}\n\n\n\n\trefreshPosDetailsData(){\n\n\t\t/******************  check if there is a selected one *********************/\n\t\t// render the empty page or the selected pos details.\n\t\tif(this.selected_pos == null ){\n\t\t\tthis.setEmpty();\n\t\t\treturn;\n\t\t}else{\n\t\t\tthis.setData();\n\t\t}\n\n\n\t\tthis.pos_header.find('#posCustomer').text(this.selected_pos.customer?? \"CustomerName\")\n\t\t//this.pos_header.find('#posSoldBy').text('Sold By : ' + this.selected_pos.owner?? \"saler\")\n\t\t//it is not the paid amount it should be the total invoice amount\n\t\tthis.pos_header.find('#posCost').text(this.selected_pos.paid_amount??0 + \"DA\")\n\t\tthis.pos_header.find('#posId').text(this.selected_pos.name?? \"POS Invoice Name\")\n\t\tthis.pos_header.find('#posStatus').text(this.selected_pos.status)\n\t\tthis.pos_header.find('#posStatus').removeClass().addClass(`${this.selected_pos.status}`)\n\n\t\tif(this.selected_pos.status == \"Draft\"){\n\t\t\tthis.draftActionButtonsContainer.css('display' , 'flex')\n\t\t\tthis.actionButtonsContainer.css('display' , 'none')\n\t\t}else{\n\t\t\tthis.draftActionButtonsContainer.css('display' , 'none')\n\t\t\tthis.actionButtonsContainer.css('display' , 'flex')\n\t\t}\n\n\n\t\t/**********************  items list ***************************/\n\t\tthis.itemList.html('');\n\t\tthis.selected_pos.items.forEach(item => {\n\t\t\tthis.itemList.append(`<div class=\"rowBox align_item\">    <div class=\"itemName rowBox align_center\">${item.item_name}</div>   <div class=\"itemQuantity rowBox align_center\">${item.qty}</div>   <div class=\"itemCost rowBox align_center\">${item.qty * item.rate} DA</div>  </div>`)\n\t\t})\n\n\n\t\t/*********************  net ,  VAT  , Discount , Grand Total *******************/\n\n\t\tthis.totalList.html('');\n\n\t\t/////net total\n\t\tlet netTotal = 0 ;\n\t\tthis.selected_pos.items.forEach(item => {\n\t\t\tnetTotal += item.rate * item.qty\n\t\t})\n\t\tthis.totalList.append(`<div class=\"rowBox align_item\"> <div class=\"name rowBox align_center\">Net Total</div> <div class=\"price rowBox align_center\">${netTotal} DA</div> </div>`)\n\n\n\t\tlet allTax = 0\n\t\tif(this.selected_pos.taxes_and_charges != \"\" && this.selected_pos.taxes_and_charges != null){\n\t\t\tthis.sales_taxes.forEach( tax =>{\n\t\t\t\tallTax += (tax.rate/100) * netTotal\n\t\t\t\tthis.totalList.append(`<div class=\"rowBox align_item\"> <div class=\"name rowBox align_center\">${tax.description}</div> <div class=\"price rowBox align_center\">${(tax.rate/100) * netTotal} DA</div> </div>`)\n\t\t\t})\n\t\t}\n\n\t\t// grand otal\n\t\tthis.totalList.append(`<div class=\"rowBox align_item\"> <div class=\"grandTotalName rowBox align_center\">Grand Total</div> <div class=\"grandTotalPrice rowBox align_center\">${netTotal + allTax} DA</div> </div>`)\n\n\n\n\t\t/***************************** payment methode list *********************************/\n\t\tthis.methodList.html('')\n\t\tconst payments = this.selected_pos.payments ;\n\n\t\tif(payments != null && payments != \"\"){\n\t\t\tpayments.forEach( method => {\n\t\t\t\tthis.methodList.append(`<div class=\"rowBox align_item\"> <div class=\"name rowBox align_center\">${method.mode_of_payment}</div> <div class=\"price rowBox align_center\">${method.amount} DA</div> </div>`)\n\t\t\t})\n\t\t}\n\n\t}\n\n\n\n\t//show and hide\n\tshow_cart(){\n\t\tthis.left_container.css('display' , 'flex');\n\t\tthis.right_container.css('display' , 'flex');\n\n\t\tconst filter = this.filter_input.val();\n\t\tconsole.log(\"filter : \" , filter);\n\n\t\t//refrenshing data\n\t\tthis.db.getAllPosInvoice_callback(\n\t\t\t\t\t\t(result)=>{\n\t\t\t\t\t\t\tconsole.log(\"look at the result : \" , result)\n\t\t\t\t\t\t\tthis.localPosInvoice.pos_invoices = result ;\n\t\t\t\t\t\t\tthis.filtered_pos_list = this.localPosInvoice.pos_invoices.filter( pos => {\n\n\t\t\t\t\t\t\t\tif(pos.status == filter ){\n\t\t\t\t\t\t\t\t\treturn true ;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\treturn false ;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\tif(this.filtered_pos_list.length == 0){\n\t\t\t\t\t\t\t\tthis.selected_pos = null\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tthis.selected_pos = structuredClone(this.filtered_pos_list[0])\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.refreshData()\n\t\t\t\t\t\t},(error) => {\n\t\t\t\t\t\t\tconsole.log(error)\n\t\t\t\t\t\t}\n\t\t)\n\n\t}\n\n\t//hide and hide\n\thide_cart(){\n\t\tthis.left_container.css('display' , 'none');\n\t\tthis.right_container.css('display' , 'none');\n\t}\n\n\n\t//set empty\n\tsetEmpty(){\n\t\tthis.pos_header.css('display' , 'none')\n\t\tthis.pos_content.css('display' , 'none')\n\t\tthis.actionButtonsContainer.css('display' , 'none')\n\t\tthis.draftActionButtonsContainer.css('display' , 'none')\n\t}\n\n\t//set data\n\tsetData(){\n\t\tthis.pos_header.css('display' , 'flex')\n\t\tthis.pos_content.css('display' , 'flex')\n\t}\n\n\n\n\t/************************************* set listeners  ***********************************************/\n\t//set listeners\n\tsetListener(){\n\n\t\tthis.filter_input.on('input' , (event) => {\n\t\t\tconst filter = event.target.value;\n\n\t\t\tconsole.log(\"filter : \" , filter)\n\n\n\t\t\tthis.filtered_pos_list = this.localPosInvoice.pos_invoices.filter( pos => {\n\t\t\t\tif(filter == \"\"){\n\t\t\t\t\treturn true ;\n\t\t\t\t}\n\t\t\t\telse if(filter == pos.status ){\n\t\t\t\t\treturn true ;\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\treturn false ;\n\t\t\t\t}\n\t\t\t})\n\n\t\t\tif(this.filtered_pos_list.length == 0){\n\t\t\t\tthis.selected_pos = null;\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.selected_pos = this.filtered_pos_list[0]\n\t\t\t}\n\t\t\tthis.refreshData();\n\t\t});\n\n\n\t\tthis.deleteBtn.on('click' , (event)=>{\n\t\t\tthis.db.deletePosInvoice_callback(\n\t\t\t\tthis.selected_pos.name,\n\t\t\t\t(event)=>{\n\t\t\t\t\t//remove the deleted one from the filtred list\n\t\t\t\t\tthis.filtered_pos_list = this.filtered_pos_list.filter(pos => pos.name != this.selected_pos.name)\n\t\t\t\t\t//selected new pos\n\t\t\t\t\tif(this.filtered_pos_list.length > 0){\n\t\t\t\t\t\tthis.selected_pos = this.filtered_pos_list[0]\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tthis.selected_pos = null ;\n\t\t\t\t\t}\n\t\t\t\t\tthis.refreshData()\n\t\t\t\t},\n\t\t\t\t(error)=>{\n\t\t\t\t\t//error callback\n\t\t\t\t\tconsole.log(\"error on deleting the pos : \" , error);\n\t\t\t\t}\n\t\t\t)\n\t\t})\n\n\t\tthis.editBtn.on('click' , (event)=>{\n\t\t\tthis.on_click('edit' , this.selected_pos );\n\t\t})\n\n\t\tthis.returnBtn.on('click' , (event)=>{\n\t\t\tthis.on_click('return' , null );\n\t\t})\n\n\t\tthis.printBtn.on('click' , (event)=>{\n\t\t\tthis.print_receipt(this.selected_pos)\n\t\t})\n\n\t}\n\n\t/******************************************** functions  ********************************************************/\n\tprint_receipt(pos) {\n\n\t\tlet netTotal   = 0\n\t\tlet taxes      = 0\n\t\tlet grandTotal = 0\n\n\t\tconst creation_time = pos.creation_time\n\t\tconst [date, time]  = creation_time.split(' ')\n\n\n\t\tlet invoiceHTML =\n\t\t\t'<style>'+\n\t\t\t\t'#company_container {'+\n\t\t\t\t\t'width: 100% ; height: 40px ; '+\n\t\t\t\t\t'display:flex; align-items:center; '+\n\t\t\t\t\t'font-size : 12px;'+\n\t\t\t\t'}'+\n\t\t\t\t'table{'+\n\t\t\t\t\t//'border: 1px solid #505050; border-spacing:0px;'+\n\t\t\t\t\t'width: 100%; margin-top:16px;'+\n\t\t\t\t'}'+\n\t\t\t\t'tr{'+\n\t\t\t\t\t'width:100%; height:16px;'+\n\t\t\t\t'}'+\n\t\t\t\t'tr:nth-child(1){'+\n\t\t\t\t\t''+\n\t\t\t\t'}'+\n\t\t\t\t'#first_row{'+\n\t\t\t\t\t'border: 5px solid black;'+\n\t\t\t\t'}'+\n\t\t\t\t'#logContainer{'+\n\t\t\t\t\t'width: 100%;height:80px;'+\n\t\t\t\t\t'display : flex;'+\n\t\t\t\t\t'justify-content:center;'+\n\t\t\t\t'}'+\n\t\t\t\t'#logContainer img{'+\n\t\t\t\t\t'width:50%; height:100%;'+\n\t\t\t\t'}'+\n\t\t\t\t'#top_data_container{'+\n\t\t\t\t\t'width:100%;display:flex;'+\n\t\t\t\t'}'+\n\t\t\t\t'#top_data_container>div.c1{'+\n\t\t\t\t\t'font-size:12px;flex-grow:1;'+\n\t\t\t\t'}'+\n\t\t\t\t'#top_data_container>div.c2{'+\n\t\t\t\t\t'font-size:12px;flex-grow:1;'+\n\t\t\t\t\t'display:flex;flex-direction:column;align-items:end;'+\n\t\t\t\t'}'+\n\t\t\t\t'td>div{'+\n\t\t\t\t\t'height:18px; width:100%;'+\n\t\t\t\t\t'font-size:12px;'+\n\t\t\t\t\t'display:flex; justify-content:center; align-items:center;'+\n\t\t\t\t'}'+\n\t\t\t\t'#footer_message{'+\n\t\t\t\t\t'height:20px;'+\n\t\t\t\t'}'+\n\t\t\t\t'</style>'+\n\t\t\t\t'<div style=\"display:flex; flex-direction:column;\">'+\n\t\t\t\t\t'<div id=\"logContainer\"  >'+\n\t\t\t\t\t\t'<div style=\"width:20%;\"></div>'+\n\t\t\t\t\t\t`<img src=\"${this.company.company_logo}\">`+\n\t\t\t\t\t\t'<div style=\"width:20%;\"></div>'+\n\t\t\t\t\t'</div>'+\n\t\t\t\t\t'<div id=\"company_container\">' +\n\t\t\t\t\t\t'<div style=\"flex-grow:1;\"></div>'+\n\t\t\t\t\t\t`<p style=\"margin:0px 25px;\">${this.company.company_name}</p>`+\n\t\t\t\t\t\t'<div style=\"flex-grow:1;\"></div>'+\n\t\t\t\t\t'</div>'+\n\t\t\t\t\t'<div id=\"top_data_container\">'+\n\t\t\t\t\t\t'<div class=\"c1\">'+\n\t\t\t\t\t\t\t`<div class=\"customer\"> Customer : ${pos.customer} </div>`+\n\t\t\t\t\t\t\t`<div class=\"refrence\"> Commande : ${pos.refNum} </div>`+\n\t\t\t\t\t\t'</div>'+\n\t\t\t\t\t\t'<div class=\"c2\">'+\n\t\t\t\t\t\t\t`<div class=\"date\"> ${date}/${time} </div>`+\n\t\t\t\t\t\t'</div>'+\n\t\t\t\t\t'</div>'+\n\t\t\t\t\t'<table>'+\n\t\t\t\t\t\t'<tr id=\"first_row\" ><th style=\"boder:1px solid black;\">Nom</th><th>Qt\u00E9</th><th>Prix</th><th>Value</th>'\n\n\t\tpos.items.forEach(item => {\n\t\t\tnetTotal    += item.rate * item.qty\n\t\t\tinvoiceHTML += `<tr > <td ><div >${item.item_name}</div></td>  <td><div>${item.qty}</div></td>  <td><div>${item.rate}</div></td>  <td><div>${item.rate * item.qty}</div></td></tr>`\n\t\t})\n\n\t\tinvoiceHTML += '</table>'\n\n\n\n\t\tinvoiceHTML += `<div style=\"height:23px;\"> <p style=\"font-size:12px;font-weight:500;\" ><span style=\"font-size:12px;font-weight:600;\">Sous-total : </span> ${netTotal} DA </p> </div>`\n\t\tinvoiceHTML += `<div style=\"height:23px;\"> <p style=\"font-size:12px;font-weight:500;\" ><span style=\"font-size:12px;font-weight:600;\">Reduction : </span> ${pos.additional_discount_percentage * netTotal} DA </p> </div>`\n\n\t\tthis.sales_taxes.forEach(tax => {\n\t\t\ttaxes += tax.rate\n\t\t\tinvoiceHTML += `<div style=\"height:23px;\"> <p style=\"font-size:12px;font-weight:500;\" ><span style=\"font-size:12px;font-weight:600;\">${tax.description} : </span> ${tax.rate} % </p> </div>`\n\t\t})\n\n\t\tinvoiceHTML += `<div style=\"height:23px;\"> <p style=\"font-size:12px;font-weight:500;\" ><span style=\"font-size:12px;font-weight:600;\">Total : </span> ${netTotal+(netTotal*(taxes/100)) - pos.additional_discount_percentage * netTotal} DA </p> </div>`\n\n\n\t\tinvoiceHTML +=\n\t\t'<div id=\"footer_message\" style=\"width:100%; display:flex; align-items:center; margin-top:30px;\">'+\n\t\t\t'<div style=\"flex-grow:1;\"></div>'+\n\t\t\t'<div style=\"margin:30px 25px;\"> Thank You, Come Again</div>'+\n\t\t\t'<div style=\"flex-grow:1;\"></div>'+\n\t\t'</div>'\n\n\t\tinvoiceHTML += '</div>'\n\n\n\n\n\t\t// Open a new window and print the HTML content\n\t\tconst printWindow = window.open('', '_blank');\n\t\tprintWindow.document.write(invoiceHTML);\n\t\tprintWindow.document.close();\n\t\tprintWindow.focus();\n\t\tprintWindow.print();\n\t\tprintWindow.close();\n        }\n\n}\n", "pos_ar.PointOfSale.pos_db  = class POSDatabase {\n\n\tconstructor(db) {\n\t\tthis.db = db;\n\t\tthis.setupDatabase();\n\t}\n\n\n\tstatic async openDatabase(){\n\t\treturn new Promise((resolve , reject) => {\n\n\t\t\t// Let us open our database\n\t\t\tconst request = window.indexedDB.open( 'POSDB_test33' , 1);\n\n\t\t\trequest.onerror = (event) => {\n\t\t\t\t// Do something with request.error!\n\t\t\t\treject(request.error)\n\t\t\t};\n\n\t\t\trequest.onsuccess = (event) => {\n\t\t\t\t// Do something with request.result!\n\t\t\t\tresolve(new pos_ar.PointOfSale.pos_db(event.target.result))\n\t\t\t};\n\n \t\t\trequest.onupgradeneeded = (event) => {\n\t\t\t \tconst db = event.target.result;\n\n\t\t\t\t// Create object stores (tables)\n\t\t\t\tif (!db.objectStoreNames.contains('Customer')) {\n\t\t\t\t\tdb.createObjectStore('Customer', { keyPath: 'name' });\n\t\t\t\t}\n\t\t\t\tif (!db.objectStoreNames.contains('Item Group')) {\n\t\t\t\t\tdb.createObjectStore('Item Group', { keyPath: 'name' });\n\t\t\t\t}\n\t\t\t\tif (!db.objectStoreNames.contains('Item')) {\n\t\t\t\t\tdb.createObjectStore('Item', { keyPath: 'name' });\n\t\t\t\t}\n\t\t\t\tif (!db.objectStoreNames.contains('Item Price')) {\n\t\t\t\t\tdb.createObjectStore('Item Price', { keyPath: 'name' });\n\t\t\t\t}\n\t\t\t\tif (!db.objectStoreNames.contains('Price List')) {\n\t\t\t\t\tdb.createObjectStore('Price List', { keyPath: 'name' });\n\t\t\t\t}\n\t\t\t\tif (!db.objectStoreNames.contains('Warehouse')) {\n\t\t\t\t\tdb.createObjectStore('Warehouse', { keyPath: 'name' });\n\t\t\t\t}\n\t\t\t\tif (!db.objectStoreNames.contains('POS Profile')) {\n\t\t\t\t\tdb.createObjectStore('POS Profile', { keyPath: 'name' });\n\t\t\t\t}\n\t\t\t\tif (!db.objectStoreNames.contains('Bin')) {\n\t\t\t\t\tdb.createObjectStore('Bin', { keyPath: 'name' });\n\t\t\t\t}\n\t\t\t\tif (!db.objectStoreNames.contains('POS Invoice')) {\n\t\t\t\t\tconst posInvoiceStore = db.createObjectStore('POS Invoice', { keyPath : 'name' });\n\t\t\t\t\tposInvoiceStore.createIndex( 'docstatus' , 'docstatus' , {unique : false} )\n\t\t\t\t}\n\t\t\t\tif (!db.objectStoreNames.contains('check_in_out')) {\n\t\t\t\t\tdb.createObjectStore('check_in_out', { keyPath : 'name' });\n\t\t\t\t}\n\t\t\t\tif (!db.objectStoreNames.contains('POS Settings')) {\n\t\t\t\t\tdb.createObjectStore('POS Settings', { keyPath : 'id' });\n\t\t\t\t}\n\n\t\t\t};\n\n\n\t\t})\n\t}\n\n\n\n\tsetupDatabase(){\n\t\tthis.db.onerror = (event) => {\n\t\t\t// Generic error handler for all errors targeted at this database's\n\t\t\t// requests!\n\t\t\tconsole.error(`Database error: ${event.target.error?.message}`);\n\t\t};\n\t}\n\n\n\n\t/************************************  counte ***************************************/\n\t/************************************************************************************/\n\t/************************************************************************************/\n\n\n\n\tgetPosCounter(){\n\t\treturn new Promise((resolve , reject) => {\n\t\t\tconst transaction = this.db.transaction(['Counter'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Counter')\n\n\t\t})\n\t}\n\n\n\n\n\t/************************************   Item  ***************************************/\n\t/************************************************************************************/\n\t/************************************************************************************/\n\n\tsaveItemList( itemList ){\n\t\treturn new Promise((resolve , reject) => {\n\t\t\tconst transaction = this.db.transaction(['Item'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Item')\n\t\t\t// Loop through the list of items  and add each one to the store\n\t\t\titemList.forEach(item => {\n\t\t\t\tconst request = store.put(item)\n\t\t\t\trequest.onerror = (err)=>{\n\t\t\t\t\tconsole.error(\"db => error saving Item : \" , item ,  \"err : \" , err)\n\t\t\t\t\treject(err)\n\t\t\t\t}\n\t\t\t})\n\t\t\t// Transaction's oncomplete event will be triggered\n\t\t\t//once all requests in this transaction complete successfully\n\t\t\ttransaction.oncomplete = () => {\n\t\t\t\tresolve()\n\t\t\t};\n\t\t\ttransaction.onerror = (err) => {\n\t\t\t\tconsole.error(\"db => error saving Item.\")\n\t\t\t\treject(err)\n\t\t\t};\n\t\t})\n\t}\n\n\tgetAllItems(){\n\t\treturn new Promise((resolve,reject) =>{\n\t\t\tconst transaction = this.db.transaction(['Item'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Item');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value);\n\t\t\t}\n\t\t\tresult.onerror = (err) => {\n\t\t\t\treject(err);\n\t\t\t}\n\t\t})\n\t}\n\n\n\t/*********************************   POS Profile  ***********************************/\n\t/************************************************************************************/\n\t/************************************************************************************/\n\n\tsavePosProfileList( posProfileList ){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Profile'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('POS Profile')\n\t\t\t// Loop through the list of pos profile and add each one to the store\n\t\t\tposProfileList.forEach(posProfile => {\n\t\t\t\tconst request = store.put(posProfile)\n\t\t\t\trequest.onerror = (err)=>{\n\t\t\t\t\tconsole.error(\"db => error saving POS Profile : \" ,posProfile ,  \"err : \" , err)\n\t\t\t\t\treject(err)\n\t\t\t\t}\n\t\t\t})\n\t\t\t// Transaction's oncomplete event will be triggered\n\t\t\t//once all requests in this transaction complete successfully\n\t\t\ttransaction.oncomplete = () => {\n\t\t\t\tresolve()\n\t\t\t};\n\t\t\ttransaction.onerror = (err) => {\n\t\t\t\tconsole.error(\"db => error saving POS Profile.\")\n\t\t\t\treject(err)\n\t\t\t};\n\t\t})\n\n\t}\n\n\tgetAllPosProfile(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Profile'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('POS Profile');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value);\n\t\t\t}\n\t\t\tresult.onerror = (err) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\treject(value);\n\t\t\t}\n\t\t})\n\t}\n\n\n\n\t/*********************************       Bin      ***********************************/\n\t/************************************************************************************/\n\t/************************************************************************************/\n\n\tsaveBinList( binList ){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Bin'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Bin')\n\t\t\t// Loop through the list of bin  and add each one to the store\n\t\t\tbinList.forEach(bin => {\n\t\t\t\tconst request = store.put(bin)\n\t\t\t\trequest.onerror = (err)=>{\n\t\t\t\t\tconsole.error(\"db => error saving Bin : \" , bin ,  \"err : \" , err)\n\t\t\t\t\treject(err)\n\t\t\t\t}\n\t\t\t})\n\t\t\t// Transaction's oncomplete event will be triggered\n\t\t\t//once all requests in this transaction complete successfully\n\t\t\ttransaction.oncomplete = () => {\n\t\t\t\tresolve()\n\t\t\t};\n\t\t\ttransaction.onerror = (err) => {\n\t\t\t\tconsole.error(\"db => error saving Bin.\")\n\t\t\t\treject(err)\n\t\t\t};\n\t\t})\n\t}\n\n\tgetAllBin(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Bin'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Bin');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value);\n\t\t\t}\n\t\t\tresult.onerror = (err)=> {\n\t\t\t\treject(err);\n\t\t\t}\n\t\t})\n\t}\n\n\n\n\n\t/*********************************   Warehouse    ***********************************/\n\t/************************************************************************************/\n\t/************************************************************************************/\n\n\tsaveWarehouseList(warehouseList){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Warehouse'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Warehouse')\n\t\t\t// Loop through the list of warehouse and add each one to the store\n\t\t\twarehouseList.forEach(warehouse => {\n\t\t\t\tconst request = store.put(warehouse)\n\t\t\t\trequest.onerror = (err)=>{\n\t\t\t\t\tconsole.error(\"db => error saving Warehouse : \" ,warehouse ,  \"err : \" , err)\n\t\t\t\t\treject(err)\n\t\t\t\t}\n\t\t\t})\n\t\t\t// Transaction's oncomplete event will be triggered\n\t\t\t//once all requests in this transaction complete successfully\n\t\t\ttransaction.oncomplete = () => {\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\ttransaction.onerror = (event) => {\n\t\t\t\tconsole.error(\"db => error saving Warehouse List.\")\n\t\t\t\treject(event);\n\t\t\t};\n\t\t})\n\t}\n\n\tgetAllWarehouse(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Warehouse'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Warehouse');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value);\n\t\t\t}\n\t\t\tresult.onerror = (err) => {\n\t\t\t\treject(err);\n\t\t\t}\n\t\t})\n\t}\n\n\n\n\t/*********************************   Price List   ***********************************/\n\t/************************************************************************************/\n\t/************************************************************************************/\n\n\tsavePriceLists(priceLists){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Price List'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Price List')\n\n\t\t\t// Loop through the list of price lists and add each one to the store\n\t\t\tpriceLists.forEach(priceList => {\n\t\t\t\tconst request = store.put(priceList)\n\t\t\t\trequest.onerror = (err)=>{\n\t\t\t\t\tconsole.error(\"db => error saving Price List : \" ,itemPrice ,  \"err : \" , err)\n\t\t\t\t\treject(err)\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t// Transaction's oncomplete event will be triggered\n\t\t\t//once all requests in this transaction complete successfully\n\t\t\ttransaction.oncomplete = () => {\n\t\t\t\tresolve();\n\t\t\t};\n\n\t\t\ttransaction.onerror = (err) => {\n\t\t\t\tconsole.error(\"db => error saving Price Lists.\")\n\t\t\t\treject(err);\n\t\t\t};\n\t\t})\n\n\t}\n\n\tgetAllPriceList(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Price List'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Price List');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value);\n\t\t\t}\n\t\t\tresult.onerror = (err)=>{\n\t\t\t\treject(err)\n\t\t\t}\n\t\t})\n\t}\n\n\n\n\n\t/*********************************   Item Price   ***********************************/\n\t/************************************************************************************/\n\t/************************************************************************************/\n\n\tsaveItemPriceList(itemPriceList){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Item Price'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Item Price')\n\t\t\t// Loop through the list of item price and add each one to the store\n\t\t\titemPriceList.forEach(itemPrice => {\n\t\t\t\tconst request = store.put(itemPrice)\n\t\t\t\trequest.onerror = (err)=>{\n\t\t\t\t\tconsole.error(\"db => error saving Item Price : \" ,itemPrice ,  \"err : \" , err)\n\t\t\t\t\treject(err)\n\t\t\t\t}\n\t\t\t})\n\t\t\t// Transaction's oncomplete event will be triggered\n\t\t\t//once all requests in this transaction complete successfully\n\t\t\ttransaction.oncomplete = () => {\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\ttransaction.onerror = (err) => {\n\t\t\t\tconsole.error(\"db => error saving Item Price.\")\n\t\t\t\treject(err);\n\t\t\t};\n\t\t})\n\t}\n\n\tgetAllItemPrice(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Item Price'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Item Price');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value);\n\t\t\t}\n\t\t\tresult.onerror = (err)=>{\n\t\t\t\treject(err);\n\t\t\t}\n\t\t})\n\t}\n\n\n\t/*********************************   Item Group   ***********************************/\n\t/************************************************************************************/\n\t/************************************************************************************/\n\n\tsaveItemGroupList(itemGroupList){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Item Group'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Item Group')\n\t\t\t// Loop through the list of item group and add each one to the store\n\t\t\titemGroupList.forEach(itemGroup => {\n\t\t\t\tconst request = store.put(itemGroup)\n\t\t\t\trequest.onerror = (err)=>{\n\t\t\t\t\treject(err);\n\t\t\t\t\tconsole.error(\"db => error saving Item Group : \" ,itemGroup ,  \"err : \" , err)\n\t\t\t\t}\n\t\t\t})\n\t\t\t// Transaction's oncomplete event will be triggered\n\t\t\t//once all requests in this transaction complete successfully\n\t\t\ttransaction.oncomplete = () => {\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\ttransaction.onerror = (err) => {\n\t\t\t\tconsole.error(\"db => error saving Item Group.\")\n\t\t\t\treject(err);\n\t\t\t};\n\t\t})\n\t}\n\n\tgetAllItemGroup(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Item Group'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Item Group');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value);\n\t\t\t}\n\t\t\tresult.onerror = (err)=>{\n\t\t\t\treject(err);\n\t\t\t}\n\t\t})\n\t}\n\n\n\n\t/*********************************   cutomers   *************************************/\n\t/************************************************************************************/\n\t/************************************************************************************/\n\n\tsaveCustomerList(customerList ){\n\t\treturn new Promise((resolve,reject) => {\n\t\t\tconst transaction = this.db.transaction(['Customer'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Customer')\n\t\t\t// Loop through the list of customers and add each one to the store\n\t\t\tcustomerList.forEach(customer => {\n\t\t\t\tconst request = store.put(customer)\n\t\t\t\trequest.onerror = (err)=>{\n\t\t\t\t\tconsole.error(\"db => error saving customer : \" ,customer ,  \"err : \" , err)\n\t\t\t\t\treject(err)\n\t\t\t\t}\n\t\t\t})\n\t\t\t// Transaction's oncomplete event will be triggered\n\t\t\t//once all requests in this transaction complete successfully\n\t\t\ttransaction.oncomplete = () => {\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\ttransaction.onerror = (event) => {\n\t\t\t\tconsole.error(\"db => error saving customer.\")\n\t\t\t\treject(event)\n\t\t\t};\n\n\t\t})\n\t}\n\n\tgetAllCustomers(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Customer'] , \"readonly\");\n\t\t\tconst store       = transaction.objectStore('Customer');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value)\n\t\t\t}\n\t\t\tresult.onerror = (value)=>{\n\t\t\t\tconsole.error(\"error when getting customer from db\")\n\t\t\t\treject(event)\n\t\t\t}\n\t\t})\n\t}\n\n\n\n\n\n\t/****************************** pos invoice *********************************/\n\t/****************************************************************************/\n\t/****************************************************************************/\n\n\tsavePosInvoice(posInvoice){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Invoice'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('POS Invoice')\n\t\t\tconst request     = store.put(posInvoice)\n\t\t\trequest.onsuccess = (event) => {\n\t\t\t\tresolve(event);\n\t\t\t};\n\t\t\trequest.onerror = (event) => {\n\t\t\t\treject(event);\n\t\t\t};\n\t\t})\n\n\t}\n\n\tupdatePosInvoice(posInvoice) {\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Invoice'], \"readwrite\");\n\t\t\tconst store = transaction.objectStore('POS Invoice');\n\t\t\t// add if not exists or update if it exists.\n\t\t\tconst request = store.put(posInvoice);\n\t\t\trequest.onsuccess = (event) => {\n\t\t\t\tresolve(event.target.result);\n\t\t\t};\n\t\t\trequest.onerror = (event) => {\n\t\t\t\treject(event);\n    \t\t\t};\n\t\t})\n\t}\n\n\t//async\n\tgetAllPosInvoice(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Invoice'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('POS Invoice');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value);\n\t\t\t}\n\t\t\tresult.onerror = (err)=>{\n\t\t\t\treject(err)\n\t\t\t}\n\t\t})\n\t}\n\t//callBack version\n\tgetAllPosInvoice_callback(onSuccess,onFailure){\n\t\tconst transaction = this.db.transaction(['POS Invoice'] , \"readwrite\");\n\t\tconst store       = transaction.objectStore('POS Invoice');\n\t\tconst result      = store.getAll()\n\t\tresult.onsuccess = (event) => {\n\t\t\tconst value = event.target.result\n\t\t\tonSuccess(value);\n\t\t}\n\t\tresult.onerror = (err)=>{\n\t\t\tonFailure(err)\n\t\t}\n\t}\n\n\tgetDraftPosInvoice(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction_posInvoice     = this.db.transaction(['POS Invoice'] , \"readwrite\");\n\t\t\tconst store_posInvoice           = transaction_posInvoice.objectStore('POS Invoice');\n\t\t\tconst index_docstatus_posInvoice = store_posInvoice.index('docstatus');\n\t\t\tconst request = index_docstatus_posInvoice.getAll(0);\n\t\t\trequest.onsuccess = (event) => {\n\t\t\t\tresolve(event.target.result);\n\t\t\t};\n\t\t\trequest.onerror = (err) => {\n\t\t\t\treject(err);\n\t\t\t};\n\t\t})\n\n\t}\n\n\tgetNotSyncedPosNumber(onSuccess,onFailure){\n\t\t\tconst transaction_posInvoice     = this.db.transaction(['POS Invoice'] , \"readwrite\");\n\t\t\tconst store_posInvoice           = transaction_posInvoice.objectStore('POS Invoice');\n\t\t\tconst index_docstatus_posInvoice = store_posInvoice.index('docstatus');\n\t\t\tconst request = index_docstatus_posInvoice.getAll(1);\n\t\t\trequest.onsuccess = (result) => {\n\t\t\t\tconst filtredResult = result.target.result.filter(invoice => invoice.synced == false )\n\t\t\t\tonSuccess(filtredResult.length);\n\t\t\t}\n\t\t\trequest.onerror = (err) => {\n\t\t\t\tonFailure(err);\n\t\t\t}\n\t}\n\n\n\tgetNotSyncedPos(onSuccess,onFailure){\n\t\tconst transaction_posInvoice     = this.db.transaction(['POS Invoice'] , \"readwrite\");\n\t\tconst store_posInvoice           = transaction_posInvoice.objectStore('POS Invoice');\n\t\tconst index_docstatus_posInvoice = store_posInvoice.index('docstatus');\n\t\tconst request = index_docstatus_posInvoice.getAll(1);\n\t\trequest.onsuccess = (result) => {\n\t\t\tconst filtredResult = result.target.result.filter(invoice => invoice.synced == false )\n\t\t\tonSuccess(filtredResult);\n\t\t}\n\t\trequest.onerror = (err) => {\n\t\t\tonFailure(err);\n\t\t}\n\t}\n\n\t// New delete function to remove a POS Invoice\n\tdeletePosInvoice(invoiceName) {\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Invoice'], \"readwrite\");\n\t\t\tconst store = transaction.objectStore('POS Invoice');\n\t\t\tconst request = store.delete(invoiceName);  // Deletes the record with the key 'invoiceName', (i set the name as keypath , in erpnext name is the id.)\n\t\t\trequest.onsuccess = () => {\n\t\t\t\tresolve();  // Call success callback if the deletion is successful\n\t\t\t};\n\t\t\trequest.onerror = (err) => {\n\t\t\t\treject(err);  // Call failure callback if there is an error\n\t\t\t};\n\t\t})\n\t}\n\n\t// New delete function to remove a POS Invoice\n\tdeletePosInvoice_callback(invoiceName,onSuccess,onFailure) {\n\t\tconst transaction = this.db.transaction(['POS Invoice'], \"readwrite\");\n\t\tconst store = transaction.objectStore('POS Invoice');\n\t\tconst request = store.delete(invoiceName);  // Deletes the record with the key 'invoiceName', (i set the name as keypath , in erpnext name is the id.)\n\t\trequest.onsuccess = () => {\n\t\t\tonSuccess();  // Call success callback if the deletion is successful\n\t\t};\n\t\trequest.onerror = (err) => {\n\t\t\tonFailure(err);  // Call failure callback if there is an error\n\t\t};\n\t}\n\n\tdeleteAllPosInvoice() {\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Invoice'], 'readwrite');\n\t\t\tconst store = transaction.objectStore('POS Invoice');\n\t\t\tconst request = store.clear(); // Clear all entries in the store\n\t\t\trequest.onsuccess = () => {\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\trequest.onerror = (err) => {\n\t\t\t\treject(err);\n\t\t\t};\n\t\t})\n\t}\n\n\n\n\t/********************************* check_in_out ***********************************************/\n\tsaveCheckInOut(checkInOut,onSuccess,onFailure){\n\t\tconst transaction = this.db.transaction(['check_in_out'] , \"readwrite\");\n\t\tconst store       = transaction.objectStore('check_in_out')\n\t\tconst request     = store.put(checkInOut)\n\t\trequest.onsuccess = (event) => {\n\t\t\tonSuccess(event.target.result);\n\t\t};\n\t\trequest.onerror = (err) => {\n\t\t\tonFailure(err);\n\t\t};\n\t}\n\n\tgetAllCheckInOut(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['check_in_out'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('check_in_out');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value);\n\t\t\t}\n\t\t\tresult.onerror = (err)=>{\n\t\t\t\treject(err)\n\t\t\t}\n\t\t})\n\t}\n\n\tgetAllCheckInOut_callback(onSuccess,onFailure){\n\t\tconst transaction = this.db.transaction(['check_in_out'] , \"readwrite\");\n\t\tconst store       = transaction.objectStore('check_in_out');\n\t\tconst result      = store.getAll()\n\t\tresult.onsuccess = (event) => {\n\t\t\tconst value = event.target.result\n\t\t\tonSuccess(value);\n\t\t}\n\t\tresult.onerror = (err)=>{\n\t\t\tonFailure(err)\n\t\t}\n\t}\n\n\tdeleteAllCheckInOut() {\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['check_in_out'], 'readwrite');\n\t\t\tconst store = transaction.objectStore('check_in_out');\n\t\t\tconst request = store.clear(); // Clear all entries in the store\n\t\t\trequest.onsuccess = () => {\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\trequest.onerror = (err) => {\n\t\t\t\treject(err);\n\t\t\t};\n\t\t})\n\t}\n\n\t/****************************** pos settings *********************************/\n\t/*****************************************************************************/\n\t/*****************************************************************************/\n\n\tupdateSettings(settings){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Settings'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('POS Settings')\n\t\t\tconst request     = store.put({id : 1 , ...settings});\n\t\t\trequest.onsuccess = (event) => {\n\t\t\t\tresolve(event.target.result);\n\t\t\t};\n\t\t\trequest.onerror = (err) => {\n\t\t\t\treject(err);\n\t\t\t};\n\t\t})\n\t}\n\t//callback version\n\tupdateSettings_callback(settings,onSuccess,onFailure){\n\t\tconst transaction = this.db.transaction(['POS Settings'] , \"readwrite\");\n\t\tconst store       = transaction.objectStore('POS Settings')\n\t\tconst request     = store.put({id : 1 , ...settings});\n\t\trequest.onsuccess = (event) => {\n\t\t\tonSuccess(event.target.result);\n\t\t};\n\t\trequest.onerror = (err) => {\n\t\t\tonFailure(err);\n\t\t};\n\t}\n\n\n\tgetSettings(onSuccess,onFailure) {\n\t\tconst transaction = this.db.transaction(['POS Settings'], 'readwrite');\n\t\tconst store = transaction.objectStore('POS Settings');\n\t\tconst request = store.get(1); // Get the settings using the unique ID\n\t\trequest.onsuccess = (event) => {\n\t\t\tonSuccess(event.target.result);\n\t\t};\n\t\trequest.onerror = (err) => {\n\t\t\tonFailure(err);\n\t\t};\n\t}\n\n\tdeleteAllSettings() {\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Settings'], 'readwrite');\n\t\t\tconst store = transaction.objectStore('POS Settings');\n\t\t\tconst request = store.clear(); // Clear all entries in the store\n\t\t\trequest.onsuccess = () => {\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\trequest.onerror = (err) => {\n\t\t\t\treject(err);\n\t\t\t};\n\t\t})\n\t}\n\n}\n", "pos_ar.PointOfSale.pos_settings = class{\n\n\tconstructor(\n\t\twrapper,\n\t\tsettingsData,\n\t\tselectedPosProfile,\n\t\tonSettingsChange,\n\t){\n\t\tthis.wrapper              = wrapper            ;\n\t\tthis.settings_data        = settingsData       ;\n\t\tthis.selected_pos_profile = selectedPosProfile ;\n\t\tthis.on_settings_change   = onSettingsChange   ;\n\t\t//scene\n\t\tthis.scene = 'pos_profile'\n\n\t\tthis.start_work()\n\t}\n\n\tstart_work(){\n\t\tthis.prepareSettingsCart();\n\t\tthis.refreshLeftSection();\n\t\tthis.setListener();\n\t}\n\n\n\tprepareSettingsCart(){\n\t\tthis.wrapper.find('#RightSection').append('<div id=\"settingsRightContainer\" class=\"columnBox\"></div>')\n\t\tthis.wrapper.find('#LeftSection').append('<div id=\"settingsLeftContainer\" class=\"columnBox\"></div>')\n\n\t\tthis.leftContainer = this.wrapper.find('#settingsLeftContainer')\n\t\tthis.rightContainer  = this.wrapper.find('#settingsRightContainer')\n\n\n\t\t//right section\n\t\tthis.rightContainer.append('<div id=\"pos_profile_btn\"      class=\"settings_tab active\" >POS Profile</div>')\n\t\tthis.rightContainer.append('<div id=\"general_settings_btn\" class=\"settings_tab\"        >Generale Settings</div>')\n\t\tthis.rightContainer.append('<div id=\"about_us_btn\"         class=\"settings_tab\"        >About Us</div>')\n\n\t\tthis.pos_profile_btn      = this.rightContainer.find('#pos_profile_btn')\n\t\tthis.general_settings_btn = this.rightContainer.find('#general_settings_btn')\n\t\tthis.about_us_btn         = this.rightContainer.find('#about_us_btn')\n\t}\n\n\trefreshLeftSection(){\n\t\tthis.leftContainer.html('')\n\t\tif(this.scene == 'pos_profile'){\n\t\t\tthis.refreshPosProfileScene();\n\t\t}else if(this.scene == 'general_settings'){\n\t\t\tthis.refreshGeneralSettings();\n\t\t}else if(this.scene == \"about_us\"){\n\t\t\tthis.refreshAboutUs();\n\t\t}\n\t}\n\n\trefreshPosProfileScene(){\n\t\t//left container\n\t\tthis.leftContainer.addClass('columnBox')\n\t\tthis.leftContainer.append('<h4 class=\"CartTitle\" style=\"margin-bottom:35px; font-size:35px;\" >POS Profile</h4>')\n\t\tthis.leftContainer.append('<div id=\"settingsCartContentsContainer\">  </div>')\n\t\tthis.contentsContainer = this.leftContainer.find('#settingsCartContentsContainer');\n\n\t\t//pos profile:\n\t\tthis.contentsContainer.append('<div id=\"posProfileContent\" class=\"contentContainer rowBox\" style=\"width:100%;\"> <div class=\"c1 columnBox\"></div>   <div class=\"c2 columnBox\"></div> </div>')\n\t\tthis.pos_profile_content = this.contentsContainer.find('#posProfileContent')\n\t\tthis.c1 = this.pos_profile_content.find('div.c1')\n\t\tthis.c2 = this.pos_profile_content.find('div.c2')\n\n\t\tthis.c1.append('<label for=\"pos_profile\"> POS Profile </label>')\n\t\tthis.c1.append('<select  name=\"pos_profile\" id=\"posProfileSelect\" disabled ></select>')\n\n\t\tthis.pos_profile_select = this.c1.find('#posProfileSelect')\n\t\tthis.pos_profile_select.append(`<option value=\"${this.selected_pos_profile.name} selected \">${this.selected_pos_profile.name}</option>`)\n\n\t\tthis.c1.append(`<label for=\"warehouse\">POS Warehouse</label>`)\n\t\tthis.c1.append(`<input name=\"warehouse\" value=\"${this.selected_pos_profile.warehouse}\" disabled>`)\n\n\t\tthis.c1.append(`<label for=\"income_account\">POS income account</label>`)\n\t\tthis.c1.append(`<input name=\"income_account\" value=\"${this.selected_pos_profile.income_account}\" disabled>`)\n\n\t\tthis.c2.append(`<label for=\"write_off_account\">POS write off account</label>`)\n\t\tthis.c2.append(`<input name=\"write_off_account\" value=\"${this.selected_pos_profile.write_off_account}\" disabled>`)\n\n\t\tthis.c2.append(`<label for=\"write_off_cost_center\">POS write off cost center</label>`)\n\t\tthis.c2.append(`<input name=\"write_off_cost_center\" value=\"${this.selected_pos_profile.write_off_cost_center}\" disabled>`)\n\n\t\tthis.c2.append(`<label for=\"taxes_and_charges\">POS taxes and charges</label>`)\n\t\tthis.c2.append(`<input name=\"taxes_and_charges\" value=\"${this.selected_pos_profile.taxes_and_charges}\" disabled>`)\n\n\t}\n\n\n\trefreshGeneralSettings(){\n\n\t\tconst priceBase           = this.settings_data.settings.itemPriceBasedOn\n\t\tconst showItemDetailsCart = this.settings_data.settings.showItemDetails   ? \"checked\" : \"\"\n\t\tconst showItemImage       = this.settings_data.settings.showItemImage     ? \"checked\" : \"\"\n\t\tconst showDiscountField   = this.settings_data.settings.showDiscountField ? \"checked\" : \"\"\n\t\tconst searchByGroup       = this.settings_data.settings.search_by_group   ? \"checked\" : \"\"\n\n\n\t\t//left container\n\t\tthis.leftContainer.addClass('columnBox')\n\t\tthis.leftContainer.append('<h4 class=\"CartTitle\" style=\"margin-bottom:35px; font-size:35px;\" >General Settings</h4>')\n\t\tthis.leftContainer.append('<div id=\"settingsCartContentsContainer\">  </div>')\n\t\tthis.contentsContainer = this.leftContainer.find('#settingsCartContentsContainer');\n\n\t\t//settings :\n\t\tthis.contentsContainer.append('<div id=\"generalSettingsContent\" class=\"contentContainer rowBox\" style=\"width:100%;\"> <div class=\"c1 columnBox\"></div>   <div class=\"c2 columnBox\"></div> </div>')\n\t\tthis.general_settings_content = this.contentsContainer.find('#generalSettingsContent')\n\t\tthis.general_settings_c1 = this.general_settings_content.find('div.c1')\n\t\tthis.general_settings_c2 = this.general_settings_content.find('div.c2')\n\n\t\t//price base on\n\t\tthis.general_settings_c1.append('<label for=\"priceBasedOn\" style=\"font-weight:600;\"> Item Price Based On : </label>')\n\t\tthis.general_settings_c1.append('<select  name=\"priceBasedOn\" id=\"priceBasedOnSelect\" ></select>')\n\t\tthis.item_price_based_on_select = this.general_settings_c1.find('#priceBasedOnSelect')\n\n\t\tthis.settings_data.getAllPriceBases().forEach( base =>{\n\t\t\tif(this.settings_data.settings.itemPriceBasedOn == base){\n\t\t\t\tthis.item_price_based_on_select.append(`<option value=\"${base}\" selected> ${base} </option>`)\n\t\t\t}else{\n\t\t\t\tthis.item_price_based_on_select.append(`<option value=\"${base}\"> ${base} </option>`)\n\t\t\t}\n\t\t})\n\n\t\t//show item details cart\n\t\tthis.general_settings_c1.append('<div for=\"showItemDetailsCartCheckBox\" style=\"font-weight:600;\"> Item Details Cart : </div>')\n\t\tthis.general_settings_c1.append(`<div class=\"rowBox align_center\" style=\"height:50px;\"><label for=\"showItemDetailsCartCheckBox\" style=\"margin-right:16px;width:50%;\" > show cart: </label> <input type=\"checkbox\"  name=\"showItemDetailsCartCheckBox\" id=\"showItemDetailsCartCheckBox\" ${showItemDetailsCart} ></div>`)\n\n\t\t//show item details cart\n\t\tthis.general_settings_c1.append('<div for=\"showItemDetailsCartCheckBox\" style=\"font-weight:600;\"> Item Image : </div>')\n\t\tthis.general_settings_c1.append(`<div class=\"rowBox align_center\" style=\"height:50px;\" ><label for=\"showItemImageCheckBox\" style=\"margin-right:16px;width:50%;\"> show item image: </label> <input type=\"checkbox\"  name=\"showItemImageCheckBox\" id=\"showItemImageCheckBox\" ${showItemImage} ></div>`)\n\n\t\t//show item details cart\n\t\tthis.general_settings_c1.append('<div for=\"showItemDetailsCartCheckBox\" style=\"font-weight:600;\"> Discount feature : </div>')\n\t\tthis.general_settings_c1.append(`<div class=\"rowBox align_center\" style=\"height:50px;\" ><label for=\"showDiscountFieldCheckBox\" style=\"margin-right:16px;width:50%;\"> show discount field: </label> <input type=\"checkbox\"  name=\"showDiscountFieldCheckBox\" id=\"showDiscountFieldCheckBox\" ${showDiscountField} ></div>`)\n\n\t\t//show item details cart\n\t\tthis.general_settings_c1.append('<div for=\"showItemDetailsCartCheckBox\" style=\"font-weight:600;\"> filter item by group : </div>')\n\t\tthis.general_settings_c1.append(`<div class=\"rowBox align_center\" style=\"height:50px;\" ><label for=\"showItemGroupFilterCheckBox\" style=\"margin-right:16px;width:50%;\"> show item group filter: </label> <input type=\"checkbox\"  name=\"showItemGroupFilterCheckBox\" id=\"showItemGroupFilterCheckBox\" ${searchByGroup} ></div>`)\n\n\n\t\t//set listeners\n\t\tthis.item_price_based_on_select.on('input' , (event)=>{\n\t\t\tthis.settings_data.setPriceItemBasedOn(\n\t\t\t\tevent.target.value,\n\t\t\t\t()=>{\n\t\t\t\t\tthis.on_settings_change(\"itemPriceBasedOn\")\n\t\t\t\t},()=>{\n\t\t\t\t\tconsole.error(\"error to save the settings changes (settings.js)\")\n\t\t\t\t}\n\t\t\t)\n\t\t})\n\n\t\tthis.general_settings_c1.find(\"#showItemDetailsCartCheckBox\").on('click' , (event)=>{\n\t\t\tthis.settings_data.settings.showItemDetails =  $(event.target).is(':checked')\n\t\t\tthis.settings_data.setSettings(\n\t\t\t\tthis.settings_data.settings,\n\t\t\t\t()=>{\n\t\t\t\t\tthis.on_settings_change(\"showItemDetails\")\n\t\t\t\t},()=>{\n\t\t\t\t\tconsole.error(\"error to save the settings changes (settings.js)\")\n\t\t\t\t}\n\t\t\t)\n\t\t})\n\t\tthis.general_settings_c1.find(\"#showItemImageCheckBox\").on('click' , (event)=>{\n\t\t\tthis.settings_data.settings.showItemImage =  $(event.target).is(':checked')\n\t\t\tthis.settings_data.setSettings(\n\t\t\t\tthis.settings_data.settings,\n\t\t\t\t()=>{\n\t\t\t\t\tthis.on_settings_change(\"showItemImage\")\n\t\t\t\t},()=>{\n\t\t\t\t\tconsole.error(\"error to save the settings changes (settings.js)\")\n\t\t\t\t}\n\t\t\t)\n\t\t})\n\t\tthis.general_settings_c1.find(\"#showDiscountFieldCheckBox\").on('click' , (event)=>{\n\t\t\tthis.settings_data.settings.showDiscountField =  $(event.target).is(':checked')\n\t\t\tthis.settings_data.setSettings(\n\t\t\t\tthis.settings_data.settings,\n\t\t\t\t()=>{\n\t\t\t\t\tthis.on_settings_change(\"showDiscountField\")\n\t\t\t\t},()=>{\n\t\t\t\t\tconsole.error(\"error to save the settings changes (settings.js)\")\n\t\t\t\t}\n\t\t\t)\n\t\t})\n\t\tthis.general_settings_c1.find(\"#showItemGroupFilterCheckBox\").on('click' , (event)=>{\n\t\t\tthis.settings_data.settings.search_by_group =  $(event.target).is(':checked')\n\t\t\tthis.settings_data.setSettings(\n\t\t\t\tthis.settings_data.settings,\n\t\t\t\t()=>{\n\t\t\t\t\tthis.on_settings_change(\"\")\n\t\t\t\t},()=>{\n\t\t\t\t\tconsole.error(\"error to save the settings changes (settings.js)\")\n\t\t\t\t}\n\t\t\t)\n\t\t})\n\n\t}\n\trefreshAboutUs(){\n\t\t//left container\n\t\tthis.leftContainer.addClass('columnBox')\n\t\tthis.leftContainer.append('<h4 class=\"CartTitle\" style=\"margin-bottom:35px; font-size:35px;\" >About Us</h4>')\n\t\tthis.leftContainer.append('<div id=\"settingsCartContentsContainer\">  </div>')\n\t\tthis.contentsContainer = this.leftContainer.find('#settingsCartContentsContainer');\n\n\t}\n\n\n\tshowCart(){\n\t\tthis.rightContainer.css('display' , 'flex')\n\t\tthis.leftContainer.css('display' , 'flex')\n\t}\n\thideCart(){\n\t\tthis.rightContainer.css('display' , 'none')\n\t\tthis.leftContainer.css('display' , 'none')\n\t}\n\n\t/*********************** set listener  ********************************/\n\n\tsetListener(){\n\t\tconst tabs = document.querySelectorAll('.settings_tab');\n\t\tconst all_content = document.querySelectorAll('.contentContainer')\n\n\t\ttabs.forEach((tab , index)=>{\n\t\t\ttab.addEventListener('click' , ()=>{\n\t\t\t\ttabs.forEach(tab => {\n\t\t\t\t\ttab.classList.remove('active');\n\t\t\t\t})\n\t\t\t\ttab.classList.add('active');\n\t\t\t})\n\t\t})\n\n\n\t\tthis.pos_profile_btn.on('click' , (event)=>{\n\t\t\tthis.scene = 'pos_profile';\n\t\t\tthis.refreshLeftSection();\n\t\t})\n\n\n\t\tthis.general_settings_btn.on('click' , (event)=>{\n\t\t\tthis.scene = 'general_settings';\n\t\t\tthis.refreshLeftSection()\n\t\t})\n\n\t\tthis.about_us_btn.on('click' , (event)=>{\n\t\t\tthis.scene = 'about_us';\n\t\t\tthis.refreshLeftSection()\n\t\t})\n\n\t}\n\n\n}\n", "pos_ar.PointOfSale.pos_check_in_out = class {\n\n\tconstructor(\n\t\twrapper,\n\t\tdb\n\t){\n\t\tthis.wrapper   = wrapper;\n\t\tthis.db        = db;\n\n\t\t//local\n\t\tthis.checkList = [];\n\t\tthis.filter    = 'All';\n\t\tthis.selectedCheckInOut = null;\n\n\t\tthis.start_work();\n\t}\n\n\tstart_work(){\n\t\tthis.prepare_checkInOut_cart();\n\t\tthis.getAllCheckInOut();\n\t\tthis.setListeners();\n\t}\n\n\t/****************************************    UI    *******************************************************/\n\n\tprepare_checkInOut_cart(){\n\t\tthis.wrapper.find('#LeftSection').append('<div id=\"checkInOutLeftContainer\" class=\"columnBox\"></div>')\n\t\tthis.wrapper.find('#RightSection').append('<div id=\"checkInOutRightContainer\" class=\"columnBox\"></div>')\n\n\t\tthis.left_container  = this.wrapper.find('#checkInOutLeftContainer')\n\t\tthis.right_container = this.wrapper.find('#checkInOutRightContainer')\n\n\t\t///////////////////right section\n\t\t//checkInOut tab\n\t\tthis.right_container.append('<div id=\"checkInOutTabContainer\" class=\"rowBox\">  <div id=\"tabAll\" class=\"tab selected\">All</div> <div id=\"tabCheckIn\" class=\"tab\">Check In</div> <div id=\"tabCheckOut\" class=\"tab\">Check Out</div>  </div>')\n\t\tthis.tab_container = this.right_container.find('#checkInOutTabContainer')\n\t\tthis.tab_all = this.tab_container.find('#tabAll')\n\t\tthis.tab_in  = this.tab_container.find('#tabCheckIn')\n\t\tthis.tab_out = this.tab_container.find('#tabCheckOut')\n\t\t//checkInOut list\n\t\tthis.right_container.append('<div id=\"checkInOutList\" class=\"columnBox\"></div>')\n\t\tthis.check_in_out_list = this.right_container.find('#checkInOutList')\n\n\t\t//////////////////now left section\n\t\tconst header =\n\t\t\t'<div id=\"detailsCheckInOutHeader\" class=\"rowBox\" >'+\n\t\t\t\t'<div class=\"checkInAmount columnBox\" >'+\n\t\t\t\t\t'<div class=\"rowBox centerItem\" style=\"width:100%;height:50%;\">'+\n\t\t\t\t\t\t'<div style=\"font-size:25px; font-weight:700;\">Check In</div>'+\n\t\t\t\t\t'</div>'+\n\t\t\t\t\t'<div id=\"TotalCheckInValue\" class=\"rowBox centerItem\" style=\"height:50%; width:100%;\">...DA</div>'+\n\t\t\t\t'</div>'+\n\t\t\t\t'<div class=\"checkOutAmount columnBox\" >'+\n\t\t\t\t\t'<div class=\"rowBox centerItem\" style=\"width:100%;height:50%;\" >'+\n\t\t\t\t\t\t'<div style=\"font-size:25px; font-weight:700;\">Check Out</div>'+\n\t\t\t\t\t'</div>'+\n\t\t\t\t\t'<div id=\"TotalCheckOutValue\" class=\"rowBox centerItem\" style=\"width:100%;height:50%;\"> ...DA </div>'+\n\t\t\t\t'</div>'+\n\t\t\t\t'<div class=\"totalCheckInOutAmount columnBox centerItem\">'+\n\t\t\t\t\t'<div class=\"rowBox centerItem\" style=\"width:100%;height:50%;\">'+\n\t\t\t\t\t\t'<div style=\"font-size:25px; font-weight:700;\">Total</div>'+\n\t\t\t\t\t'</div>'+\n\t\t\t\t\t'<div id=\"TotalCheckInOutValue\" class=\"rowBox centerItem\" style=\"height:50%; width:100%;\">...DA</div>'+\n\t\t\t\t'</div>'+\n\t\t\t'</div>'\n\t\tthis.left_container.append(header)\n\t\tthis.details_checkInOut_header = this.left_container.find('#detailsCheckInOutHeader')\n\n\t\t//Amounts\n\t\tthis.check_in_amount           = this.details_checkInOut_header.find('#TotalCheckInValue')\n\t\tthis.check_out_amount          = this.details_checkInOut_header.find('#TotalCheckOutValue')\n\t\tthis.check_total_in_out_amount = this.details_checkInOut_header.find('#TotalCheckInOutValue')\n\n\n\t\t// one checkInOut details content\n\t\tthis.left_container.append('<div id=\"detailsCheckInOutContent\" class=\"columnBox\"></div>')\n\t\tthis.detailsCheckInOutContent = this.left_container.find('#detailsCheckInOutContent')\n\t\tconst details =\n\t\t\t'<div class=\"l1 rowBox\">'+\n\t\t\t\t'<div><span class=\"key\">Check Type :<span> <span id=\"selectedCheckInOutType\" class=\"value\"> THE_TYPE </span></div>'+\n\t\t\t\t'<div><span class=\"value\" id=\"selectedCheckInOutCreationTime\"> THE_DATE </span></div>'+\n\t\t\t'</div>'+\n\t\t\t'<div class=\"l2 rowBox\">'+\n\t\t\t\t'<div><span class=\"key\">Amount :</span> <span id=\"selectedCheckInOutAmount\" class=\"value\">THE AMOUNT</span></div>'+\n\t\t\t\t'<div><span id=\"selectedCheckInOutOwner\" class=\"value\">THE OWNER</span></div>'+\n\t\t\t'</div>'+\n\t\t\t'<div class=\"l3\">'+\n\t\t\t\t'<div class=\"title\">Reason</div>'+\n\t\t\t\t'<textarea id=\"selectedCheckInOutReason\" disabled ></textarea>'+\n\t\t\t'</div>'\n\t\tthis.detailsCheckInOutContent.append(details)\n\n\t\tthis.checkType         = this.detailsCheckInOutContent.find('#selectedCheckInOutType')\n\t\tthis.checkAmount       = this.detailsCheckInOutContent.find('#selectedCheckInOutAmount')\n\t\tthis.checkCreationTime = this.detailsCheckInOutContent.find('#selectedCheckInOutCreationTime')\n\t\tthis.checkOwner        = this.detailsCheckInOutContent.find('#selectedCheckInOutOwner')\n\t\tthis.checkReason       = this.detailsCheckInOutContent.find('#selectedCheckInOutReason')\n\t}\n\n\trefreshCheckInOutList(){\n\t\tthis.check_in_out_list.empty();\n\n\t\tconst filteredList = this.checkList.filter( item => item.check_type == this.filter || this.filter == 'All')\n\n\t\tfilteredList.forEach(checkInOut =>{\n\n\t\t\tconst checkInOutObject = document.createElement('div')\n\t\t\tcheckInOutObject.classList.add('checkInOutItem','rowBox')\n\t\t\t//type div container\n\t\t\tconst type_div = document.createElement('div')\n\t\t\ttype_div.classList.add('type')\n\t\t\t//type img image\n\t\t\tconst type_img = document.createElement('img')\n\t\t\ttype_img.src = '/assets/pos_ar/images/arrow.png'\n\t\t\ttype_img.style.width  = '35px'\n\t\t\ttype_img.style.height = '35px'\n\t\t\ttype_img.transform    = checkInOut.check_type === 'In' ? 'rotate(180deg);' : ''\n\t\t\t//type div value\n\t\t\tconst type_value_div       = document.createElement('div')\n\t\t\ttype_value_div.textContent = checkInOut.check_type\n\t\t\t//creation time\n\t\t\tconst creationTimeDiv = document.createElement('div');\n\t\t\tcreationTimeDiv.classList.add('creationTime')\n\t\t\tcreationTimeDiv.textContent = checkInOut.creation_time;\n\t\t\t//amount div\n\t\t\tconst amountDiv       = document.createElement('div')\n\t\t\tamountDiv.classList.add('amount')\n\t\t\tamountDiv.textContent = checkInOut.amount + ' DA'\n\t\t\t//linking stage\n\t\t\ttype_div.append(type_img)\n\t\t\ttype_div.append(type_value_div)\n\t\t\tcheckInOutObject.append(type_div)\n\t\t\tcheckInOutObject.append(creationTimeDiv)\n\t\t\tcheckInOutObject.append(amountDiv)\n\n\n\t\t\t//set listener\n\t\t\tcheckInOutObject.addEventListener('click' , ()=>{\n\t\t\t\tthis.selectedCheckInOut = checkInOut ;\n\t\t\t\tthis.refreshCheckInOutDetails()\n\t\t\t});\n\n\t\t\tthis.check_in_out_list.append(checkInOutObject)\n\t\t})\n\n\t}\n\n\trefreshCheckInOutAmount(){\n\t\tthis.check_total_in_out_amount.html('');\n\t\tthis.check_in_amount.html('');\n\t\tthis.check_out_amount.html('');\n\n\t\tlet inAmount  = 0.00 ;\n\t\tlet outAmount = 0.00 ;\n\t\tlet allAmount = 0.00 ;\n\n\t\tthis.checkList.forEach(item =>{\n\t\t\tallAmount += parseFloat(item.amount) || 0.00;\n\t\t\tif(item.check_type == 'In')\n\t\t\t\tinAmount += parseFloat(item.amount) || 0.00;\n\t\t\telse if(item.check_type == 'Out')\n\t\t\t\toutAmount += parseFloat(item.amount) || 0.00;\n\t\t})\n\t\tthis.check_in_amount.append(`${inAmount.toFixed(2)} DA`)\n\t\tthis.check_out_amount.append(`${outAmount.toFixed(2)} DA`)\n\t\tthis.check_total_in_out_amount.append(`${allAmount.toFixed(2)} DA`)\n\t}\n\n\trefreshCheckInOutDetails(){\n\n\t\tif(this.selectedCheckInOut == null)\n\t\t\treturn;\n\n\t\tthis.checkType.html('')\n\t\tthis.checkCreationTime.html('')\n\t\tthis.checkReason.html('')\n\t\tthis.checkOwner.html('')\n\t\tthis.checkAmount.html('')\n\n\t\tthis.checkType.append(this.selectedCheckInOut.check_type)\n\t\tthis.checkCreationTime.append(this.selectedCheckInOut.creation_time)\n\t\tthis.checkAmount.append(this.selectedCheckInOut.amount + ' DA')\n\t\tthis.checkReason.append(this.selectedCheckInOut.reason)\n\t\tthis.checkOwner.append(this.selectedCheckInOut.owner)\n\n\t\tconsole.log(\"this.checkReason.scrollHeight : \" , this.checkReason.get(0).scrollHeight)\n\t\tthis.checkReason.get(0).style.height = 'auto';\n\t\tthis.checkReason.get(0).style.height = this.checkReason.get(0).scrollHeight + 'px'\n\t}\n\n\n\n\t//show && hide functions\n\tshowCart(){\n\t\tthis.left_container.css('display','flex')\n\t\tthis.right_container.css('display','flex')\n\t}\n\thideCart(){\n\t\tthis.left_container.css('display','none')\n\t\tthis.right_container.css('display','none')\n\t}\n\n\t/*****************************************  listener  **************************************************/\n\t/********************************************************************************************************/\n\n\tsetListeners(){\n\t\tthis.tab_all.on('click' , (event)=>{\n\t\t\tthis.filter = 'All'\n\t\t\tthis.tab_all.addClass('selected')\n\t\t\tthis.tab_out.removeClass('selected')\n\t\t\tthis.tab_in.removeClass('selected')\n\t\t\tthis.refreshCheckInOutList();\n\t\t})\n\t\tthis.tab_in.on('click' , (event)=>{\n\t\t\tthis.filter = 'In'\n\t\t\tthis.tab_in.addClass('selected')\n\t\t\tthis.tab_out.removeClass('selected')\n\t\t\tthis.tab_all.removeClass('selected')\n\t\t\tthis.refreshCheckInOutList();\n\t\t})\n\t\tthis.tab_out.on('click' , (event)=>{\n\t\t\tthis.filter = 'Out'\n\t\t\tthis.tab_out.addClass('selected')\n\t\t\tthis.tab_all.removeClass('selected')\n\t\t\tthis.tab_in.removeClass('selected')\n\t\t\tthis.refreshCheckInOutList();\n\t\t})\n\t}\n\n\t/*****************************************  functions  **************************************************/\n\t/********************************************************************************************************/\n\n\tasync getAllCheckInOut(){\n\t\tthis.db.getAllCheckInOut_callback(\n\t\t\t(res)=>{\n\t\t\t\tif(res.length > 0){\n\t\t\t\t\tthis.selectedCheckInOut = res[0]\n\t\t\t\t}\n\t\t\t\tthis.checkList = res ;\n\t\t\t\tthis.refreshCheckInOutList();\n\t\t\t\tthis.refreshCheckInOutAmount();\n\t\t\t\tthis.refreshCheckInOutDetails();\n\t\t\t\tconsole.log(\"res : \" , res)\n\t\t\t},(err)=>{\n\t\t\t\tconsole.log(\"err : \" , err)\n\t\t\t}\n\t\t)\n\t}\n\n}\n", "pos_ar.PointOfSale.posSettingsData = class{\n\n\n\tconstructor(db){\n\n\t\tthis.db = db;\n\t\t//Array of valid price bases\n\t\tthis.price_bases = ['brand' , 'priceList']\n\t\t//Default setting (it could be more)\n\t\tthis.db.getSettings(\n\t\t\t(res)=>{\n\t\t\t\tif(res && res.itemPriceBasedOn ){\n\t\t\t\t\tthis.settings = res\n\t\t\t\t}else{\n\t\t\t\t\t//default\n\t\t\t\t\tthis.settings = {\n\t\t\t\t\t\titemPriceBasedOn  : 'brand',\n\t\t\t\t\t\tshowItemDetails   : false  ,\n\t\t\t\t\t\tshowItemImage     : false  ,\n\t\t\t\t\t\tshowDiscountField : false  ,\n\t\t\t\t\t\tsearch_by_group   : false\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t},\n\t\t\t(err)=>{\n\t\t\t\tconsole.log(\"error when trying to get the setting from local, so we use the default.\")\n\t\t\t\tthis.settings = {\n\t\t\t\t\titemPriceBasedOn  : 'brand',\n\t\t\t\t\tshowItemDetails   : false  ,\n\t\t\t\t\tshowItemImage     : false  ,\n\t\t\t\t\tshowDiscountField : false  ,\n\t\t\t\t\tsearch_by_group   : false\n\t\t\t\t}\n\n\t\t\t}\n\t\t)\n\t}\n\n\tgetAllPriceBases(){\n\t\treturn this.price_bases;\n\t}\n\n\t//PriceItemBasedOn\n\tgetPriceBase(){\n\t\treturn this.settings.itemPriceBasedOn;\n\t}\n\tsetPriceItemBasedOn(base , onSuccess , onFailure){\n\t\tif(this.price_bases.includes(base)){\n\t\t\tthis.settings.itemPriceBasedOn = base\n\t\t\tthis.db.updateSettings_callback(\n\t\t\t\tthis.settings,\n\t\t\t\t()=>{\n\t\t\t\t\t//saved\n\t\t\t\t\tonSuccess();\n\t\t\t\t\tconsole.log(\"settings update is save successfuly\")\n\t\t\t\t},()=>{\n\t\t\t\t\tconsole.error(\"error occured when trying to save settings\")\n\t\t\t\t}\n\t\t\t)\n\t\t}else{\n\t\t\tconsole.error(\"invalide base : \" , base , \"there are just : \" , this.price_bases)\n\t\t}\n\t}\n\n\t//show item details\n\tgetShowItemDetails(){\n\t\treturn this.settings.showItemDetails;\n\t}\n\tsetShowItemDetails(show , onSuccess , onFailure){\n\t\tthis.settings.showItemDetails = show\n\t\tthis.db.updateSettings_callback(\n\t\t\tthis.settings,\n\t\t\t()=>{\n\t\t\t\t//saved\n\t\t\t\tonSuccess();\n\t\t\t\tconsole.log(\"settings update is save successfuly\")\n\t\t\t},()=>{\n\t\t\t\tconsole.error(\"error occured when trying to save settings\")\n\t\t\t}\n\t\t)\n\n\t}\n\n\n\tsetSettings( settings , onSuccess , onFailure){\n\t\tthis.settings  = settings\n\t\tthis.db.updateSettings_callback(\n\t\t\tthis.settings,\n\t\t\t()=>{\n\t\t\t\t//saved\n\t\t\t\tonSuccess();\n\t\t\t\tconsole.log(\"settings update is save successfuly\")\n\t\t\t},()=>{\n\t\t\t\tconsole.error(\"error occured when trying to save settings\")\n\t\t\t}\n\t\t)\n\n\t}\n\n\n}\n", "pos_ar.PointOfSale.posAppData = class {\n\n\tconstructor(\n\t\tdb,\n\t\tapiHandler\n\t){\n\t\tthis.db          = db;\n\t\tthis.api_handler = apiHandler;\n\n\t\tthis.since = localStorage.getItem('lastTime');\n\n\n\t\tthis.appData = {} ;\n\t}\n\n\n\tasync getAllData(){\n\t\ttry{\n\t\t\tfrappe.show_progress('Please Wait', 0, 12, 'loading deleted documents');\n\t\t\tawait this.getDeletedDocs()\n\t\t\tfrappe.show_progress('Please Wait', 1, 12, 'loading customers...');\n\t\t\tawait this.getCustomers();\n\t\t\tfrappe.show_progress('Please Wait', 2, 12, 'loading items...');\n\t\t\tawait this.getItems();\n\t\t\tfrappe.show_progress('Please Wait', 3, 12, 'loading pos profiles');\n\t\t\tawait this.getPosProfiles();\n\t\t\tfrappe.show_progress('Please Wait', 4, 12, 'loading mode of payment');\n\t\t\tawait this.getPosProfileModeOfPayments(this.appData.pos_profile)\n\t\t\tawait this.getBins();\n\t\t\tfrappe.show_progress('Please Wait', 5, 12, 'loading warehouses');\n\t\t\tawait this.getWarehouses();\n\t\t\tfrappe.show_progress('Please Wait', 6, 12, 'loading price lists');\n\t\t\tawait this.getPriceLists();\n\t\t\tfrappe.show_progress('Please Wait', 7, 12, 'loading item prices');\n\t\t\tawait this.getItemPrices();\n\t\t\tfrappe.show_progress('Please Wait', 8, 12, 'loading item groups');\n\t\t\tawait this.getItemGroups();\n\t\t\tfrappe.show_progress('Please Wait', 9, 12, 'loading invoices');\n\t\t\tawait this.getPosInvoices();\n\t\t\tfrappe.show_progress('Please Wait', 10, 12, 'loading check in out');\n\t\t\tawait this.getCheckInOuts();\n\t\t\tfrappe.show_progress('Please Wait', 11, 12, 'loading barcodes');\n\t\t\tawait this.getItemBarcodes()\n\t\t\tfrappe.show_progress('Please Wait', 12, 12, 'Completed');\n\t\t\tfrappe.hide_progress();\n\t\t\tfrappe.hide_progress();\n\t\t\tfrappe.hide_progress();\n\t\t\tfrappe.hide_progress();\n\n\t\t\tthis.since = frappe.datetime.now_datetime()\n\t\t\tlocalStorage.setItem('lastTime', frappe.datetime.now_datetime());\n\n\n\t\t\tconsole.log(\"app data : \" , this.appData)\n\t\t}catch(err){\n\t\t\tconsole.error(\"appData Class Error  : \" , err)\n\t\t\tfrappe.hide_progress();\n\t\t}\n\t\t\tfrappe.hide_progress();\n\n\n\t}\n\n\n\tasync getCustomers(){\n\t\t/*the function should combine the two the logic didnt complite yet we still working on it*/\n\t\t//get local\n\t\t//const localCustomers = await this.db.getAllCustomers();\n\t\tconst localCustomers = [];\n\t\t//get remote\n\t\tconst updatedCustomers = await this.api_handler.fetchCustomers(this.since)\n\t\t//save new customers\n\t\tawait this.db.saveCustomerList(updatedCustomers)\n\n\t\tthis.appData.customers = this.combineLocalAndUpdated(localCustomers,updatedCustomers)\n\n\t}\n\tasync getBrands(){\n\t\t//get local\n\t\t//get remote\n\t\tthis.appData.brands = await this.api_handler.fetchBrands(this.since)\n\t}\n\tasync getItems(){\n\t\t//get local\n\t\t//const localItems   = await this.db.getAllItems();\n\t\tconst localItems   = [];\n\t\t//get remote\n\t\tconst updatedItems = await this.api_handler.fetchItems(this.since)\n\t\t//save new items\n\t\tawait this.db.saveItemList(updatedItems)\n\n\t\tthis.appData.items = this.combineLocalAndUpdated(localItems,updatedItems)\n\t}\n\tasync getPosProfiles(){\n\t\tthis.appData.pos_profile  =  await this.api_handler.fetchPosProfile(this.since)\n\t}\n\tasync getPosProfileModeOfPayments(posProfile){\n\t\tlet modeOfPaymentsIds = []\n\t\tposProfile.payments.forEach(modeId=>{\n\t\t\tmodeOfPaymentsIds.push(modeId.mode_of_payment)\n\t\t})\n\t\tthis.appData.posProfileModeOfPayments = await this.api_handler.fetchPosProfileModeOfPayments(modeOfPaymentsIds , posProfile.company)\n\t}\n\tasync getBins(){\n\t\t//get local\n\t\t//const localBins   = await this.db.getAllBin();\n\t\tconst localBins   = [];\n\t\t//get remote\n\t\tconst updatedBins = await this.api_handler.fetchBinList(this.since)\n\t\t//save new bins\n\t\tawait this.db.saveBinList(updatedBins)\n\n\t\tthis.appData.bins = this.combineLocalAndUpdated(localBins,updatedBins)\n\t}\n\tasync getWarehouses(){\n\t\t//get local\n\t\t//const localWarehouses   = await this.db.getAllWarehouse();\n\t\tconst localWarehouses   = [];\n\t\t//warehouse\n\t\tconst updatedWarehouses = await this.api_handler.fetchWarehouseList(this.since)\n\t\t//save new warehouse\n\t\tawait this.db.saveWarehouseList(updatedWarehouses);\n\t\tthis.appData.warehouses = this.combineLocalAndUpdated(localWarehouses,updatedWarehouses)\n\t}\n\tasync getPriceLists(){\n\t\t//get local\n\t\t//const localPriceLists  = await this.db.getAllPriceList();\n\t\tconst localPriceLists  = [];\n\t\t//get remote\n\t\tconst updatedPriceList = await this.api_handler.fetchPriceList(this.since)\n\t\t//save new price list\n\t\tawait this.db.savePriceLists(updatedPriceList)\n\n\t\tthis.appData.price_lists = this.combineLocalAndUpdated(localPriceLists,updatedPriceList)\n\t}\n\tasync getItemPrices(){\n\t\t//get local\n\t\t//const localItemPrices = await this.db.getAllItemPrice();\n\t\tconst localItemPrices = [];\n\t\t//get remote\n\t\tconst updateItemPrices = await this.api_handler.fetchItemPrice(this.since)\n\t\tawait this.db.saveItemPriceList(updateItemPrices);\n\n\t\tthis.appData.item_prices = this.combineLocalAndUpdated(localItemPrices,updateItemPrices)\n\t\tconsole.log()\n\t}\n\tasync getItemGroups(){\n\t\t//get local\n\t\t//const localItemGroups = await this.db.getAllItemGroup();\n\t\tconst localItemGroups = [];\n\t\t//get remote\n\t\tconst updatedItemGroups = await this.api_handler.fetchItemGroups(this.since)\n\t\tawait this.db.saveItemGroupList(updatedItemGroups)\n\n\t\tthis.appData.item_groups = this.combineLocalAndUpdated(localItemGroups,updatedItemGroups)\n\t}\n\tasync getItemBarcodes(){\n\t\tthis.appData.item_barcodes = await this.api_handler.fetchItemBarCodes()\n\t}\n\tasync getPosInvoices(){\n\t\t//get local\n\t\tthis.appData.pos_invoices = await this.db.getAllPosInvoice();\n\t}\n\tasync getCheckInOuts(){\n\t\t//get local\n\t\tthis.appData.check_in_outs = await this.db.getAllCheckInOut();\n\t}\n\n\tasync getDeletedDocs(){\n\t\t//get local\n\t\tthis.appData.deleted_documents = await this.api_handler.fetchDeletedDocs(this.since);\n\t}\n\n\n\n\tsaveCheckInOut(checkInOut,onSuccess,onFailure){\n\t\tthis.db.saveCheckInOut(checkInOut,onSuccess,onFailure)\n\t}\n\tsavePosInvoice(posInvoice){\n\t\tthis.db.savePosInvoice(posInvoice)\n\t}\n\tupdatePosInvoice(posInvoice){\n\t\tthis.db.updatePosInvoice(posInvoice)\n\t}\n\tgetNotSyncedPos(onSuccess,onFailure){\n\t\tthis.db.getNotSyncedPos(\n\t\t\t(res)=>{\n\t\t\t\tonSuccess(res)\n\t\t\t},(err)=>{\n\t\t\t\tonFailure(err)\n\t\t\t}\n\t\t)\n\t}\n\tgetNotSyncedPosNumber(onSuccess,onFailure){\n\t\tthis.db.getNotSyncedPosNumber(\n\t\t\t(res)=>{\n\t\t\t\tonSuccess(res)\n\t\t\t},(err)=>{\n\t\t\t\tonFailure(err)\n\t\t\t}\n\t\t)\n\t}\n\n\n\t/******************  function ***************************/\n\tcombineLocalAndUpdated(local,updated){\n\t\t// Create a map from the local data array using a unique identifier (name)\n\t\tconst combinedMap = new Map(local.map(item => [item.name, item]));\n\t\t// Loop through each item in the updated data\n\t\tthis.appData.deleted_documents.forEach(deleted=>{\n\t\t\tcombinedMap.delete( deleted.name )\n\t\t})\n\t\tupdated.forEach(updatedItem=>{\n\t\t\tcombinedMap.set(updatedItem.name , updatedItem)\n\t\t})\n\n\t\treturn Array.from(combinedMap.values())\n\t}\n\n}\n", "pos_ar.PointOfSale.FetchHandler = class FetchHandler{\n\n\tconstructor(){\n\n\t}\n\n\n\tasync fetchCustomers(since) {\n\t\ttry {\n\t\t\tconst filter = { disabled : 0}\n\t\t\t/*if(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}*/\n\t\t\treturn await frappe.db.get_list('Customer', {\n                                fields: ['name', 'customer_name' ],\n\t\t\t\tfilters: filter,\n\t\t\t\tlimit : 100000\n\t\t\t})\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching customers:', error);\n\t\t\treturn []\n\t\t}\n\t}\n\n\n\tasync fetchBrands(since) {\n\t\ttry {\n\t\t\tconst filter = {}\n\t\t\t/*if(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}*/\n\t\t\treturn await frappe.db.get_list('Brand', {\n\t\t\t\tfields: ['brand' ],\n\t\t\t\tfilters: filter,\n\t\t\t\tlimit : 100000\n\t\t\t})\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching customers:', error);\n\t\t\treturn []\n\t\t}\n\t}\n\n\tasync fetchItemGroups(since) {\n\t\ttry {\n\t\t\tconst filter = {}\n\t\t\t/*if(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}*/\n\t\t\treturn await frappe.db.get_list('Item Group', {\n\t\t\t\tfields: ['name', 'item_group_name' , 'parent_item_group' , 'is_group' ],\n\t\t\t\tfilters: filter,\n\t\t\t\tlimit : 100000\n\t\t\t})\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching Item Group :', error);\n\t\t\treturn []\n\t\t}\n\t}\n\n\n\tasync fetchItems(since) {\n\t\ttry {\n\t\t\tconst filter = {disabled : 0}\n\t\t\t/*if(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}*/\n\t\t\treturn await frappe.db.get_list('Item', {\n\t\t\t\tfields: ['name', 'item_name' , 'image' , 'brand' ,'item_group' , 'description' , 'stock_uom' , 'barcodes' ],\n\t\t\t\tfilters: filter,\n\t\t\t\tlimit : 100000\n\t\t\t})\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching Item Group :', error);\n\t\t\treturn []\n\t\t}\n\t}\n\n/*\tasync fetchItemBarCodes(since) {\n\t\ttry {\n\t\t\tconst filter = {parenttype:\"Item\"}\n\t\t\tif(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}\n\t\t\treturn await frappe.db.get_list('Item Barcode', {\n\t\t\t\tfields: ['name', 'barcode_type'  ,'parent' , 'uom' , 'barcode' ],\n\t\t\t\tfilters: filter,\n\t\t\t\tlimit : 100000\n\t\t\t})\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching Item Group :', error);\n\t\t\treturn []\n\t\t}\n\t\treturn []\n\t}\n*/\n\n\n\n\n\tasync fetchItemBarCodes() {\n\t\ttry {\n\t\t\tconst response = await frappe.call({\n\t\t\t\tmethod: 'pos_ar.pos_ar.doctype.pos_info.pos_info.get_item_barcodes',\n\t\t\t\targs: { }\n\t\t\t});\n\t\t\treturn response.message;  // The fetched item barcodes\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching Item Barcodes:', error);\n\t\t\treturn [];\n\t\t}\n\t}\n\n\n\n\tasync fetchItemPrice(since) {\n\t\ttry {\n\t\t\tconst filter = {}\n\t\t\t/*if(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}*/\n\t\t\treturn await frappe.db.get_list('Item Price', {\n\t\t\t\tfields: ['name', 'item_code' , 'item_name' , 'price_list', 'price_list_rate' , 'brand'],\n\t\t\t\tfilters: filter,\n\t\t\t\tlimit : 100000\n\t\t\t})\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching Item Group :', error);\n\t\t\treturn []\n\t\t}\n\t}\n\n\n\tasync fetchPriceList(since) {\n\t\ttry {\n\t\t\tconst filter = {selling : 1}\n\t\t\t/*if(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}*/\n\t\t\treturn await frappe.db.get_list('Price List', {\n\t\t\t\tfields: ['name', 'price_list_name' , 'currency' ],\n\t\t\t\tfilters: filter,\n\t\t\t\tlimit : 100000\n\t\t\t})\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching Item Group :', error);\n\t\t\treturn []\n\t\t}\n\t}\n\n\n\tasync fetchWarehouseList(since){\n\t\ttry{\n\t\t\tconst filter = {}\n\t\t\t/*if(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}*/\n\t\t\treturn await frappe.db.get_list('Warehouse' , {\n\t\t\t\tfields  : ['name' , 'warehouse_name'],\n\t\t\t\tfilters : filter,\n\t\t\t\tlimit : 100000\n\t\t\t})\n\t\t}\n\t\tcatch(error){\n\t\t\tconsole.error('Error fetching Warehouse list : ' , error)\n\t\t\treturn [];\n\t\t}\n\t}\n\n\n\tasync fetchPosProfile(){\n\t\ttry{\n\t\t\tconst filter = {disabled : 0}\n\t\t\t/*if(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}*/\n\t\t\tconst r = await frappe.db.get_doc('POS Profile', null , { disabled:0 } )\n\t\t\treturn r\n\t\t}\n\t\tcatch(error){\n\t\t\tconsole.error('Error fetching pos profile list : ' , error)\n\t\t\treturn null;\n\t\t}\n\t}\n\n\n\t/*async fetchPosProfileModeOfPayments(modeOfPaymentsIds , company){\n\t\ttry{\n\t\t\tconst filter = {disabled : 0}\n\t\t\t//if(since){\n\t\t\t//\tfilter.modified = ['>',since]\n\t\t\t//}\n\t\t\tlet modeOfPayments = []\n\n\t\t\tfor (let i = 0; i < modeOfPaymentsIds.length; i++) {\n\t\t\t\tconst r =  await frappe.db.get_doc('Mode of Payment', modeOfPaymentsIds[i] , { \"company\" : company})\n\t\t\t\tmodeOfPayments.push(r)\n\t\t\t}\n\n\t\t\treturn modeOfPayments\n\t\t}\n\t\tcatch(error){\n\t\t\tconsole.error('Error fetching pos profile list : ' , error)\n\t\t\treturn null;\n\t\t}\n\t}*/\n\n\tasync fetchPosProfileModeOfPayments(modeOfPaymentsIds , company) {\n\t\ttry {\n\t\t\tconst response = await frappe.call({\n\t\t\t\tmethod: 'pos_ar.pos_ar.doctype.pos_info.pos_info.get_mode_of_payments',\n\t\t\t\targs: { }\n\t\t\t});\n\t\t\tconsole.log(\"see :::====> \" , response.message)\n\t\t\treturn response.message;  // The fetched item barcodes\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching mode_of_payments', error);\n\t\t\treturn [];\n\t\t}\n\t}\n\n\n\n\n\tasync fetchCompany(companyId){\n\t\ttry{\n\t\t\treturn await frappe.db.get_doc('Company' , companyId)\n\t\t}\n\t\tcatch(error){\n\t\t\tconsole.error('Error fetching company by companyId from the profile list : ' , error)\n\t\t\treturn [];\n\t\t}\n\t}\n\n\tasync fetchSalesTaxesAndChargesTemplate(templateId){\n\t\ttry{\n\t\t\treturn await frappe.db.get_doc('Sales Taxes and Charges Template' , templateId)\n\t\t}\n\t\tcatch(error){\n\t\t\tconsole.error('Error fetching Warehouse list : ' , error)\n\t\t\treturn [];\n\t\t}\n\t}\n\n\tasync fetchBinList(since){\n\t\ttry{\n\t\t\tconst filter = {}\n\t\t\t/*if(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}*/\n\t\t\treturn await frappe.db.get_list('Bin' , {\n\t\t\t\tfields  : ['name' , 'actual_qty' , 'item_code' , 'warehouse'],\n\t\t\t\tfilters : filter,\n\t\t\t\tlimit   : 1\n\t\t\t})\n\t\t}\n\t\tcatch(error){\n\t\t\tconsole.error('Error fetching Bin list : ' , error)\n\t\t\treturn [];\n\t\t}\n\t}\n\n\tasync fetchDeletedDocs(since) {\n\t\ttry {\n\t\t\tconst filter = {}\n\t\t\tif(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}\n\t\t\treturn await frappe.db.get_list('Deleted Document', {\n\t\t\t\tfields: ['name', 'deleted_name'  ,'deleted_doctype' , 'restored' ],\n\t\t\t\tfilters: filter,\n\t\t\t\tlimit : 100000\n\t\t\t})\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching deleted documents :', error);\n\t\t\treturn []\n\t\t}\n\t\treturn []\n\t}\n\n\n}\n", "\npos_ar.PointOfSale.pos_debt_cart = class{\n\n\tconstructor(\n\t\twrapper\n\t){\n\t\tthis.wrapper = wrapper\n\t\tthis.start_work()\n\t}\n\n\tstart_work(){\n\t\tconsole.log(\"hello from pos_debt_cart\")\n\t\tthis.prepare_cart()\n\n\t}\n\n\tprepare_cart(){\n\t\tthis.wrapper.find('#LeftSection').append('<div id=\"debtLeftContainer\" class=\"columnBox\"></div>')\n\t\tthis.wrapper.find('#RightSection').append('<div id=\"debtRightContainer\" class=\"columnBox\"></div>')\n\n\t\tthis.leftContainer  = this.wrapper.find('#debtLeftContainer')\n\t\tthis.rightContainer = this.wrapper.find('#debtRightContainer')\n\t}\n\tshowCart(){\n\t\tconsole.log(\"showing ...\")\n\t\tthis.leftContainer.css('display' , 'flex')\n\t\tthis.rightContainer.css('display' , 'flex')\n\t}\n\thideCart(){\n\t\tconsole.log(\"hiding ...\")\n\t\tthis.leftContainer.css('display' , 'none')\n\t\tthis.rightContainer.css('display' , 'none')\n\t}\n\n}\n"],
  "mappings": "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",
  "names": ["wrapper", "err", "new_pos_invoice", "date", "year", "month", "day", "hour", "minutes", "seconds", "user", "posProfile", "r", "error", "me", "table_fields", "dialog", "d", "fetch_pos_payment_methods", "pos_profile", "payments", "pay", "mode_of_payment", "pos_profile_query", "company", "balance_details", "method", "res", "item", "tab", "action", "key", "event", "field", "value", "itemCloned", "clonedItem", "checkInOut", "settingName", "saveWithZeroRate", "menu", "result", "counter", "message", "oldRate", "persont", "montant", "persent", "_a", "newValue", "posItems", "newVal", "input", "discount_percentage", "newRate", "items", "newItem", "status", "pos", "tabs", "failure", "seccess", "allUnsyncedPos", "updatedPos", "netTotal", "grandTotal", "allTaxes", "discount", "tax", "voucher", "check", "child", "active", "lastValue", "priceList", "mode", "price", "itemPrice", "reg", "clickedItem", "exist", "clone", "itemId", "posInvoice", "itemName", "qty", "rate", "discountPercentage", "discountAmount", "paidAmountDA", "wrapper", "item_list", "itemBarcodes", "item_group_list", "item_prices", "settingsData", "selectedPriceList", "getItemPrice", "autoSelect", "onItemClick", "groupItemList_html", "group_item", "option", "seachField", "groupItemListInput", "filtered_item_list", "itemsContainer_html", "i", "item", "itemBox", "event", "itemImage", "itemImageHolder", "firstLatter", "itemName", "price", "even", "value", "barcodeItemIds", "BarCode", "cod", "itemInput", "item_group", "groups", "getChild", "grp", "g", "filtredItemList", "getFiltredItems", "group", "wrapper", "customersList", "selectedCustomer", "backHome", "onSync", "saveCheckInOut", "onMenuClick", "onDebtClick", "event", "checkInOut", "counter", "wrapper", "settingsData", "selectedItemMaps", "priceLists", "customerList", "brandList", "salesTaxes", "invoiceData", "selectedTab", "selectedItem", "selectedField", "getItemPrice", "onSelectedItemClick", "onTabClick", "onKeyPressed", "createNewTab", "onCheckoutClick", "tax", "taxContainer", "event", "priceList", "customer", "key", "clickedTab", "selectedItemsContainer", "item", "itemElement", "leftGroup", "rightGroup", "itemName", "itemQuantity", "itemPrice", "itemImage", "itemImageHolder", "itemImageLatter", "orientation", "discount", "quantity", "netTotal", "grandTotal", "quantityButton", "rateButton", "discountButton", "key_0", "key_1", "key_2", "key_3", "key_4", "key_5", "key_6", "key_7", "key_8", "key_9", "key_quantity", "key_discount", "key_rate", "key_remove", "key_delete", "key_point", "keyContent", "netTotal_HTML", "saleTaxAmount", "taxPercentage", "calculatedTax", "tax_HTML", "result", "totalQuantity_HTML", "taxAmount", "grandTotal_HTML", "wrapper", "warehouse", "priceLists", "itemPrices", "binList", "selectedItem", "selectedField", "onInput", "onClose", "event", "item", "_a", "_b", "imageContainer", "name", "itemGroup", "quantity", "rate", "discountedRate", "discount_percentage", "discount_amount", "available", "uom", "priceList", "priceListRate", "image", "field", "value", "index", "currentValue", "newValue", "cursor", "newQuantity", "newRate", "newDiscount", "itemId", "price", "itemPrice", "warehouseId", "bin", "wrapper", "selectedItemMap", "selectedTab", "appData", "paymentMethods", "selectedPaymentMythod", "invoiceData", "onClose", "onComplete", "onInput", "event", "method", "selected", "amountField", "selectedBox", "mode", "me", "clickedId", "inputValue", "boxId", "key", "cashField", "newValue", "cursor", "index", "currentValue", "paidAmountDA", "id", "r", "wrapper", "db", "selectedPosProfile", "company", "salesTaxes", "onClick", "result", "pos", "record", "_a", "posContainer", "l1", "posName", "posCost", "l2", "customer", "customerLogo", "customerName", "creationTime", "_b", "_c", "item", "netTotal", "allTax", "tax", "payments", "method", "filter", "error", "event", "taxes", "grandTotal", "creation_time", "date", "time", "invoiceHTML", "printWindow", "db", "resolve", "reject", "request", "event", "_a", "store", "itemList", "transaction", "item", "err", "result", "value", "posProfileList", "posProfile", "binList", "bin", "warehouseList", "warehouse", "priceLists", "priceList", "itemPriceList", "itemPrice", "itemGroupList", "itemGroup", "customerList", "customer", "posInvoice", "onSuccess", "onFailure", "filtredResult", "invoice", "invoiceName", "checkInOut", "settings", "__spreadValues", "wrapper", "settingsData", "selectedPosProfile", "onSettingsChange", "priceBase", "showItemDetailsCart", "showItemImage", "showDiscountField", "searchByGroup", "base", "event", "tabs", "all_content", "tab", "index", "wrapper", "db", "header", "details", "item", "checkInOut", "checkInOutObject", "type_div", "type_img", "type_value_div", "creationTimeDiv", "amountDiv", "inAmount", "outAmount", "allAmount", "event", "res", "err", "db", "res", "err", "base", "onSuccess", "onFailure", "show", "settings", "db", "apiHandler", "err", "localCustomers", "updatedCustomers", "localItems", "updatedItems", "posProfile", "modeOfPaymentsIds", "modeId", "localBins", "updatedBins", "localWarehouses", "updatedWarehouses", "localPriceLists", "updatedPriceList", "localItemPrices", "updateItemPrices", "localItemGroups", "updatedItemGroups", "checkInOut", "onSuccess", "onFailure", "posInvoice", "res", "local", "updated", "combinedMap", "item", "deleted", "updatedItem", "since", "filter", "error", "modeOfPaymentsIds", "company", "response", "companyId", "templateId", "wrapper"]
}
