{
  "version": 3,
  "sources": ["../../../../../apps/pos_ar/pos_ar/pos_ar/page/pricing/PricingController.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pricing/remote/fetcher.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/posController.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_item_selector.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_customer_box.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_selected_item_cart.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_item_details.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_payment_cart.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_history.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_db.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_settings.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_check_in_out.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_debt_cart.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/pos_unsynced_cart.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/data/posSettingsData.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/data/posAppData.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/remoteApi/FetchHandler.js", "../../../../../apps/pos_ar/pos_ar/pos_ar/page/pos/manager/ScreenManager.js"],
  "sourcesContent": ["frappe.provide(\"pos_ar.Pricing\");\r\n\r\npos_ar.Pricing.PricingController = class {\r\n    constructor(wrapper) {\r\n        this.wrapper = $(wrapper).find(\".layout-main-section\");\r\n        this.current_screen = 'pricing'; // Default screen\r\n        this.fetcher = new pos_ar.Pricing.PricingFetcher();\r\n        this.setup_page();\r\n        this.add_style();\r\n        this.setup_events();\r\n        this.load_companies();\r\n    }\r\n\r\n    setup_page() {\r\n        this.page_content = $(`\r\n            <div class=\"pricing-container\">\r\n                <!-- Top App Bar -->\r\n                <div class=\"pricing-top-bar\">\r\n                    <div class=\"top-bar-left\">\r\n                        <h2>Pricing Management</h2>\r\n                    </div>\r\n                    <div class=\"top-bar-filters\">\r\n                        <div class=\"filter-item\">\r\n                            <select class=\"form-control company-filter\" placeholder=\"Company\">\r\n                            </select>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"top-bar-right\">\r\n                        <button class=\"btn btn-primary\">New Price</button>\r\n                        <button class=\"btn btn-default\">Import</button>\r\n                        <button class=\"btn btn-default\">Export</button>\r\n                    </div>\r\n                </div>\r\n\r\n                <!-- Main Content Area with Sidebar -->\r\n                <div class=\"pricing-main-content\">\r\n                    <!-- Sidebar Navigation -->\r\n                    <div class=\"pricing-sidebar\">\r\n                        <div class=\"sidebar-nav\">\r\n                            <div class=\"nav-item active\" data-screen=\"pricing\">\r\n                                <i class=\"fa fa-tag\"></i>\r\n                                <span>Pricing</span>\r\n                            </div>\r\n                            <div class=\"nav-item\" data-screen=\"fixing\">\r\n                                <i class=\"fa fa-wrench\"></i>\r\n                                <span>Fixing</span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <!-- Content Area -->\r\n                    <div class=\"pricing-content\">\r\n                        <div class=\"screen pricing-screen active\">\r\n                            <!-- Pricing screen content will be loaded here -->\r\n                        </div>\r\n                        <div class=\"screen fixing-screen\">\r\n                            <!-- Fixing screen content will be loaded here -->\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        `).appendTo(this.wrapper);\r\n    }\r\n\r\n    setup_events() {\r\n        // Handle navigation clicks\r\n        this.wrapper.find('.nav-item').on('click', (e) => {\r\n            const screen = $(e.currentTarget).data('screen');\r\n            this.switch_screen(screen);\r\n        });\r\n\r\n        // Handle company filter change\r\n        this.wrapper.find('.company-filter').on('change', (e) => {\r\n            const company = $(e.currentTarget).val();\r\n            this.filter_by_company(company);\r\n        });\r\n    }\r\n\r\n    switch_screen(screen) {\r\n        // Update navigation active state\r\n        this.wrapper.find('.nav-item').removeClass('active');\r\n        this.wrapper.find(`.nav-item[data-screen=\"${screen}\"]`).addClass('active');\r\n\r\n        // Update screen visibility\r\n        this.wrapper.find('.screen').removeClass('active');\r\n        this.wrapper.find(`.${screen}-screen`).addClass('active');\r\n\r\n        this.current_screen = screen;\r\n    }\r\n\r\n    load_companies() {\r\n        frappe.call({\r\n            method: 'frappe.client.get_list',\r\n            args: {\r\n                doctype: 'Company',\r\n                fields: ['name', 'company_name'],\r\n                order_by: 'company_name asc'\r\n            },\r\n            callback: (response) => {\r\n                if (response.message) {\r\n                    const companies = response.message;\r\n                    const $companyFilter = this.wrapper.find('.company-filter');\r\n                    $companyFilter.empty();\r\n                    \r\n                    // Add companies without a default option\r\n                    companies.forEach(company => {\r\n                        $companyFilter.append(`<option value=\"${company.name}\">${company.company_name}</option>`);\r\n                    });\r\n\r\n                    // Set default company if available\r\n                    if (frappe.defaults.get_default('company')) {\r\n                        $companyFilter.val(frappe.defaults.get_default('company'));\r\n                    }\r\n\r\n                    // Initialize select2 with placeholder\r\n                    $companyFilter.select2({\r\n                        placeholder: 'Company',\r\n                        allowClear: true\r\n                    });\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    filter_by_company(company) {\r\n        if (this.current_screen === 'pricing') {\r\n            this.load_pricing_data(company);\r\n        } else if (this.current_screen === 'fixing') {\r\n            this.load_fixing_data(company);\r\n        }\r\n    }\r\n\r\n    async load_pricing_data(company) {\r\n        if (!company) return;\r\n        \r\n        try {\r\n            const result = await this.fetcher.fetchItemPrices(company);\r\n            const data = result.prices;\r\n            const price_lists = result.price_lists;\r\n            const brands = result.brands;\r\n            this.render_pricing_data(data, price_lists, brands);\r\n        } catch (error) {\r\n            frappe.msgprint({\r\n                title: __('Error'),\r\n                indicator: 'red',\r\n                message: __('Failed to load item prices')\r\n            });\r\n            console.error('Error loading item prices:', error);\r\n        }\r\n    }\r\n\r\n    render_pricing_data(data, price_lists, brands) {\r\n        const $pricingScreen = this.wrapper.find('.pricing-screen');\r\n        $pricingScreen.empty();\r\n\r\n        if (!data || data.length === 0) {\r\n            $pricingScreen.html(`\r\n                <div class=\"no-data-state\">\r\n                    <div class=\"no-data-icon\">\r\n                        <i class=\"fa fa-tag\"></i>\r\n                    </div>\r\n                    <div class=\"no-data-message\">\r\n                        No item prices found for this company\r\n                    </div>\r\n                </div>\r\n            `);\r\n            return;\r\n        }\r\n        \r\n        // Create a map for quick price lookup\r\n        const priceMap = {};\r\n        data.forEach(item => {\r\n            const key = `${item.brand || 'No Brand'}_${item.price_list}`;\r\n            priceMap[key] = {\r\n                price: item.price_list_rate,\r\n                item_code: item.item_code\r\n            };\r\n        });\r\n\r\n        const $content = $(`\r\n            <div class=\"pricing-data\">\r\n                <div class=\"pricing-table\">\r\n                    <table class=\"table table-bordered\">\r\n                        <thead>\r\n                            <tr>\r\n                                <th>Brand</th>\r\n                                ${price_lists.map(pl => `\r\n                                    <th>${pl.name}</th>\r\n                                `).join('')}\r\n                            </tr>\r\n                        </thead>\r\n                        <tbody>\r\n                            ${brands.map(brand => `\r\n                                <tr>\r\n                                    <td>${brand.name}</td>\r\n                                    ${price_lists.map(pl => {\r\n                                        const priceData = priceMap[`${brand.name}_${pl.name}`] || {};\r\n                                        return `\r\n                                            <td>\r\n                                                ${priceData.price ? \r\n                                                    `<div>\r\n                                                        ${frappe.format(priceData.price, {fieldtype: 'Currency'})}\r\n                                                        <button class=\"btn btn-xs btn-default edit-price ml-2\" \r\n                                                                data-item=\"${priceData.item_code}\">\r\n                                                            <i class=\"fa fa-pencil\"></i>\r\n                                                        </button>\r\n                                                    </div>`\r\n                                                    : '-'\r\n                                                }\r\n                                            </td>\r\n                                        `;\r\n                                    }).join('')}\r\n                                </tr>\r\n                            `).join('')}\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n        `);\r\n\r\n        // Add some custom styles for the matrix layout\r\n        const style = $(`\r\n            <style>\r\n                .pricing-table table {\r\n                    width: 100%;\r\n                    border-collapse: collapse;\r\n                }\r\n                .pricing-table th, .pricing-table td {\r\n                    text-align: center;\r\n                    padding: 8px;\r\n                }\r\n                .pricing-table th:first-child, \r\n                .pricing-table td:first-child {\r\n                    text-align: left;\r\n                    font-weight: bold;\r\n                }\r\n                .pricing-table td div {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    justify-content: center;\r\n                    gap: 8px;\r\n                }\r\n                .edit-price {\r\n                    padding: 2px 6px;\r\n                }\r\n            </style>\r\n        `);\r\n\r\n        // Add event handlers for the edit buttons\r\n        $content.find('.edit-price').on('click', (e) => {\r\n            const itemCode = $(e.currentTarget).data('item');\r\n            this.show_price_editor(itemCode);\r\n        });\r\n\r\n        $pricingScreen.html($content);\r\n        $pricingScreen.append(style);\r\n    }\r\n\r\n    show_price_editor(itemCode) {\r\n        // Implementation for price editor dialog\r\n        frappe.prompt([\r\n            {\r\n                label: 'New Price',\r\n                fieldname: 'price',\r\n                fieldtype: 'Currency',\r\n                reqd: 1\r\n            }\r\n        ], (values) => {\r\n            // Here you would implement the price update logic\r\n            frappe.show_alert({\r\n                message: __('Price updated successfully'),\r\n                indicator: 'green'\r\n            });\r\n        }, __('Update Price'), __('Update'));\r\n    }\r\n\r\n    load_fixing_data(company) {\r\n        // To be implemented based on your specific requirements\r\n        console.log('Loading fixing data for company:', company);\r\n    }\r\n\r\n    add_style() {\r\n        this.wrapper.append('<link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/pos_ar/css/pricing_page/main.css\">');\r\n        \r\n        const style = `\r\n            <style>\r\n                :root {\r\n                    --primary-color: #4f46e5;\r\n                    --primary-hover: #4338ca;\r\n                    --bg-color: #f8fafc;\r\n                    --surface-color: #ffffff;\r\n                    --text-primary: #1e293b;\r\n                    --text-secondary: #64748b;\r\n                    --border-color: #e2e8f0;\r\n                }\r\n\r\n                .pricing-container {\r\n                    display: flex;\r\n                    flex-direction: column;\r\n                    height: 100vh;\r\n                    overflow: hidden;\r\n                    background: var(--bg-color);\r\n                    padding: 1.5rem;\r\n                    gap: 1.5rem;\r\n                }\r\n\r\n                .pricing-top-bar {\r\n                    display: flex;\r\n                    justify-content: space-between;\r\n                    align-items: center;\r\n                    padding: 1rem 1.5rem;\r\n                    background: var(--surface-color);\r\n                    border-radius: 1rem;\r\n                    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1);\r\n                    gap: 2rem;\r\n                }\r\n\r\n                .top-bar-left h2 {\r\n                    font-size: 1.5rem;\r\n                    font-weight: 600;\r\n                    color: var(--text-primary);\r\n                    margin: 0;\r\n                    letter-spacing: -0.025em;\r\n                }\r\n\r\n                .top-bar-filters {\r\n                    display: flex;\r\n                    gap: 1rem;\r\n                    flex: 1;\r\n                    position: relative;\r\n                }\r\n\r\n                .filter-item {\r\n                    min-width: 240px;\r\n                    position: relative;\r\n                }\r\n\r\n                .filter-item::before {\r\n                    content: '';\r\n                    position: absolute;\r\n                    inset: 0;\r\n                    border-radius: 14px;\r\n                    padding: 2px;\r\n                    background: linear-gradient(135deg, var(--primary-color), #818cf8);\r\n                    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);\r\n                    mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);\r\n                    -webkit-mask-composite: xor;\r\n                    mask-composite: exclude;\r\n                    opacity: 0;\r\n                    transition: opacity 0.3s;\r\n                }\r\n\r\n                .filter-item:hover::before {\r\n                    opacity: 0.5;\r\n                }\r\n\r\n                .filter-item .select2-container {\r\n                    width: 100% !important;\r\n                }\r\n\r\n                .filter-item .select2-container .select2-selection--single {\r\n                    height: 48px;\r\n                    background: var(--surface-color);\r\n                    border: 1px solid var(--border-color);\r\n                    border-radius: 14px;\r\n                    display: flex;\r\n                    align-items: center;\r\n                    transition: all 0.2s;\r\n                    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.02);\r\n                }\r\n\r\n                .filter-item .select2-container .select2-selection--single:hover {\r\n                    border-color: var(--text-secondary);\r\n                    transform: translateY(-1px);\r\n                }\r\n\r\n                .filter-item .select2-container.select2-container--focus .select2-selection--single {\r\n                    border-color: var(--primary-color);\r\n                    box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.15);\r\n                }\r\n\r\n                .filter-item .select2-container .select2-selection--single .select2-selection__rendered {\r\n                    line-height: 48px;\r\n                    padding: 0 1.25rem;\r\n                    color: var(--text-primary);\r\n                    font-weight: 500;\r\n                    font-size: 0.9375rem;\r\n                }\r\n\r\n                .filter-item .select2-container .select2-selection--single .select2-selection__placeholder {\r\n                    color: var(--text-secondary);\r\n                    font-weight: 400;\r\n                }\r\n\r\n                .filter-item .select2-container .select2-selection--single .select2-selection__arrow {\r\n                    height: 48px;\r\n                    width: 48px;\r\n                    position: absolute;\r\n                    right: 0;\r\n                    display: flex;\r\n                    align-items: center;\r\n                    justify-content: center;\r\n                }\r\n\r\n                .filter-item .select2-container .select2-selection--single .select2-selection__arrow b {\r\n                    display: none;\r\n                }\r\n\r\n                .filter-item .select2-container .select2-selection--single .select2-selection__arrow::after {\r\n                    content: '';\r\n                    width: 10px;\r\n                    height: 10px;\r\n                    border: 2px solid var(--text-secondary);\r\n                    border-left: 0;\r\n                    border-top: 0;\r\n                    transform: rotate(45deg) translateY(-2px);\r\n                    transition: all 0.2s;\r\n                }\r\n\r\n                .filter-item .select2-container.select2-container--open .select2-selection--single .select2-selection__arrow::after {\r\n                    transform: rotate(-135deg) translateY(-2px);\r\n                    border-color: var(--primary-color);\r\n                }\r\n\r\n                /* Select2 Dropdown Styling */\r\n                .select2-dropdown {\r\n                    background: var(--surface-color);\r\n                    border: 1px solid var(--border-color);\r\n                    border-radius: 14px;\r\n                    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);\r\n                    overflow: hidden;\r\n                    margin-top: 12px;\r\n                    transform-origin: top;\r\n                    animation: dropdownIn 0.2s ease-out;\r\n                }\r\n\r\n                @keyframes dropdownIn {\r\n                    from {\r\n                        opacity: 0;\r\n                        transform: translateY(-10px) scale(0.98);\r\n                    }\r\n                    to {\r\n                        opacity: 1;\r\n                        transform: translateY(0) scale(1);\r\n                    }\r\n                }\r\n\r\n                .select2-container--default .select2-search--dropdown {\r\n                    padding: 12px 12px 8px;\r\n                    background: var(--surface-color);\r\n                    border-bottom: 1px solid var(--border-color);\r\n                }\r\n\r\n                .select2-search__field {\r\n                    height: 44px !important;\r\n                    border: 1px solid var(--border-color) !important;\r\n                    border-radius: 10px !important;\r\n                    padding: 0 1.25rem !important;\r\n                    margin: 0 !important;\r\n                    background: var(--bg-color) !important;\r\n                    color: var(--text-primary) !important;\r\n                    font-size: 0.9375rem !important;\r\n                    transition: all 0.2s !important;\r\n                }\r\n\r\n                .select2-search__field:focus {\r\n                    border-color: var(--primary-color) !important;\r\n                    outline: none !important;\r\n                    box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.15) !important;\r\n                }\r\n\r\n                .select2-results {\r\n                    padding: 8px;\r\n                }\r\n\r\n                .select2-results__options {\r\n                    max-height: 300px;\r\n                    padding: 4px;\r\n                }\r\n\r\n                .select2-results__option {\r\n                    padding: 12px 16px !important;\r\n                    border-radius: 10px;\r\n                    margin-bottom: 4px;\r\n                    color: var(--text-primary);\r\n                    font-weight: 500;\r\n                    transition: all 0.15s;\r\n                    position: relative;\r\n                    cursor: pointer;\r\n                }\r\n\r\n                .select2-results__option:last-child {\r\n                    margin-bottom: 0;\r\n                }\r\n\r\n                .select2-results__option--highlighted {\r\n                    background: rgba(79, 70, 229, 0.08) !important;\r\n                    color: var(--primary-color) !important;\r\n                }\r\n\r\n                .select2-results__option[aria-selected=true] {\r\n                    background: var(--primary-color) !important;\r\n                    color: white !important;\r\n                }\r\n\r\n                .select2-results__option[aria-selected=true]::before {\r\n                    content: '\u2713';\r\n                    position: absolute;\r\n                    right: 16px;\r\n                    top: 50%;\r\n                    transform: translateY(-50%);\r\n                    font-size: 1.1em;\r\n                }\r\n\r\n                .top-bar-right {\r\n                    display: flex;\r\n                    gap: 0.75rem;\r\n                }\r\n\r\n                .btn {\r\n                    height: 42px;\r\n                    padding: 0 1.5rem;\r\n                    border-radius: 0.75rem;\r\n                    font-weight: 500;\r\n                    transition: all 0.2s;\r\n                    display: inline-flex;\r\n                    align-items: center;\r\n                    justify-content: center;\r\n                    gap: 0.5rem;\r\n                }\r\n\r\n                .btn-primary {\r\n                    background: var(--primary-color);\r\n                    color: white;\r\n                    border: none;\r\n                }\r\n\r\n                .btn-primary:hover {\r\n                    background: var(--primary-hover);\r\n                    transform: translateY(-1px);\r\n                }\r\n\r\n                .btn-default {\r\n                    background: var(--surface-color);\r\n                    border: 1px solid var(--border-color);\r\n                    color: var(--text-primary);\r\n                }\r\n\r\n                .btn-default:hover {\r\n                    border-color: var(--text-secondary);\r\n                    transform: translateY(-1px);\r\n                }\r\n\r\n                .pricing-main-content {\r\n                    display: flex;\r\n                    flex: 1;\r\n                    gap: 1.5rem;\r\n                    height: calc(100vh - 120px);\r\n                    overflow: hidden;\r\n                }\r\n\r\n                .pricing-sidebar {\r\n                    width: 280px;\r\n                    background: var(--surface-color);\r\n                    border-radius: 1rem;\r\n                    padding: 1.25rem 1rem;\r\n                    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1);\r\n                }\r\n\r\n                .sidebar-nav {\r\n                    display: flex;\r\n                    flex-direction: column;\r\n                    gap: 0.5rem;\r\n                }\r\n\r\n                .nav-item {\r\n                    display: flex;\r\n                    align-items: center;\r\n                    gap: 0.75rem;\r\n                    padding: 0.875rem 1rem;\r\n                    border-radius: 0.75rem;\r\n                    cursor: pointer;\r\n                    transition: all 0.15s;\r\n                    color: var(--text-secondary);\r\n                }\r\n\r\n                .nav-item:hover {\r\n                    color: var(--text-primary);\r\n                    background: var(--bg-color);\r\n                }\r\n\r\n                .nav-item.active {\r\n                    color: var(--primary-color);\r\n                    background: rgba(79, 70, 229, 0.1);\r\n                    font-weight: 500;\r\n                }\r\n\r\n                .nav-item i {\r\n                    font-size: 1.25rem;\r\n                    width: 24px;\r\n                }\r\n\r\n                .pricing-content {\r\n                    flex: 1;\r\n                    background: var(--surface-color);\r\n                    border-radius: 1rem;\r\n                    padding: 1.5rem;\r\n                    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1), 0 1px 2px -1px rgba(0, 0, 0, 0.1);\r\n                    overflow-y: auto;\r\n                }\r\n\r\n                .screen {\r\n                    display: none;\r\n                }\r\n\r\n                .screen.active {\r\n                    display: block;\r\n                }\r\n\r\n                /* Custom scrollbar */\r\n                .pricing-content::-webkit-scrollbar {\r\n                    width: 6px;\r\n                }\r\n\r\n                .pricing-content::-webkit-scrollbar-track {\r\n                    background: transparent;\r\n                }\r\n\r\n                .pricing-content::-webkit-scrollbar-thumb {\r\n                    background: var(--border-color);\r\n                    border-radius: 3px;\r\n                }\r\n\r\n                .pricing-content::-webkit-scrollbar-thumb:hover {\r\n                    background: var(--text-secondary);\r\n                }\r\n            </style>\r\n        `;\r\n        this.wrapper.append(style);\r\n    }\r\n};\r\n", "pos_ar.Pricing.PricingFetcher = class {\r\n\r\n    constructor(){\r\n        console.log(\"PricingFetcher initialized\");\r\n    }\r\n\r\n\r\n\tasync fetchItemPrices( company ) {\r\n\t\ttry {\r\n\t\t\tconst response = await frappe.call({\r\n\t\t\t\tmethod: 'pos_ar.pos_ar.doctype.pos_info.pos_info.get_item_prices',\r\n\t\t\t\targs: { company }\r\n\t\t\t});\r\n\t\t\tconsole.log(\"fetched item prices\" , response.message);\r\n\t\t\treturn response.message || [];  // The fetched item prices\r\n\t\t} catch (error) {\r\n\t\t\tconsole.error('Error fetching item prices:', error);\r\n\t\t\treturn [];\r\n\t\t}\r\n\t}\r\n\r\n\r\n}", "pos_ar.PointOfSale.Controller = class {\n        constructor(wrapper) {\n\t\t//principales variable\n\t        this.wrapper = $(wrapper).find(\".layout-main-section\");\n\t        this.page    = wrapper.page ;\n\n\n\t        this.selectedItemMaps  = new Map()\n\n\t        this.selectedItem               = {\"name\"       : \"\"   }\n        \tthis.selectedField              = {\"field_name\" : \"\"   }\n  \t\tthis.selectedTab                = {\"tabName\"    : \"\"   }\n\t\tthis.selectedPaymentMethod      = {\"methodName\" : \"\"   }\n\t\tthis.defaultCustomer            = {\"name\"       : \"\" , \"customer_name\" : \"\"}\n\t\tthis.defaultPriceList           = {\"name\"       : \"\"   }\n\t\tthis.taxes_and_charges_template = null;\n\t\tthis.taxes_and_charges          = [];\n\t\tthis.payment_methods            = []\n\n\t\t//sell invoice\n\t\tthis.POSOpeningEntry = {}\n\n\t\tthis.invoiceData = { netTotal : 0 , grandTotal : 0 , paidAmount : 0 , toChange : 0 , discount : 0}\n\t\tthis.db          = null;\n\n\t\tthis.syncInput = false\n\n\n\t\tfrappe.db.get_list('Customer' , {\n\t\t\tfilters : { custom_company : 'Optilens BISKRA' } ,\n\t\t\tfields  : ['name'],\n\t\t}).then( record => {\n\t\t\t\tconsole.log(\" customers ::: \" ,record)\n\t\t})\n\n\n\n        \tthis.start_app();\n        }\n\n\t async start_app(){\n\t\ttry{\n\t\t\t//init db\n\t\t\tthis.db            = await pos_ar.PointOfSale.pos_db.openDatabase();\n\t\t\t//data classes\n\t\t\tthis.settings_data = new pos_ar.PointOfSale.posSettingsData(this.db)\n\t\t\t//api fetch handler\n\t\t\tthis.dataHandler   = new pos_ar.PointOfSale.FetchHandler()\n\t\t\t//local app data\n\t\t\tthis.appData       = new pos_ar.PointOfSale.posAppData(this.db , this.dataHandler)\n\t\t\tawait this.appData.getAllData()\n\t\t\t\n\t\t\t//init screen manager\n\t\t\tthis.screenManager = new pos_ar.PointOfSale.ScreenManager(this.settings_data);\n\n\t\t\tthis.toggleKeyboardMode(!this.settings_data.settings.showItemDetails);\n\n\t\t\tthis.prepare_container();\n\t\t\t//prepare app data\n\t\t\tawait  this.prepare_app_data();\n\n\t\t\t//proceed with other initialization only if app data are set correctly\n\t\t\tawait  this.checkForPOSEntry()\n\t\t\tawait  this.prepare_components();\n\t\t\tthis.checkUnSyncedPos();\n\t\t\tthis.setListeners();\n\n\t\t\tconst openedPos = await this.appData.getAllOpenedPosInvoice()\n\t\t\tthis.restorePosInvoices(openedPos)\n\n\t\t}catch(err){\n\t\t\tconsole.error(\"halfware POS Err ==> \" , err)\n\t\t}\n\t}\n\n\tasync prepare_app_data(){\n\t\ttry{\n\n\t\t\tawait this.handleAppData();\n\n\n\t\t\tlet priceList = this.getCustomerDefaultPriceList(this.defaultCustomer.name)\n\t\t\tif( priceList == \"\" || priceList  == null || priceList  == undefined){\n\t\t\t\tpriceList = this.defaultPriceList.name\n\t\t\t}\n\n\n\t\t\tlet new_pos_invoice               = frappe.model.get_new_doc('POS Invoice');\n\t\t\tnew_pos_invoice.customer          = this.defaultCustomer.name\n\t\t\tnew_pos_invoice.pos_profile       = this.appData.appData.pos_profile.name\n\t\t\tnew_pos_invoice.items             = [];\n\t\t\tnew_pos_invoice.taxes_and_charges = this.appData.appData.pos_profile.taxes_and_charges\n\t\t\tnew_pos_invoice.additional_discount_percentage = 0\n\t\t\tnew_pos_invoice.paid_amount       = 0\n\t\t\tnew_pos_invoice.base_paid_amount  = 0\n\t\t\tnew_pos_invoice.creation_time     = frappe.datetime.now_datetime()\n\t\t\tnew_pos_invoice.payments          = this.getPaymentMethods()\n\t\t\tnew_pos_invoice.is_pos            = 1\n\t\t\tnew_pos_invoice.update_stock      = 1\n\t\t\tnew_pos_invoice.docstatus         = 0\n\t\t\tnew_pos_invoice.status            = 'Draft'\n\t\t\tnew_pos_invoice.priceList         = priceList\n\t\t\tnew_pos_invoice.opened            = 1\n\t\t\t//build refNm   posProfile-date-time\n\t\t\tconst date = new Date()\n\t\t\tconst [year,month,day] = date.toISOString().split('T')[0].split('-')\n\t\t\tconst hour    = date.getHours()\n\t\t\tconst minutes = date.getMinutes()\n\t\t\tconst seconds = date.getMilliseconds()\n\t\t\tnew_pos_invoice.refNum            = this.appData.appData.pos_profile.name+\"-\"+year+'-'+month+'-'+day+'-'+hour+minutes+seconds\n\t\t\tnew_pos_invoice.custom_cach_name  = new_pos_invoice.refNum\n\n\t\t\tthis.selectedItemMaps.set(\"C1\" , new_pos_invoice)\n\t\t\tthis.selectedTab.tabName = `C1`\n\n\t\t}catch(err){\n\t\t\tconsole.error(\"Hlafware POS Error ==> \" , err)\n\t\t\tthrow err;\n\t\t}\n\n    }\n\n\n\tasync handleAppData(){\n\t\t//check pos profile\n\t\tif(this.appData.appData.pos_profile  == null ){\n\t\t\tfrappe.set_route(\"Form\", \"POS Profile\");\n\t\t\tthrow new Error(\"there is no pos profile\")\n\t\t}\n\n\t\t//check takes and get it if it exist on pos profile\n\t\tif(this.appData.appData.pos_profile.taxes_and_charges != null && this.appData.appData.pos_profile.taxes_and_charges != \"\"){\n\t\t\tthis.taxes_and_charges_template = await this.dataHandler.fetchSalesTaxesAndChargesTemplate(this.appData.appData.pos_profile.taxes_and_charges)\n\t\t\tthis.taxes_and_charges = this.taxes_and_charges_template.taxes\n\t\t}\n\t\t//check company and get it if it exist on pos profile\n\t\tif(this.appData.appData.pos_profile.company != null && this.appData.appData.pos_profile.company != ''){\n\t\t\tthis.company = await this.dataHandler.fetchCompany(this.appData.appData.pos_profile.company)\n\t\t}\n\n\t\t//check customer\n\t\tif(this.appData.appData.customers.length > 0){\n\t\t\tthis.defaultCustomer = structuredClone(this.appData.appData.customers[0])\n\t\t}else{\n\t\t\tfrappe.warn(\n\t\t\t\t\t'You dont have a customer',\n\t\t\t\t\t'please create a customer to continue',\n\t\t\t\t\t()=>{\n\t\t\t\t\t\tfrappe.set_route(\"Form\", \"Customer\");\n\t\t\t\t\t},\n\t\t\t\t\t'Create',\n\t\t\t\t\tfalse\n\t\t\t)\n\t\t\tthrow new Error(\"there is no customer\")\n\t\t}\n\t\t//check price list\n\t\tif(this.appData.appData.price_lists.length > 0){\n\t\t\tthis.defaultPriceList.name = this.appData.appData.pos_profile.selling_price_list\n\t\t}else{\n\t\t\tfrappe.warn(\n\t\t\t\t\t'You dont have a single price list',\n\t\t\t\t\t'please create a priceList to continue',\n\t\t\t\t\t()=>{\n\t\t\t\t\t\tfrappe.set_route(\"Form\", \"Price List\");\n\t\t\t\t\t},\n\t\t\t\t\t'Create',\n\t\t\t\t\tfalse\n\t\t\t)\n\t\t\tthrow new Error(\"there is no price list\")\n\t\t}\n\t}\n\n    /***********************  ui ******************************************/\n\n    prepare_container(){\n            //append css styles\n            this.wrapper.append('<link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/pos_ar/css/selectorBox.css\">')\n            this.wrapper.append('<link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/pos_ar/css/checkInOutCart.css\">')\n            this.wrapper.append('<link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/pos_ar/css/itemDetailsCart.css\">')\n            this.wrapper.append('<link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/pos_ar/css/paymentMethodCart.css\">')\n            this.wrapper.append('<link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/pos_ar/css/customerBox.css\">')\n            this.wrapper.append('<link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/pos_ar/css/cartBox.css\">')\n            this.wrapper.append('<link rel=\"stylesheet\" type=\"text/css\" href=\"/assets/pos_ar/css/historyCarts.css\">')\n\n            this.wrapper.append('<div id=\"MainContainer\" class=\"rowBoxReverse\"></div>');\n            this.$components_wrapper = this.wrapper.find(\"#MainContainer\");\n    }\n\n\tprepare_components(){\n\t\tthis.set_right_and_left_sections();\n\t\tthis.init_item_selector();\n\t\tthis.init_customer_box();\n\t\tthis.init_selected_item();\n\t\tthis.init_item_details();\n\t\tthis.init_paymentCart();\n\t\tthis.init_historyCart();\n\t\tthis.init_checkInOutCart();\n\t\tthis.init_debtCart();\n\t\tthis.init_settingsCart();\n\t\tthis.init_unsyncedPosCart();\n\t}\n\n\tasync checkForPOSEntry(){\n\t\tconst user       = frappe.session.user\n\t\tconst posProfile = this.appData.appData.pos_profile.name\n\t\ttry {\n\t\t\tconst response = await frappe.call({\n\t\t\t\tmethod: 'pos_ar.pos_ar.doctype.pos_info.pos_info.check_opening_entry',\n\t\t\t\targs: { user , posProfile}\n\t\t\t});\n\t\t\tconst r = response.message;\n\t\t\tif(r.length === 0 ){\n\t\t\t\tthis.create_opening_voucher()\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t//copy data\n\t\t\tObject.assign(this.POSOpeningEntry ,  r[0])\n\t\t\tthis.db.updateCheckInOutSync(this.POSOpeningEntry.period_start_date)\n\t\t\treturn true\n\t\t} catch (error) {\n\t\t\tconsole.error('error occured : ' , error);\n\t\t\tfrappe.throw('Error checking for POS Opening Entry.')\n\t\t\treturn false;\n\t\t}\n\n\n\t}\n\n\n\n\tcreate_opening_voucher() {\n\t\tconst me = this;\n\t\tconst table_fields = [\n\t\t\t{\n\t\t\t\tfieldname: \"mode_of_payment\",\n\t\t\t\tfieldtype: \"Link\",\n\t\t\t\tin_list_view: 1,\n\t\t\t\tlabel: \"Mode of Payment\",\n\t\t\t\toptions: \"Mode of Payment\",\n\t\t\t\treqd: 1,\n\t\t\t},\n\t\t\t{\n\t\t\t\tfieldname: \"opening_amount\",\n\t\t\t\tfieldtype: \"Currency\",\n\t\t\t\tin_list_view: 1,\n\t\t\t\tlabel: \"Opening Amount\",\n\t\t\t\toptions: \"company:company_currency\",\n\t\t\t\tchange: function () {\n\t\t\t\t\tdialog.fields_dict.balance_details.df.data.some((d) => {\n\t\t\t\t\t\tif (d.idx == this.doc.idx) {\n\t\t\t\t\t\t\td.opening_amount = this.value;\n\t\t\t\t\t\t\tdialog.fields_dict.balance_details.grid.refresh();\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t},\n\t\t];\n\n\t\tconst fetch_pos_payment_methods = () => {\n\t\t\tconst pos_profile = dialog.fields_dict.pos_profile.get_value();\n\n\t\t\tif (!pos_profile) return;\n\t\t\tfrappe.db.get_doc(\"POS Profile\", pos_profile).then(({ payments }) => {\n\t\t\t\tdialog.fields_dict.balance_details.df.data = [];\n\t\t\t\tthis.payment_methods = payments\n\t\t\t\tpayments.forEach((pay) => {\n\t\t\t\t\tconst { mode_of_payment } = pay;\n\t\t\t\t\tdialog.fields_dict.balance_details.df.data.push({ mode_of_payment, opening_amount: \"0\" });\n\t\t\t\t});\n\t\t\t\tdialog.fields_dict.balance_details.grid.refresh();\n\t\t\t});\n\t\t};\n\t\tconst dialog = new frappe.ui.Dialog({\n\t\t\ttitle: __(\"Create POS Opening Entry\"),\n\t\t\tstatic: true,\n\t\t\tfields: [\n\t\t\t\t{\n\t\t\t\t\tfieldtype: \"Link\",\n\t\t\t\t\tlabel: __(\"Company\"),\n\t\t\t\t\tdefault: frappe.defaults.get_default(\"company\"),\n\t\t\t\t\toptions: \"Company\",\n\t\t\t\t\tfieldname: \"company\",\n\t\t\t\t\treqd: 1,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldtype: \"Link\",\n\t\t\t\t\tlabel: __(\"POS Profile\"),\n\t\t\t\t\toptions: \"POS Profile\",\n\t\t\t\t\tfieldname: \"pos_profile\",\n\t\t\t\t\treqd: 1,\n\t\t\t\t\tget_query: () => pos_profile_query(),\n\t\t\t\t\tonchange: () => fetch_pos_payment_methods(),\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tfieldname: \"balance_details\",\n\t\t\t\t\tfieldtype: \"Table\",\n\t\t\t\t\tlabel: \"Opening Balance Details\",\n\t\t\t\t\tcannot_add_rows: false,\n\t\t\t\t\tin_place_edit: true,\n\t\t\t\t\treqd: 1,\n\t\t\t\t\tdata: [],\n\t\t\t\t\tfields: table_fields,\n\t\t\t\t},\n\t\t\t],\n\t\t\tprimary_action: async function ({ company, pos_profile, balance_details }) {\n\t\t\t\tif (!balance_details.length) {\n\t\t\t\t\tfrappe.show_alert({\n\t\t\t\t\t\tmessage: __(\"Please add Mode of payments and opening balance details.\"),\n\t\t\t\t\t\tindicator: \"red\",\n\t\t\t\t\t});\n\t\t\t\t\treturn frappe.utils.play_sound(\"error\");\n\t\t\t\t}\n\n\t\t\t\t// filter balance details for empty rows\n\t\t\t\tbalance_details = balance_details.filter((d) => d.mode_of_payment);\n\n\t\t\t\tconst method = \"erpnext.selling.page.point_of_sale.point_of_sale.create_opening_voucher\";\n\t\t\t\tconst res = await frappe.call({\n\t\t\t\t\tmethod,\n\t\t\t\t\targs: { pos_profile, company, balance_details },\n\t\t\t\t\tfreeze: true,\n\t\t\t\t});\n\t\t\t\t!res.exc && me.prepare_app_data(res.message);\n\n\t\t\t\tObject.assign(me.POSOpeningEntry    ,  {'name' : res.message.name , 'pos_profile' : res.message.pos_profile ,  'period_start_date' : res.message.period_start_date , 'company' : res.message.company } )\n\t\t\t\tme.db.updateCheckInOutSync(me.POSOpeningEntry.period_start_date)\n\t\t\t\tme.check_in_out_cart.getAllCheckInOut();\n\t\t\t\tdialog.hide();\n\n\t\t\t},\n\t\t\tprimary_action_label: __(\"Submit\"),\n\t\t});\n\t\tdialog.show();\n\t\tconst pos_profile_query = () => {\n\t\t\treturn {\n\t\t\t\tquery: \"erpnext.accounts.doctype.pos_profile.pos_profile.pos_profile_query\",\n\t\t\t\tfilters: { company: dialog.fields_dict.company.get_value() },\n\t\t\t};\n\t\t};\n\t}\n\n\n\n    set_right_and_left_sections(){\n        this.$components_wrapper.append('<div id=\"LeftSection\" class=\"columnBoxReverse\"></div>')\n        this.$components_wrapper.append('<div id=\"RightSection\" class=\"columnBox\"></div>')\n\n\t\tthis.$rightSection = this.$components_wrapper.find(\"#RightSection\")\n\t\tthis.$leftSection  = this.$components_wrapper.find(\"#LeftSection\")\n\n    }\n\n\n\tinit_customer_box(){\n\t\tthis.customer_box  = new pos_ar.PointOfSale.pos_customer_box(\n\t\t\t\t\t\t\t\t\tthis.$leftSection ,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.customers,\n\t\t\t\t\t\t\t\t\tthis.defaultCustomer ,\n\t\t\t\t\t\t\t\t\t()=>{\n\t\t\t\t\t\t\t\t\t\tthis.screenManager.navigate(\"home\");\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tthis.onSync.bind(this),\n\t\t\t\t\t\t\t\t\tthis.saveCheckInOut.bind(this),\n\t\t\t\t\t\t\t\t\tthis.onMenuClick.bind(this),\n\t\t\t\t\t\t\t\t\t()=>{\n\t\t\t\t\t\t\t\t\t\tthis.screenManager.navigate(\"debt_cart\");\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\n\t\tthis.screenManager.registerScreen(\"customer_box\" , this.customer_box);\n\t\tthis.screenManager.customer_box = this.customer_box ; \n\t}\n\n\n    init_item_selector(){\n\n        this.item_selector = new pos_ar.PointOfSale.pos_item_selector(\n\t\t\t\tthis.$leftSection                  ,\n\t\t\t\tthis.appData.appData.items         ,\n\t\t\t\tthis.appData.appData.item_barcodes ,\n\t\t\t\tthis.appData.appData.item_groups   ,\n\t\t\t\tthis.appData.appData.item_prices   ,\n\t\t\t\tthis.settings_data.settings        ,\n\t\t\t\tthis.defaultPriceList              ,\n\t\t\t\tthis.getItemPrice.bind(this)       ,\n\t\t\t\tthis.auto_select.bind(this)        ,\n\t\t\t\titem => { this.itemClick_selector(item)  }\n\t\t)\n\t\t\n\t\tthis.screenManager.registerScreen(\"item_selector\" , this.item_selector);\n\t\tthis.screenManager.item_selector = this.item_selector ; \n\t}\n\n    init_selected_item(){\n\t\tthis.selected_item_cart  = new pos_ar.PointOfSale.pos_selected_item_cart(\n\t\t\t\t\t\t\t\t\tthis.$rightSection    ,\n\t\t\t\t\t\t\t\t\tthis.settings_data    ,\n\t\t\t\t\t\t\t\t\tthis.selectedItemMaps ,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.price_lists ,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.customers   ,\n\t\t\t\t\t\t\t\t\tthis.appData.brands   ,\n\t\t\t\t\t\t\t\t\tthis.taxes_and_charges,\n\t\t\t\t\t\t\t\t\tthis.invoiceData      ,\n\t\t\t\t\t\t\t\t\tthis.selectedTab      ,\n\t\t\t\t\t\t\t\t\tthis.selectedItem     ,\n\t\t\t\t\t\t\t\t\tthis.selectedField    ,\n\t\t\t\t\t\t\t\t\tthis.getItemPrice.bind(this),\n\t\t\t\t\t\t\t\t\titem => {\n\t\t\t\t\t\t\t\t\t\tthis.onSelectedItemClick(item)\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\ttab =>{\n\t\t\t\t\t\t\t\t\t\tthis.screenManager.navigate('home')\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t(action , key) =>{\n\t\t\t\t\t\t\t\t\t\tthis.onKeyPressed(action , key)\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tthis.createNewTab.bind(this),\n\t\t\t\t\t\t\t\t\t()=>{\n\t\t\t\t\t\t\t\t\t\tthis.savePosInvoice()\n\t\t\t\t\t\t\t\t\t\tthis.screenManager.navigate(\"payment_cart\");\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tthis.savePosInvoice.bind(this),\n\t\t\t\t\t\t\t\t\tthis.db\n\t\t\t\t\t\t\t\t)\n\t\tthis.screenManager.registerScreen(\"selected_item_cart\" , this.selected_item_cart);\n\t\tthis.screenManager.selected_item_cart = this.selected_item_cart ; \n\t}\n\n\tinit_item_details(){\n\t\tthis.item_details = new pos_ar.PointOfSale.pos_item_details(\n\t\t\t\t\t\t\t\t\tthis.$leftSection,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.pos_profile.warehouse,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.price_lists ,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.item_prices ,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.bins        ,\n\t\t\t\t\t\t\t\t\tthis.selectedItem,\n\t\t\t\t\t\t\t\t\tthis.selectedField,\n\t\t\t\t\t\t\t\t\t(event , field , value) =>{\n\t\t\t\t\t\t\t\t\t\tthis.onInput(event , field , value);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t()=>{\n\t\t\t\t\t\t\t\t\t\tthis.screenManager.navigate('home');\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\tthis.screenManager.registerScreen(\"item_details\" , this.item_details);\n\t\tthis.screenManager.item_details = this.item_details ; \n\t}\n\n\n    init_paymentCart(){\n\t\tthis.payment_cart = new pos_ar.PointOfSale.pos_payment_cart(\n\t\t\t\t\t\t\t\t\tthis.$leftSection,\n\t\t\t\t\t\t\t\t\tthis.selectedItemMaps,\n\t\t\t\t\t\t\t\t\tthis.selectedTab,\n\t\t\t\t\t\t\t\t\tthis.appData.appData,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.pos_profile.payments,\n\t\t\t\t\t\t\t\t\tthis.selectedPaymentMethod,\n\t\t\t\t\t\t\t\t\tthis.invoiceData,\n\t\t\t\t\t\t\t\t\t()=>{\n\t\t\t\t\t\t\t\t\t\tthis.screenManager.navigate('home');\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\tthis.onCompleteOrder.bind(this),\n\t\t\t\t\t\t\t\t\t(event , field , value) =>{\n\t\t\t\t\t\t\t\t\t\tthis.onInput(event , field , value);\n\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t)\n\t\tthis.screenManager.registerScreen(\"payment_cart\" , this.payment_cart);\n\t\tthis.screenManager.payment_cart = this.payment_cart ; \n    }\n\n    init_historyCart(){\n\t\tthis.history_cart = new pos_ar.PointOfSale.pos_history(\n\t\t\t\t\t\t\t\t\tthis.wrapper,\n\t\t\t\t\t\t\t\t\tthis.db,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.pos_profile,\n\t\t\t\t\t\t\t\t\tthis.appData,\n\t\t\t\t\t\t\t\t\tthis.settings_data,\n\t\t\t\t\t\t\t\t\tthis.company,\n\t\t\t\t\t\t\t\t\tthis.taxes_and_charges,\n\t\t\t\t\t\t\t\t\tthis.historyCartClick.bind(this)\n\t\t\t\t\t\t\t\t)\n\t\tthis.screenManager.registerScreen(\"history_cart\" , this.history_cart);\n\t\tthis.screenManager.history_cart = this.history_cart ; \n    }\n\n    init_checkInOutCart(){\n\t\tthis.check_in_out_cart = new pos_ar.PointOfSale.pos_check_in_out(\n\t\t\t\t\t\t\t\t\tthis.wrapper,\n\t\t\t\t\t\t\t\t\tthis.db\n\t\t\t\t\t\t\t\t)\n\t\tthis.screenManager.registerScreen(\"check_in_out_cart\" , this.check_in_out_cart);\n\t\tthis.screenManager.check_in_out_cart = this.check_in_out_cart ; \n    }\n\n    init_debtCart(){\n\t\tthis.debt_cart = new pos_ar.PointOfSale.pos_debt_cart(\n\t\t\t\t\t\t\t\t\tthis.wrapper,\n\t\t\t\t\t\t\t\t\tthis.appData,\n\t\t\t\t\t\t\t\t\t()=>{\n\t\t\t\t\t\t\t\t\t\tthis.check_in_out_cart.getAllCheckInOut();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\tthis.screenManager.registerScreen(\"debt_cart\" , this.debt_cart);\n\t\tthis.screenManager.debt_cart = this.debt_cart ; \n\t}\n\n\n    init_settingsCart(){\n\t\tthis.settings_cart = new pos_ar.PointOfSale.pos_settings(\n\t\t\t\t\t\t\t\t\tthis.wrapper,\n\t\t\t\t\t\t\t\t\tthis.settings_data,\n\t\t\t\t\t\t\t\t\tthis.appData.appData.pos_profile,\n\t\t\t\t\t\t\t\t\tthis.onSettingsChange.bind(this)\n\t\t\t\t\t\t\t\t)\n\t\tthis.screenManager.registerScreen(\"settings_cart\" , this.settings_cart);\n\t\tthis.screenManager.settings_cart = this.settings_cart ; \n    }\n\n\tinit_unsyncedPosCart(){\n\t\tthis.unsynced_pos_cart = new pos_ar.PointOfSale.pos_unsynced_cart(\n\t\t\t\t\t\t\t\t\tthis.wrapper,\n\t\t\t\t\t\t\t\t\tthis.appData,\n\t\t\t\t\t\t\t\t\tthis.db,\n\t\t\t\t\t\t\t\t\t(invoice)=>{\n\t\t\t\t\t\t\t\t\t\tconst tab = this.selected_item_cart.createTabForEditPOS()\n\n\t\t\t\t\t\t\t\t\t\tthis.selectedItemMaps.set(`C${tab}` , invoice)\n\t\t\t\t\t\t\t\t\t\tthis.selectedTab.tabName = `C${tab}`\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\tthis.screenManager.navigate('home')\n\t\t\t\t\t\t\t\t\t},()=>{\n\t\t\t\t\t\t\t\t\t\tif(this.unsyncedPos >= 1){\n\t\t\t\t\t\t\t\t\t\t\tthis.customer_box.setSynced();\n\t\t\t\t\t\t\t\t\t\t\tthis.unsyncedPos = 0\n\t\t\t\t\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\t\t\t\t\tthis.unsyncedPos -= 1 ;\n\t\t\t\t\t\t\t\t\t\t\tthis.customer_box.setNotSynced(this.unsyncedPos);\n\t\t\t\t\t\t\t\t\t\t}\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t)\n\t\tthis.screenManager.registerScreen(\"unsynced_pos_cart\" , this.unsynced_pos_cart);\n\t\tthis.screenManager.unsynced_pos_cart = this.unsynced_pos_cart ; \n    }\n\n\n\n    /**************************  callbacks functions ******************************/\n\n\n\titemClick_selector(item , refresh){\n\n\t\tthis.syncInput = false\n\n\t\tconst  itemCloned = structuredClone(item);\n\n\t\titemCloned.discount_amount     = 0;\n\t\titemCloned.discount_percentage = 0;\n\n\t\tObject.assign(this.selectedItem , itemCloned)\n\n\t\tthis.addItemToPosInvoice( itemCloned )\n\n\t\tthis.selected_item_cart.calculateNetTotal();\n\t\tthis.selected_item_cart.calculateVAT();\n\t\tthis.selected_item_cart.calculateQnatity();\n\t\tthis.selected_item_cart.calculateGrandTotal();\n\t\tthis.selected_item_cart.refreshSelectedItem();\n\n\t\tif(refresh){\n\t\t\tthis.item_selector.refreshItemSelector()\n\t\t}\n\n\t\tthis.selectedField.field_name = \"quantity\"\n\t\tthis.selected_item_cart.makeSelectedButtonHighlighted();\n\n\t\tthis.selected_item_cart.scrollToBottom()\n\n\t\tthis.savePosInvoice()\n\t}\n\n\n\tonSelectedItemClick(item){\n\t\tthis.syncInput = false\n\t\tconst clonedItem = structuredClone(item)\n\t\tObject.assign(this.selectedItem , clonedItem)\n\n\t\tthis.selectedField.field_name = \"quantity\"\n\t\tthis.selected_item_cart.makeSelectedButtonHighlighted();\n\n\t\tthis.screenManager.navigate(\"item_details\");\n\n\t\t//refresh data\n\t\tthis.item_details.refreshDate(item);\n\t}\n\n\n\tsaveCheckInOut(checkInOut){\n\t\tcheckInOut.is_sync = 0 ;\n\t\tthis.appData.saveCheckInOut(\n\t\t\tcheckInOut,\n\t\t\t(res)=>{\n\t\t\t\tthis.check_in_out_cart.getAllCheckInOut();\n\t\t\t},(err)=>{\n\t\t\t\tconsole.log('err to save checkInOut : ' , err)\n\t\t\t}\n\t\t)\n\t}\n\n\n\tonSettingsChange(settingName){\n\t\tif(settingName == \"itemPriceBasedOn\"){\n\t\t\t//refreshing selected_item_cart and item_selector_cart\n\t\t\tthis.item_selector.refreshItemSelector();\n\t\t\t//recalculate price\n\t\t\tthis.selected_item_cart.resetItemRateBaseOnPriceList()\n\t\t\t//redraw\n\t\t\tthis.selected_item_cart.refreshSelectedItem()\n\t\t}\n\t}\n\n\n\tsavePosInvoice(saveWithZeroRate){\n\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).synced = false ;\n\t\tconsole.log(\"savePosInvoice : \" , this.selectedItemMaps.get(this.selectedTab.tabName))\n\t\tthis.appData.savePosInvoice(this.selectedItemMaps.get(this.selectedTab.tabName))\n\n\t}\n\n\n\tauto_select(item){\n\t\tthis.itemClick_selector(item)\n\t\tthis.item_selector.refresh()\n\t}\n\n\n\n\tonMenuClick(menu){\n\t\tif(menu == 'recent_pos'){\n\t\t\tthis.screenManager.navigate(\"history_cart\");\n\t\t}\n\t\telse if(menu == 'close_pos'){\n\t\t\tthis.onClosePOS()\n\t\t}\n\t\telse if(menu == 'unsenced_invoices'){\n\t\t\tthis.screenManager.navigate(\"unsynced_pos_cart\");\n\t\t}\n\t\telse if(menu == 'settings'){\n\t\t\tthis.screenManager.navigate(\"settings_cart\");\n\t\t}\n\t\telse if(menu == 'checkInOut'){\n\t\t\tthis.screenManager.navigate(\"check_in_out_cart\");\n\t\t}\n\t}\n\n\tgetDefaultPaymentMethod(){\n\t\tlet result = null;\n\t\tthis.appData.appData.pos_profile.payments.forEach(method =>{\n\t\t\tif(method.default){\n\t\t\t\tresult = method\n\t\t\t}\n\t\t})\n\n\t\treturn result\n\t}\n\n\tgetPaymentMethods(){\n\t\tlet result = [];\n\t\tthis.appData.appData.pos_profile.payments.forEach(method =>{\n\t\t\tresult.push({'mode_of_payment' : method.mode_of_payment , 'default' : method.default , 'amount' : 0})\n\t\t})\n\t\treturn result\n\t}\n\n\trestorePosInvoices(posInvoices){\n\t\tposInvoices.forEach((pos)=>{\n\t\t\tconst tab = this.selected_item_cart.createTabForEditPOS()\n\t\t\tthis.selectedItemMaps.set(`C${tab}` , pos)\n\t\t\tthis.selectedTab.tabName = `C${tab}`\n\t\t})\n\t\tthis.screenManager.navigate('home')\n\t}\n\n\tcreateNewTab(counter){\n\n\t\tlet new_pos_invoice = frappe.model.get_new_doc('POS Invoice');\n\t\tnew_pos_invoice.customer          = this.defaultCustomer.name\n\t\tnew_pos_invoice.pos_profile       = this.appData.appData.pos_profile.name\n\t\tnew_pos_invoice.items             = [];\n\t\tnew_pos_invoice.taxes_and_charges = this.appData.appData.pos_profile.taxes_and_charges\n\t\tnew_pos_invoice.additional_discount_percentage = 0\n\t\tnew_pos_invoice.paid_amount       = 0\n\t\tnew_pos_invoice.base_paid_amount  = 0\n\t\tnew_pos_invoice.creation_time     = frappe.datetime.now_datetime()\n\t\tnew_pos_invoice.payments          = this.getPaymentMethods()\n\t\tnew_pos_invoice.is_pos            = 1\n\t\tnew_pos_invoice.update_stock      = 1\n\t\tnew_pos_invoice.docstatus         = 0\n\t\tnew_pos_invoice.synced            = false\n\t\tnew_pos_invoice.status            = 'Draft'\n\t\tnew_pos_invoice.priceList         = this.defaultPriceList.name\n\t\tnew_pos_invoice.opened            = 1\n\t\t//build refNm   posProfile-date-time\n\t\tconst date = new Date()\n\t\tconst [year,month,day] = date.toISOString().split('T')[0].split('-')\n\t\tconst hour    = date.getHours()\n\t\tconst minutes = date.getMinutes()\n\t\tconst seconds = date.getMilliseconds()\n\t\tnew_pos_invoice.refNum            = this.appData.appData.pos_profile.name+\"-\"+year+'-'+month+'-'+day+'-'+hour+minutes+seconds\n\t\tnew_pos_invoice.custom_cach_name  = new_pos_invoice.refNum\n\n\t\tthis.selectedItemMaps.set(`C${counter}` , new_pos_invoice)\n\t\tthis.selectedTab.tabName = `C${counter}`\n\n\t\t\n\t\tthis.screenManager.navigate('home')\n\t}\n\n\n\thistoryCartClick(event , message){\n\t\t//go back to edit pos draft\n\t\tif(event == 'edit'){\n\t\t\tconst tab = this.selected_item_cart.createTabForEditPOS()\n\n\t\t\tthis.selectedItemMaps.set(`C${tab}` , message)\n\t\t\tthis.selectedTab.tabName = `C${tab}`\n\n\t\t\tthis.screenManager.navigate('home')\n\t\t}else if(event == 'duplicate'){\n\t\t\tconst tab = this.selected_item_cart.createTabForEditPOS()\n\n\t\t\tmessage.name              = frappe.model.get_new_doc('POS Invoice').name;\n\t\t\tmessage.pos_profile       = this.appData.appData.pos_profile.name\n\t\t\tmessage.taxes_and_charges = this.appData.appData.pos_profile.taxes_and_charges\n\t\t\tmessage.creation_time     = frappe.datetime.now_datetime()\n\t\t\tmessage.payments          = this.getPaymentMethods()\n\t\t\tmessage.priceList         = this.defaultPriceList.name\n\t\t\t//build refNm   posProfile-date-time\n\t\t\tconst date = new Date()\n\t\t\tconst [year,month,day] = date.toISOString().split('T')[0].split('-')\n\t\t\tconst hour    = date.getHours()\n\t\t\tconst minutes = date.getMinutes()\n\t\t\tconst seconds = date.getMilliseconds()\n\t\t\tmessage.refNum            = this.appData.appData.pos_profile.name+\"-\"+year+'-'+month+'-'+day+'-'+hour+minutes+seconds\n\t\t\tmessage.custom_cach_name  = message.refNum\n\n\t\t\tthis.selectedItemMaps.set(`C${tab}` , message)\n\t\t\tthis.selectedTab.tabName = `C${tab}`\n\n\t\t\tthis.screenManager.navigate('home')\n\t\t}\n\t\telse if(event == 'return'){\n\t\t\tconst tab = this.selected_item_cart.createTabForEditPOS()\n\n\t\t\tconst returnedPosInvoice = this.makePosInvoiceReturn(message)\n\t\t\tthis.selectedItemMaps.set(`C${tab}` , returnedPosInvoice)\n\t\t\tthis.selectedTab.tabName = `C${tab}`\n\n\t\t\tthis.screenManager.navigate('home')\n\t\t}\n\t}\n\n\tonInput( event , field , value){\n\n\t\tif(event == \"focus\" || event == \"blur\"){\n\t\t\tif(event == \"focus\")\n\t\t\t\tObject.assign(this.selectedField , {field_name : field})\n\t\t\tif(event == \"blur\")\n\t\t\t\tObject.assign(this.selectedField , {field_name : null})\n\n\t\t\tthis.item_details.makeSelectedFieldHighlighted()\n\t\t\tthis.selected_item_cart.makeSelectedButtonHighlighted();\n\n\t\t\treturn;\n\t\t}\n\n\t\tif( field ==  \"quantity\" ){\n\t\t\tthis.selectedItem.qty = parseFloat(value);\n\t\t\tthis.editPosItemQty(this.selectedItem.name , this.selectedItem.qty);\n\n\t\t\t//redrawing\n\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t}\n\t\telse if( field ==  \"rate\" ){\n\t\t\tthis.selectedItem.rate = parseFloat(value);\n\n\t\t\t//recalculate the rate\n\t\t\tlet oldRate = this.selectedItem.rate;\n\t\t\tlet persont = this.selectedItem.discount_percentage\n\t\t\tlet montant = oldRate * (persont / 100)\n\n\t\t\tthis.selectedItem.discount_percentage = persont;\n\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\tthis.editPosItemDiscountAmount(this.selectedItem.name , this.selectedItem.discount_amount);\n\t\t\tthis.editPosItemRate(this.selectedItem.name , this.selectedItem.rate);\n\n\t\t\t//redrawing\n\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\tthis.item_details.refreshDate(this.selectedItem);\n\n\t\t}\n\t\telse if( field == \"discount_percentage\"){\n\n\t\t\t//recalculate the rate\n\t\t\tlet oldRate = this.selectedItem.rate;\n\t\t\tlet montant = oldRate * (parseFloat(value) / 100)\n\n\t\t\tthis.selectedItem.discount_percentage = parseFloat(value);\n\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\tthis.editPosItemDiscountAmount(this.selectedItem.name , this.selectedItem.discount_amount);\n\t\t\tthis.editPosItemDiscountPercentage(this.selectedItem.name ,  this.selectedItem.discount_percentage);\n\n\t\t\t//redrawing\n\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\tthis.item_details.refreshDate(this.selectedItem);\n\t\t}\n\t\telse if( field == \"discount_amount\"){\n\n\t\t\t//recalculate the rate\n\t\t\tlet oldRate = this.selectedItem.rate;\n\t\t\tlet persent = ((parseFloat(value) * 100) / oldRate).toFixed(2);\n\t\t\tlet montant = parseFloat(value);\n\n\t\t\t//prevent negatif result\n\t\t\tif(persent > 100){\n\t\t\t\tpersent = 100 ;\n\t\t\t}\n\t\t\tif(parseFloat(value) > oldRate){\n\t\t\t\tmontant = oldRate;\n\t\t\t}\n\n\t\t\tthis.selectedItem.discount_percentage = parseFloat(persent);\n\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\tthis.editPosItemDiscountAmount(this.selectedItem.name , this.selectedItem.discount_amount);\n\t\t\tthis.editPosItemDiscountPercentage(this.selectedItem.name , this.selectedItem.discount_percentage);\n\n\t\t\t//redrawing\n\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\tthis.item_details.refreshDate(this.selectedItem);\n\n\t\t}\n\n\t\tthis.savePosInvoice()\n\t}\n\n\n\tonKeyPressed( action  , key){\n\n\t\tif(action == \"quantity\"){\n\t\t\tthis.selectedField.field_name = \"quantity\"\n\t\t\tthis.selected_item_cart.makeSelectedButtonHighlighted();\n\t\t\t//this.item_details.requestFocus(\"quantity\")\n\t\t}\n\t\telse if(action == \"rate\"){\n\t\t\tthis.selectedField.field_name = \"rate\"\n\t\t\tthis.selected_item_cart.makeSelectedButtonHighlighted();\n\t\t\t//this.item_details.requestFocus(\"rate\")\n\t\t}\n\t\telse if(action == \"minus\"){\n\t\t\tthis.syncInput = true\n\t\t\tconst newValue = parseFloat(this.selectedItem.qty) * -1\n\t\t\tthis.selectedItem.qty = parseFloat(newValue);\n\t\t\tthis.editPosItemQty(this.selectedItem.name , this.selectedItem.qty);\n\t\t\t//redrawing\n\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t}\n\t\telse if(action == \"print\"){\n\t\t\tconsole.log(\"1.1..the map is \" , structuredClone(this.selectedItemMaps.get(this.selectedTab.tabName))\t)\n\t\t\tthis.history_cart.print_receipt( structuredClone(this.selectedItemMaps.get(this.selectedTab.tabName)) )\n\t\t\t//this.item_details.requestFocus(\"discount_percentage\")\n\t\t}\n\t\telse if(action == \"remove\"){\n\t\t\tthis.syncInput = false;\n\n\t\t\tthis.deleteItemFromPOsInvoice(this.selectedItem.name);\n\n\t\t}\n\t\telse if(action == \"delete\"){\n\n\n\t\t\t//check if the details cart is appear\n\t\t\tif(!this.settings_data.settings.showItemDetails){\n\t\t\t\tif(this.selectedField.field_name == \"quantity\"){\n\t\t\t\t\tconst oldValue = parseFloat(this.selectedItem.qty)\n\t\t\t\t\tconst newValue = `${oldValue}`.slice(0, -1)\n\t\t\t\t\tthis.selectedItem.qty = parseFloat(newValue) || 0;\n\t\t\t\t}\n\t\t\t\telse if(this.selectedField.field_name == \"rate\"){\n\t\t\t\t\tconst oldValue = parseFloat(this.selectedItem.rate)\n\t\t\t\t\tconst newValue = `${oldValue}`.slice(0, -1)\n\n\t\t\t\t\tthis.selectedItem.rate = parseFloat(newValue) || 0;\n\n\t\t\t\t\t//recalculate the rate\n\t\t\t\t\tlet oldRate = this.selectedItem.rate;\n\t\t\t\t\tlet persont = this.selectedItem.discount_percentage\n\t\t\t\t\tlet montant = oldRate * (persont / 100)\n\n\t\t\t\t\tthis.selectedItem.discount_percentage = persont;\n\t\t\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\t\t\tthis.editPosItemDiscountAmount(this.selectedItem.name , this.selectedItem.discount_amount);\n\t\t\t\t\tthis.editPosItemRate(this.selectedItem.name , this.selectedItem.rate);\n\n\t\t\t\t}\n\t\t\t\telse if(this.selectedField.field_name == \"discount_percentage\"){\n\t\t\t\t\t//recalculate the rate\n\t\t\t\t\tlet oldRate        = this.selectedItem.rate;\n\t\t\t\t\tlet old_percentage = this.selectedItem.discount_percentage ?? 0;\n\t\t\t\t\tlet input          = `${old_percentage}` + key ;\n\t\t\t\t\tlet discount_percentage = parseFloat(input);\n\t\t\t\t\tif(discount_percentage > 100){\n\t\t\t\t\t\tdiscount_percentage = 100;\n\t\t\t\t\t}\n\t\t\t\t\tlet montant = oldRate * ( discount_percentage / 100)\n\t\t\t\t\tlet newRate = oldRate - montant\n\n\n\t\t\t\t\tthis.selectedItem.discount_percentage = (discount_percentage);\n\t\t\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t\tlet newValue =  parseFloat(this.item_details.deleteCharacter())\n\n\t\t\tif(this.selectedField.field_name == \"quantity\"){\n\t\t\t\tthis.selectedItem.qty = newValue;\n\t\t\t}\n\t\t\telse if(this.selectedField.field_name == \"rate\"){\n\n\t\t\t\tthis.selectedItem.rate = newValue;\n\n\t\t\t\t//recalculate the rate\n\t\t\t\tlet oldRate = this.selectedItem.rate;\n\t\t\t\tlet persont = this.selectedItem.discount_percentage\n\t\t\t\tlet montant = oldRate * (persont / 100)\n\n\t\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\t}\n\t\t\telse if(this.selectedField.field_name == \"discount_percentage\"){\n\t\t\t\t//recalculate the rate\n\t\t\t\tlet oldRate = this.selectedItem.rate;\n\t\t\t\tlet montant = oldRate * (newValue / 100)\n\n\t\t\t\tthis.selectedItem.discount_percentage = newValue;\n\t\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\t}\n\t\t\telse if(this.selectedField.field_name == \"discount_percentage\"){\n\t\t\t\t//recalculate the rate\n\t\t\t\tlet oldRate = this.selectedItem.rate;\n\t\t\t\tlet montant = oldRate * (newValue / 100)\n\n\t\t\t\t//asign the values to the selectedItem refrence\n\t\t\t\tthis.selectedItem.discount_percentage = newValue;\n\t\t\t\tthis.selectedItem.discount_rate       = montant;\n\n\t\t\t}\n\t\t\telse if(this.selectedField.field_name == \"cash\"){\n\t\t\t\tthis.payment_cart.deleteKeyPress();\n\t\t\t}\n\n\n\n\t\t}\n\t\telse if(action == \"addToField\"){\n\n\t\t\tif(this.selectedField.field_name == \"cash\"){\n\t\t\t\tthis.payment_cart.handleInput(key);\n\t\t\t}\n\t\t\telse{\n\n\t\t\t\tif( this.selectedField.field_name ==  \"quantity\" ){\n\t\t\t\t\tlet oldValue = 0\n\t\t\t\t\tif(!this.syncInput){\n\t\t\t\t\t\toldValue = 0\n\t\t\t\t\t\tthis.syncInput = true\n\t\t\t\t\t}else{\n\t\t\t\t\t\toldValue = parseFloat(this.selectedItem.qty)\n\t\t\t\t\t}\n\t\t\t\t\tconst newValue = `${oldValue}` + key\n\t\t\t\t\tthis.selectedItem.qty = parseFloat(newValue);\n\t\t\t\t}\n\t\t\t\telse if( this.selectedField.field_name ==  \"rate\" ){\n\t\t\t\t\t\tlet lastValue = 0\n\t\t\t\t\t\tif(!this.syncInput){\n\t\t\t\t\t\t\tlastValue = 0\n\t\t\t\t\t\t\tthis.syncInput = true\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tlastValue = parseFloat(this.selectedItem.rate)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst newValue  = `${lastValue}` + key\n\t\t\t\t\t\tthis.selectedItem.rate = parseFloat(newValue);\n\n\t\t\t\t\t\t//recalculate the rate\n\t\t\t\t\t\tlet oldRate = this.selectedItem.rate;\n\t\t\t\t\t\tlet persont = this.selectedItem.discount_percentage\n\t\t\t\t\t\tlet montant = oldRate * (persont / 100)\n\n\t\t\t\t\t\tthis.selectedItem.discount_percentage = persont;\n\t\t\t\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\t\t\t\tthis.editPosItemDiscountAmount(this.selectedItem.name , this.selectedItem.discount_amount);\n\t\t\t\t\t\tthis.editPosItemRate(this.selectedItem.name , this.selectedItem.rate);\n\n\t\t\t\t}\n\t\t\t\telse if( this.selectedField.field_name ==  \"discount_percentage\" ){\n\t\t\t\t\t//recalculate the rate\n\t\t\t\t\tlet oldRate        = this.selectedItem.rate;\n\t\t\t\t\tlet old_percentage = this.selectedItem.discount_percentage ?? 0;\n\t\t\t\t\tlet input          = `${old_percentage}` + key ;\n\t\t\t\t\tlet discount_percentage = parseFloat(input);\n\t\t\t\t\tif(discount_percentage > 100){\n\t\t\t\t\t\tdiscount_percentage = 100;\n\t\t\t\t\t}\n\t\t\t\t\tlet montant = oldRate * ( discount_percentage / 100)\n\t\t\t\t\tlet newRate = oldRate - montant\n\n\n\t\t\t\t\tthis.selectedItem.discount_percentage = (discount_percentage);\n\t\t\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\t\t}\n\n\t\t\t}\n\n\n\t\t}\n\n\t\t\n\n\n\t\t//update the posInvoice\n\t\tthis.editPosItemDiscountAmount(this.selectedItem.name , this.selectedItem.discount_amount);\n\t\tthis.editPosItemRate(this.selectedItem.name , this.selectedItem.rate);\n\t\tthis.editPosItemQty(this.selectedItem.name , this.selectedItem.qty);\n\n\t\t//update the ui\n\t\tthis.selected_item_cart.refreshSelectedItem()\n\t\tthis.item_details.refreshDate(this.selectedItem);\n\n\t\tthis.savePosInvoice()\n\t}\n\n\n\tonCompleteOrder(){\n\n\t\tthis.payment_cart.show_waiting()\n\n\t\tthis.savePosInvoice()\n\n\t\t//check if they set a customer\n\t\tif(this.defaultCustomer.name == \"\"){\n\t\t\tfrappe.warn(\n\t\t\t\t\t'Customer didnt selected!',\n\t\t\t\t\t'you have to select a customer',\n\t\t\t\t\t()=>{\n\t\t\t\t\t},\n\t\t\t\t\t'Done',\n\t\t\t\t\tfalse\n\t\t\t)\n\t\t\treturn ;\n\t\t}\n\t\tlet items = []\n\t\tlet is_return = 1;\n\n\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).items.forEach(  item  =>{\n\t\t\t// we still didnt implement the  base_paid_amount and amount_eligible_for_commissionseen\n\t\t\t// value in deafault pos ==>  [\"Administrator\"]. i think it is an array.\n\t\t\tlet newItem = {\n\t\t\t\t'item_name'               : item.item_name,\n\t\t\t\t'item_code'               : item.item_code,\n\t\t\t\t'rate'                    : item.rate,\n\t\t\t\t'qty'                     : item.qty,\n\t\t\t\t'description'             : item.description,\n\t\t\t\t'image'                   : item.image,\n\t\t\t\t'use_serial_batch_fields' : 1,\n\t\t\t\t'cost_center'             : this.appData.appData.pos_profile.cost_center,\n\t\t\t\t'discount_percentage'     : item.discount_percentage,\n\t\t\t\t'discount_amount'         : item.discount_amount,\n\t\t\t\t'warehouse'               : this.appData.appData.pos_profile.warehouse,\n\t\t\t\t'income_account'          : this.appData.appData.pos_profile.income_account,\n\t\t\t}\n\t\t\titems.push(newItem)\n\t\t\tif(item.qty > 0)\n\t\t\t\tis_return = 0\n\t\t})\n\n\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).is_return = is_return\n\n\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).items = items\n\t\tif(items.length ==0)\n\t\t\treturn\n\n\t\tlet total = 0\n\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).items.forEach(item =>{\n\t\t\ttotal += item.rate * item.qty\n\t\t})\n\n\t\tif(this.calculatePaidAmount(this.selectedItemMaps.get(this.selectedTab.tabName)) > total){\n\t\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).paid_amount            = total\n\t\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).base_paid_amount       = total\n\t\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).outstanding_amount     = 0\n\t\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).total_customer_payment = this.calculatePaidAmount(this.selectedItemMaps.get(this.selectedTab.tabName))\n\t\t}else{\n\t\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).paid_amount            = this.calculatePaidAmount(this.selectedItemMaps.get(this.selectedTab.tabName))\n\t\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).base_paid_amount       = this.calculatePaidAmount(this.selectedItemMaps.get(this.selectedTab.tabName))\n\t\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).outstanding_amount     = this.invoiceData.grandTotal - this.calculatePaidAmount(this.selectedItemMaps.get(this.selectedTab.tabName))\n\t\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).total_customer_payment = this.calculatePaidAmount(this.selectedItemMaps.get(this.selectedTab.tabName))\n\t\t}\n\n\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).docstatus          = 1\n\n\t\t//set status\n\t\tconst status = this.checkIfPaid(this.selectedItemMaps.get(this.selectedTab.tabName))\n\t\tthis.selectedItemMaps.get(this.selectedTab.tabName).status            = status\n\n\t\t//copy the pos is important otherwise it will deleted and the selectedTab change and then it will save the\n\t\t//wrong one. because insert take a while after the callback will called.\n\t\t//console.log(\"debuging rayan :::: \" , this.selected_item_cart)\n\n\n\t\tconst pos = structuredClone(this.selectedItemMaps.get(this.selectedTab.tabName))\n\n\n\t\tif(status == 'Unpaid'){\n\t\t\tpos.synced = true\n\t\t\tfrappe.db.insert(\n\t\t\t\tpos\n\t\t\t).then(r =>{\n\n \t\t\t\tthis.payment_cart.hide_waiting()\n\n\t\t\t\tpos.opened = 0;\n\t\t\t\tpos.real_name = r.name\n\n\t\t\t\tthis.history_cart.print_receipt(pos)\n\t\t\t\tthis.appData.updatePosInvoice(pos)\n\n\t\t\t\t/*** START : deleting pos when finishing **/\n\t\t\t\t//print the pos\n\n\t\t\t\tthis.selectedItemMaps.delete(this.selectedTab.tabName)\n\n\t\t\t\t//tabs\n\t\t\t\tlet tabs = Array.from(this.selectedItemMaps.keys())\n\t\t\t\t//if there are still tabs it will just set the first as selected\n\t\t\t\t//otherwise it will create one using the selected_item_cart class and set it as selected\n\t\t\t\tif(tabs.length > 0){\n\t\t\t\t\tthis.selectedTab.tabName = tabs[0]\n\t\t\t\t\tthis.selected_item_cart.refreshTabs();\n\t\t\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tthis.selected_item_cart.createNewTab();\n\t\t\t\t}\n\t\t\t\tthis.screenManager.navigate('home')\n\t\t\t\t/*** END   : deleting pos when finishing **/\n\n\n\t\t\t}).catch(err=>{\n\t\t\t\tthis.payment_cart.hide_waiting()\n\t\t\t\tconsole.log(\"cant push pos invoice : \" , err);\n\t\t\t})\n\t\t}\n\t\telse{\n\n\t\t\tthis.payment_cart.hide_waiting()\n\t\t\t/*** START : deleting pos when finishing **/\n\t\t\t//print the pos\n\t\t\tthis.history_cart.print_receipt(pos)\n\n\t\t\tthis.selectedItemMaps.delete(this.selectedTab.tabName)\n\n\t\t\t//tabs\n\t\t\tlet tabs = Array.from(this.selectedItemMaps.keys())\n\t\t\t//if there are still tabs it will just set the first as selected\n\t\t\t//otherwise it will create one using the selected_item_cart class and set it as selected\n\t\t\tif(tabs.length > 0){\n\t\t\t\tthis.selectedTab.tabName = tabs[0]\n\t\t\t\tthis.selected_item_cart.refreshTabs();\n\t\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.selected_item_cart.createNewTab();\n\t\t\t}\n\t\t\tthis.screenManager.navigate('home')\n\t\t\t/*** END : deleting pos when finishing **/\n\n\n\t\t\tpos.synced = false ;\n\t\t\tpos.opened = 0;\n\t\t\tthis.appData.updatePosInvoice(pos)\n\n\t\t\tthis.unsyncedPos += 1 ;\n\t\t\tthis.customer_box.setNotSynced(this.unsyncedPos);\n\t\t}\n\t}\n\n\n\tonSync(){\n\t\tif(this.POSOpeningEntry.name == '' ){\n\t\t\tthis.checkForPOSEntry();\n\t\t\treturn;\n\t\t}\n\n\t\t//check if there is a pos to sync\n\t\tif(this.unsyncedPos == 0){\n\t\t\t// with options\n\t\t\tfrappe.msgprint({\n\t\t\t\ttitle: __('Sync Complete'),\n\t\t\t\tindicator: 'green',\n\t\t\t\tmessage: __('All data is already synchronized.')\n\t\t\t});\n\t\t\treturn;\n\t\t}\n\n\t\tlet counter     = 0  ;\n\t\tlet failure     = 0  ;\n\t\tlet seccess     = 0  ;\n\n\t\tthis.appData.getNotSyncedPos(\n\t\t\t(allUnsyncedPos) =>{\n\t\t\t\t//create progress bar\n\t\t\t\tfrappe.show_progress('Syncing Invoices...' , 0 , allUnsyncedPos.length , 'syncing')\n\n\t\t\t\tallUnsyncedPos.forEach(pos=>{\n\t\t\t\t\t// we still didnt implement the  base_paid_amount and amount_eligible_for_commissionseen\n\t\t\t\t\t// value in deafault pos ==>  [\"Administrator\"]. i think it is an array.\n\t\t\t\t\tfrappe.db.insert(\n\t\t\t\t\t\tpos\n\t\t\t\t\t).then(r =>{\n\t\t\t\t\t\tconst updatedPos = structuredClone(pos)\n\t\t\t\t\t\tupdatedPos.synced = true;\n\t\t\t\t\t\tupdatedPos.real_name = r.name\n\t\t\t\t\t\tthis.appData.updatePosInvoice(updatedPos)\n\t\t\t\t\t\tcounter += 1 ;\n\t\t\t\t\t\tfrappe.show_progress('Syncing Invoices...' , counter , allUnsyncedPos.length , 'syncing')\n\t\t\t\t\t\t//if the last pos save seccessfully then hide the progress bar\n\t\t\t\t\t\tif(counter == allUnsyncedPos.length){\n\t\t\t\t\t\t\tfrappe.hide_progress();\n\t\t\t\t\t\t\tthis.customer_box.setSynced();\n\t\t\t\t\t\t\tthis.unsyncedPos = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t}).catch(err =>{\n\t\t\t\t\t\tcounter += 1 ;\n\t\t\t\t\t\tfailure += 1 ;\n\n\t\t\t\t\t\t//if the last pos save seccessfully then hide the progress bar\n\t\t\t\t\t\tif(counter == allUnsyncedPos.length){\n\t\t\t\t\t\t\tfrappe.hide_progress();\n\t\t\t\t\t\t\tthis.customer_box.setSynced();\n\t\t\t\t\t\t\tthis.unsyncedPos = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t\n\t\t\t\t\t})\n\t\t\t\t})\n\t\t\t},\n\t\t\t(err) =>{\n\t\t\t\tconsole.log(\"cant get the unseced POS from local\")\n\t\t\t}\n\t\t);\n\n\n\t}\n\n\n\t/***********************************************   tools  *************************************************/\n\n\tgetCustomerDefaultPriceList(customerId){\n\t\tlet priceList = \"\"\n\t\tthis.appData.appData.customers.forEach(customer => {\n\t\t\tif(customer.name == customerId){\n\t\t\t\tpriceList = customer.default_price_list\n\t\t\t}\n\t\t})\n\t\treturn priceList\n\t}\n\tcheckIfPaid(pos){\n\n\t\tlet netTotal   = 0 ;\n\t\tlet grandTotal = 0 ;\n\t\tlet allTaxes   = 0 ;\n\t\tlet discount   = 0 ;\n\n\t\t//net total\n\t\tpos.items.forEach( item => {\n\t\t\tnetTotal += item.qty * item.rate\n\t\t})\n\n\t\tthis.taxes_and_charges.forEach(tax =>{\n\t\t\tallTaxes += (tax.rate / 100) * netTotal\n\t\t})\n\n\t\t//discount\n\t\tdiscount = (pos.additional_discount_percentage / 100) * netTotal\n\n\t\tgrandTotal  = netTotal + allTaxes - discount\n\n\t\tif(pos.paid_amount == 0){\n\t\t\treturn \"Unpaid\"\n\t\t}\n\t\telse if(pos.paid_amount < grandTotal){\n\t\t\treturn \"Unpaid\"\n\t\t}\n\t\telse{\n\t\t\treturn \"Paid\"\n\t\t}\n\n\t}\n\n\n\tcheckIfRateZero(pos){\n\t\treturn pos.items.some(item => item.rate == 0)\n\t}\n\n\n\tonClosePOS(){\n\t\t//check if you still have an invoice to sync\n\t\tif(this.unsyncedPos > 0){\n\t\t\tfrappe.throw(__(`you have  some invoices to sync first.`))\n\t\t}\n\t\t//otherwise you can close the voucher\n\t\tlet voucher               = frappe.model.get_new_doc(\"POS Closing Entry\");\n\t\tvoucher.pos_opening_entry = this.POSOpeningEntry.name;\n\t\tvoucher.pos_profile       = this.POSOpeningEntry.pos_profile;\n\t\tvoucher.company           = this.POSOpeningEntry.company ;\n\t\tvoucher.user              = frappe.session.user  ;\n\t\tvoucher.posting_date      = frappe.datetime.now_date();\n\t\tvoucher.posting_time      = frappe.datetime.now_time();\n\n\t\tconst unsyncedChecks = this.check_in_out_cart.checkList.filter(check => check.is_sync === 0);\n\t\tunsyncedChecks.forEach(check => {\n\t\t\tlet child = frappe.model.add_child(voucher, 'check_in_out', 'custom_check_in_out')\n\t\t\tchild.check_type    = check.check_type\n\t\t\tchild.creation_time = check.creation_time\n\t\t\tchild.amount        = check.amount\n\t\t\tchild.reason_note   = check.reason_note\n\t\t\tchild.user          = check.owner\n\t\t})\n\n\t\t//frappe.set_route(\"Form\", \"POS Closing Entry\", voucher.name);\n\n\t\tfrappe.set_route(\"Form\", \"POS Closing Entry\", voucher.name).then(() => {\n\t\t\t// Block back navigation\n\t\t\twindow.addEventListener('popstate', (event) => {\n\t\t\t\tfrappe.set_route(\"Form\", \"POS Closing Entry\", voucher.name);\n\t\t\t});\n\t\t});\n\n\t\t//location.replace(frappe.utils.get_url_to_form(\"POS Closing Entry\", voucher.name));\n\n\t\t//delete the open entry because you create the closing entr,\n\t\t//that my the user submited it, so when the code find its name empty,\n\t\t//it will try to fetch an open pos entry if there is no one opening,\n\t\t//it will force the user to create one.\n\t\tthis.POSOpeningEntry.name = '' ;\n\t}\n\n\n\t/****************************  listeners *******************************/\n\n\tsetListeners(){\n\t\twindow.addEventListener('offline' , function(){\n\t\t\tfrappe.msgprint('you lose the connection (offline mode)')\n\t\t})\n\n\t\twindow.addEventListener('online' , function(){\n\t\t\tfrappe.msgprint('the connection is back (online mode)')\n\t\t})\n\t}\n\n\t/*****************************  tools  **********************************/\n\n\tmakePosInvoiceReturn(posInvoice){\n\t\tlet invoice = structuredClone(posInvoice)\n\n\t\tlet new_name = frappe.model.get_new_doc('POS Invoice').name;\n\n\t\tinvoice.name           = new_name\n\t\tinvoice.is_return      = 1;\n\t\tinvoice.return_against = posInvoice.real_name\n\t\tinvoice.real_name      = \"\"\n\t\tinvoice.consolidated_invoice = null\n\t\tinvoice.outstanding_amount = 0 ;\n\n\t\tlet newItems = []\n\t\tinvoice.items.forEach(item =>{\n\t\t\tif(item.qty > 0){\n\t\t\t\tlet newItem = structuredClone(item)\n\t\t\t\tnewItem.qty = newItem.qty * -1\n\t\t\t\tnewItem.description = \"Returned item\"\n\t\t\t\tnewItems.push(newItem)\n\t\t\t}\n\t\t})\n\t\tinvoice.items = newItems\n\n\n\t\tinvoice.pos_profile       = this.appData.appData.pos_profile.name\n\t\tinvoice.taxes_and_charges = this.appData.appData.pos_profile.taxes_and_charges\n\t\tinvoice.creation_time     = frappe.datetime.now_datetime()\n\t\tinvoice.payments          = this.getPaymentMethods()\n\t\tinvoice.priceList         = this.defaultPriceList.name\n\t\t//build refNm   posProfile-date-time\n\t\tconst date = new Date()\n\t\tconst [year,month,day] = date.toISOString().split('T')[0].split('-')\n\t\tconst hour    = date.getHours()\n\t\tconst minutes = date.getMinutes()\n\t\tconst seconds = date.getMilliseconds()\n\t\tinvoice.refNum            = this.appData.appData.pos_profile.name+\"-\"+year+'-'+month+'-'+day+'-'+hour+minutes+seconds\n\t\tinvoice.custom_cach_name  = invoice.refNum\n\n\t\treturn invoice\n\t}\n\n\ttoggleKeyboardMode(active){\n\n\n\t\tif(active){\n\t\t\tdocument.addEventListener('keydown', event =>{\n\t\t\t\t// Check if the user is typing in an input or textarea\n\t\t\t\tconst activeElement = document.activeElement;\n\t\t\t\tconst isInputFocused =\n\t\t\t\t\tactiveElement.tagName === \"INPUT\" ||\n\t\t\t\t\tactiveElement.tagName === \"TEXTAREA\" ||\n\t\t\t\t\tactiveElement.isContentEditable;\n\n\t\t\t\t// Ignore keydown events if the user is typing in a field\n\t\t\t\tif (isInputFocused) return;\n\n\t\t\t\tif(event.key == \"q\"){\n\t\t\t\t\tthis.selectedField.field_name = \"quantity\"\n\t\t\t\t\tthis.selected_item_cart.makeSelectedButtonHighlighted();\n\t\t\t\t}else if(event.key == \"p\"){\n\t\t\t\t\tthis.selectedField.field_name = \"rate\"\n\t\t\t\t\tthis.selected_item_cart.makeSelectedButtonHighlighted();\n\t\t\t\t}else if(event.key == \"Delete\"){\n\t\t\t\t\tthis.deleteItemFromPOsInvoice(this.selectedItem.name)\n\t\t\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\t\t\tthis.screenManager.navigate('home')\n\n\t\t\t\t}else if(event.key == \"Backspace\"){\n\t\t\t\t\tif(this.selectedField.field_name == \"quantity\"){\n\t\t\t\t\t\tconst lastValue = parseFloat(this.selectedItem.qty)\n\t\t\t\t\t\tlet newValue    = 0\n\n\t\t\t\t\t\t// Remove the last character and parse the remaining value\n\t\t\t\t\t\tnewValue = parseFloat(`${lastValue}`.slice(0, -1)) || 0;\n\n\t\t\t\t\t\tthis.selectedItem.qty = parseFloat(newValue);\n\t\t\t\t\t\tthis.editPosItemQty(this.selectedItem.name , this.selectedItem.qty);\n\t\t\t\t\t\t//redrawing\n\t\t\t\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\t\t\t}else if(this.selectedField.field_name == \"rate\"){\n\t\t\t\t\t\tconst lastValue = parseFloat(this.selectedItem.rate)\n\t\t\t\t\t\tlet newValue = parseFloat(`${lastValue}`.slice(0,-1)) || 0 ;\n\t\t\t\t\t\tthis.selectedItem.rate = parseFloat(newValue);\n\n\t\t\t\t\t\t//recalculate the rate\n\t\t\t\t\t\tlet oldRate = this.selectedItem.rate;\n\t\t\t\t\t\tlet persont = this.selectedItem.discount_percentage\n\t\t\t\t\t\tlet montant = oldRate * (persont / 100)\n\n\t\t\t\t\t\tthis.selectedItem.discount_percentage = persont;\n\t\t\t\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\t\t\t\tthis.editPosItemDiscountAmount(this.selectedItem.name , this.selectedItem.discount_amount);\n\t\t\t\t\t\tthis.editPosItemRate(this.selectedItem.name , this.selectedItem.rate);\n\n\t\t\t\t\t\t//redrawing\n\t\t\t\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\t\t\t\tthis.item_details.refreshDate(this.selectedItem);\n\t\t\t\t\t}\n\t\t\t\t}else if(this.selectedField.field_name == \"quantity\"){\n\t\t\t\t\tif(parseFloat(event.key) || event.key == \"0\" ){\n\t\t\t\t\t\tlet lastValue = 0\n\t\t\t\t\t\tif(!this.syncInput){\n\t\t\t\t\t\t\tlastValue      = 0\n\t\t\t\t\t\t\tthis.syncInput = true\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tlastValue = parseFloat(this.selectedItem.qty)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst newValue  = `${lastValue}` + event.key\n\t\t\t\t\t\tthis.selectedItem.qty = parseFloat(newValue);\n\t\t\t\t\t\tthis.editPosItemQty(this.selectedItem.name , this.selectedItem.qty);\n\t\t\t\t\t\t//redrawing\n\t\t\t\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\t\t\t}else if(event.key == \"-\"){\n\t\t\t\t\t\tthis.syncInput = true\n\t\t\t\t\t\tconst newValue = parseFloat(this.selectedItem.qty) * -1\n\t\t\t\t\t\tthis.selectedItem.qty = parseFloat(newValue);\n\t\t\t\t\t\tthis.editPosItemQty(this.selectedItem.name , this.selectedItem.qty);\n\t\t\t\t\t\t//redrawing\n\t\t\t\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\t\t\t}\n\t\t\t\t}else if(this.selectedField.field_name == \"rate\"){\n\t\t\t\t\tif(parseFloat(event.key) ||  event.key == \"0\"){\n\t\t\t\t\t\tlet lastValue = 0\n\t\t\t\t\t\tif(!this.syncInput){\n\t\t\t\t\t\t\tlastValue      = 0\n\t\t\t\t\t\t\tthis.syncInput = true\n\t\t\t\t\t\t}else{\n\t\t\t\t\t\t\tlastValue = parseFloat(this.selectedItem.rate)\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst newValue  = `${lastValue}` + event.key\n\t\t\t\t\t\tthis.selectedItem.rate = parseFloat(newValue);\n\n\t\t\t\t\t\t//recalculate the rate\n\t\t\t\t\t\tlet oldRate = this.selectedItem.rate;\n\t\t\t\t\t\tlet persont = this.selectedItem.discount_percentage\n\t\t\t\t\t\tlet montant = oldRate * (persont / 100)\n\n\t\t\t\t\t\tthis.selectedItem.discount_percentage = persont;\n\t\t\t\t\t\tthis.selectedItem.discount_amount     = montant;\n\n\t\t\t\t\t\tthis.editPosItemDiscountAmount(this.selectedItem.name , this.selectedItem.discount_amount);\n\t\t\t\t\t\tthis.editPosItemRate(this.selectedItem.name , this.selectedItem.rate);\n\n\t\t\t\t\t\t//redrawing\n\t\t\t\t\t\tthis.selected_item_cart.refreshSelectedItem();\n\t\t\t\t\t\tthis.item_details.refreshDate(this.selectedItem);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\n\t\t}else{\n\t\t\tdocument.removeEventListener('keydown' , event =>{})\n\t\t}\n\t}\n\n\n\tgetItemPrice(item , priceList){\n\t\t//check the mode\n\t\tconst mode = this.settings_data.settings.itemPriceBasedOn\n\n\t\tif(mode == 'brand'){\n\t\t\tif(item.brand == null)\n\t\t\t\treturn 0 ;\n\t\t\tconst price = this.appData.appData.item_prices.find(itemPrice => itemPrice.brand == item.brand && itemPrice.price_list == priceList)\n\t\t\treturn price ? price.price_list_rate  : 0\n\t\t}else if(mode == 'priceList'){\n\t\t\tconst price = this.appData.appData.item_prices.find(itemPrice => itemPrice.item_code == item.item_name && itemPrice.price_list == priceList)\n\t\t\treturn price ? price.price_list_rate  : 0\n\t\t}\n        }\n\n\tcheckServiceWorker(){\n\n\t\t// Check if service workers are supported\n\t\tif (!('serviceWorker' in navigator)) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Register the service worker on window load\n \t\twindow.addEventListener('DOMContentLoaded', () => {\n\t\tnavigator.serviceWorker\n\t\t\t.register('./sw.js')\n\t\t\t.then(reg => console.log(\"Service Worker registered successfully.\"))\n\t\t\t.catch(err => console.log(`Service Worker registration failed: ${err}`));\n\t\t});\n\n\n\t\tthis.sw = new pos_ar.PointOfSale.Sw()\n\n\t\t// Additionally, check if DOM is already loaded\n\t\tif (document.readyState === 'complete') {\n\t\t\tnavigator.serviceWorker\n\t\t\t\t.register('../assets/pos_ar/public/js/sw.js')\n\t\t\t\t.then(reg => console.log(\"Service Worker registered successfully.\"))\n\t\t\t\t.catch(err => console.log(`Service Worker registration failed: ${err}`));\n\t\t}\n\n\n\t}\n\n\tcheckUnSyncedPos(){\n\t\tthis.appData.getNotSyncedPosNumber(\n\t\t\t(result)=>{\n\t\t\t\tthis.unsyncedPos = result\n\t\t\t\tif(this.unsyncedPos == 0){\n\t\t\t\t\tthis.customer_box.setSynced(result);\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tthis.customer_box.setNotSynced(result);\n\t\t\t\t}\n\t\t\t},\n\t\t\t(err)=>{\n\t\t\t\tconsole.log(`error occured when check unSynced POS : ${err} `)\n\t\t\t}\n\t\t)\n\t}\n\n\taddItemToPosInvoice( clickedItem ){\n\t\tlet clonedItem = structuredClone(clickedItem) ;\n\n\t\tconst posInvoice = this.selectedItemMaps.get(this.selectedTab.tabName);\n\t\tconst posItems   = posInvoice.items;\n\n\t\tlet exist = false ;\n\n\t\tposItems.forEach(item => {\n\t\t\tif(item.name == clickedItem.name){\n\t\t\t\texist = true;\n\t\t\t\titem.qty += 1 ;\n\t\t\t\tconst clone = structuredClone(item)\n\t\t\t\tObject.assign(this.selectedItem , clone)\n\t\t\t}\n\t\t})\n\n\t\tif(!exist){\n\t\t\tclonedItem.item_code           = clonedItem.name ;\n\t\t\tclonedItem.discount_amount     = 0 ;\n\t\t\tclonedItem.discount_percentage = 0 ;\n\t\t\tclonedItem.qty                 = 1 ;\n\t\t\tclonedItem.rate                = this.getItemPrice(clickedItem , this.selectedItemMaps.get(this.selectedTab.tabName).priceList);\n\t\t\tposItems.push(clonedItem)\n\n\t\t\tconst clone = structuredClone(clonedItem)\n\t\t\tObject.assign(this.selectedItem , clone)\n\n\t\t}\n\n\t}\n\n\tdeleteItemFromPOsInvoice( itemId ){\n\t\tconst posInvoice = this.selectedItemMaps.get(this.selectedTab.tabName);\n\t\tconst posItems   = posInvoice.items ;\n\n\t\tposInvoice.items  = posItems.filter( item => item.name != itemId )\n\n\t\tthis.selectedItem = structuredClone({ name : \"\"})\n\t}\n\n\teditPosItemQty(itemName , qty){\n\t\tlet items = this.selectedItemMaps.get(this.selectedTab.tabName).items\n\t\titems.forEach(item => {\n\t\t\tif(item.name == itemName){\n\t\t\t\titem.qty = qty\n\t\t\t}\n\t\t})\n\t}\n\teditPosItemRate(itemName , rate){\n\t\tlet items = this.selectedItemMaps.get(this.selectedTab.tabName).items\n\t\titems.forEach(item => {\n\t\t\tif(item.name == itemName){\n\t\t\t\titem.rate = rate\n\t\t\t}\n\t\t})\n\t}\n\teditPosItemDiscountPercentage(itemName , discountPercentage){\n\t\tlet items = this.selectedItemMaps.get(this.selectedTab.tabName).items\n\t\titems.forEach(item => {\n\t\t\tif(item.name == itemName){\n\t\t\t\titem.discount_percentage = discountPercentage\n\t\t\t}\n\t\t})\n\t}\n\teditPosItemDiscountAmount(itemName , discountAmount){\n\t\tlet items = this.selectedItemMaps.get(this.selectedTab.tabName).items\n\t\titems.forEach(item => {\n\t\t\tif(item.name == itemName){\n\t\t\t\titem.discount_amount = discountAmount\n\t\t\t}\n\t\t})\n\t}\n\n\tcalculatePaidAmount(posInvoice){\n\t\tlet paidAmountDA = 0;\n\t\tposInvoice.payments.forEach(mode =>{\n\t\t\tpaidAmountDA += mode.amount\n\t\t})\n\t\treturn paidAmountDA\n\t}\n\n};\n", "pos_ar.PointOfSale.pos_item_selector = class {\n\n\tconstructor(\n\t\twrapper           ,\n\t\titem_list         ,\n\t\titemBarcodes      ,\n\t\titem_group_list   ,\n\t\titem_prices       ,\n\t\tsettingsData      ,\n\t\tselectedPriceList ,\n\t\tgetItemPrice      ,\n\t\tautoSelect        ,\n\t\tonItemClick\n\t){\n\t\tthis.wrapper             = wrapper           ;\n\t\tthis.item_list           = item_list         ;\n\t\tthis.item_barcodes       = itemBarcodes      ;\n\t\tthis.item_group_list     = item_group_list   ;\n\t\tthis.item_prices         = item_prices       ;\n\t\tthis.settings_data       = settingsData      ;\n\t\tthis.selected_price_list = selectedPriceList ;\n\t\tthis.get_item_price      = getItemPrice      ;\n\t\tthis.auto_select         = autoSelect        ;\n\t\tthis.on_item_click       = onItemClick       ;\n\n\t\t// Create barcode lookup map for O(1) access, storing arrays of parent IDs\n\t\tthis.barcode_map = {};\n\t\tthis.item_barcodes.forEach(barcode => {\n\t\t\tif (!this.barcode_map[barcode.barcode]) {\n\t\t\t\tthis.barcode_map[barcode.barcode] = [];\n\t\t\t}\n\t\t\tthis.barcode_map[barcode.barcode].push(barcode.parent);\n\t\t});\n\n\t\t//class functions invocation\n\t\tthis.start_item_selector();\n    }\n\n\n\tstart_item_selector(){\n\t\tthis.prepare_select_box();\n\t\tthis.setItemGroupsInList();\n\t\tthis.setItemInFlow(this.getItemByItemGroup(\"\"))\n\t\tthis.setListeners();\n\t}\n\n\trefresh(){\n\t\tthis.setItemInFlow(this.getItemByItemGroup(\"\"))\n\t}\n\n\t/***********************  ui  functions  ***************************************/\n\tprepare_select_box(){\n\t\tthis.wrapper.append('<div id=\"SelectorBox\" class=\"columnBox\" ></div>')\n\n\t\tthis.selectorBox  = this.wrapper.find(\"#SelectorBox\");\n\t\tthis.selectorBox.append('<div id=\"selectorBoxHeader\" class=\"rowBox header\"></div>')\n\n\t\tthis.header       = this.selectorBox.find(\"#selectorBoxHeader\");\n\t\tthis.header.append('<h4 class=\"CartTitle\">Items</h4>')\n\t\tthis.header.append('<div id=\"inputsBox\" class=\"rowBox align_center\"></div>')\n\n\t\tthis.inputBox     = this.header.find(\"#inputsBox\");\n\t\tthis.inputBox.append('<input type=\"text\" autocomplete=\"off\"  maxlength=\"140\" placeholder=\"Search by item code, item name or barcode\" id=\"ItemInput\" name=\"item\" placeHolder=\"Enter the customer\">')\n\t\tthis.inputBox.append('<input list=\"ItemGroupList\"  id=\"ItemGroupInput\" name=\"ItemGroup\" placeHolder=\"Item Group\">')\n\t\tthis.inputBox.append('<datalist id=\"ItemGroupList\"></datalist>')\n\n\t\tthis.itemGroupList = this.inputBox.find(\"#ItemGroupList\");\n\t\tthis.itemGroupList.append('<option>fetching Item Groups ...</option>')\n\n\t\tif(!this.settings_data.search_by_group){\n\t\t\tconsole.log(\" see settings \" , this.settings_data)\n\t\t\tthis.inputBox.find(\"#ItemGroupInput\").hide();\n\t\t}\n\n\t\tthis.selectorBox.append('<div id=\"itemsContainer\" class=\"rowBox row_wrap\"></div>')\n\t\tthis.itemsContainer = this.selectorBox.find('#itemsContainer')\n\t}\n\n\n\tsetItemGroupsInList(){\n\t\tconst groupItemList_html = document.getElementById(\"ItemGroupList\");\n\t\tgroupItemList_html.innerHTML = \"\" ;\n\t\tthis.item_group_list.forEach(group_item =>{\n\t\t\tconst option = document.createElement(\"option\");\n\t\t\toption.value = group_item.name;\n\t\t\toption.textContent = group_item.customer_name;\n\t\t\tgroupItemList_html.appendChild(option);\n\t\t})\n\t}\n\n\trefreshItemSelector(){\n\t\tconst seachField = document.getElementById(\"ItemInput\");\n\t\tseachField.value = \"\";\n\n\t\tconst groupItemListInput = document.getElementById(\"ItemGroupInput\");\n\t\tthis.setItemInFlow(this.getItemByItemGroup(groupItemListInput.value));\n\t}\n\tsetItemInFlow(filtered_item_list){\n        const itemsContainer_html = document.getElementById(\"itemsContainer\");\n        itemsContainer_html.innerHTML = \"\";\n\t\tconst itemInput = document.getElementById(\"ItemInput\");\n\n\t\tif (filtered_item_list.length === 0) {\n\t\t\titemsContainer_html.innerHTML = `\n\t\t\t\t<div class=\"no-items-found\">\n\t\t\t\t\t<svg width=\"64\" height=\"64\" viewBox=\"0 0 24 24\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\">\n\t\t\t\t\t\t<path d=\"M15.5 15.5L19 19\" stroke=\"#9CA3AF\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n\t\t\t\t\t\t<path d=\"M5 11C5 14.3137 7.68629 17 11 17C12.6597 17 14.1621 16.3261 15.2483 15.2483C16.3261 14.1621 17 12.6597 17 11C17 7.68629 14.3137 5 11 5C7.68629 5 5 7.68629 5 11Z\" stroke=\"#9CA3AF\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"/>\n\t\t\t\t\t</svg>\n\t\t\t\t\t<p>No items found</p>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t\treturn;\n\t\t}\n\n\t\tfor(let i=0 ; i<filtered_item_list.length && i<300 ; i++){\n\n\t\t\tlet item = filtered_item_list[i];\n                \tconst itemBox = document.createElement(\"div\");\n                \titemBox.classList.add(\"itemBox\");\n                \titemBox.classList.add(\"columnBox\");\n                \titemBox.classList.add(\"C_A_Center\");\n\n                \titemBox.addEventListener('click' , event => {\n\t\t\t\tconst isNotImpty = itemInput.value.length > 0;\n\t\t\t\tthis.on_item_click(item, isNotImpty);\n\t\t\t});\n\n\t\t\tconst imageUrl = item.image || '/assets/pos_ar/images/no_image.png';\n\t\t\tconst price = this.get_item_price(item, this.selected_price_list.name);\n\n            itemBox.innerHTML = `\n\t\t\t\t<img class=\"itemImage\" src=\"${imageUrl}\" alt=\"${item.item_name}\" onerror=\"this.src='/assets/pos_ar/images/no_image.png'\">\n\t\t\t\t<div class=\"itemTitle\">${item.item_name}</div>\n\t\t\t\t<div class=\"itemPrice\">${price} DA</div>\n\t\t\t`;\n\n                \titemsContainer_html.appendChild(itemBox);\n\t\t}\n\n\t\tif (filtered_item_list.length >= 700) {\n\t\t\titemsContainer_html.insertAdjacentHTML('beforeend', `\n\t\t\t\t<div class=\"more-items-notice\">\n\t\t\t\t\t<p>Showing first 700 items. Please refine your search to see more specific results.</p>\n\t\t\t\t</div>\n\t\t\t`);\n\t\t}\n\t}\n\n\n\t//show and hide\n\tshowCart(){\n\t\tthis.selectorBox.css(\"display\" , \"flex\")\n\t}\n\n\thideCart(){\n\t\tthis.selectorBox.css(\"display\" , \"none\")\n\t}\n\n\t//**************** set listeners method ****************************//\n\tsetListeners(){\n\t\tconst groupItemListInput = document.getElementById(\"ItemGroupInput\");\n        \tgroupItemListInput.addEventListener('input' , (even)=>{\n\t\t\tthis.setItemInFlow(this.getItemByItemGroup(event.target.value))\n\t\t})\n\n\t\tconst itemInput = document.getElementById(\"ItemInput\");\n\t\titemInput.addEventListener('input' , (event)=>{\n\t\t\tthis.setItemInFlow(this.filterListByItemData(event.target.value))\n\t\t})\n\t}\n\n\t//**************** tools method ****************************//\n\n\t//filter list by item code or barcode\n\tfilterListByItemData(value){\n\t\t// Direct O(1) lookup from barcode map\n\t\tconst itemIds = this.barcode_map[value];\n\t\tif(itemIds && itemIds.length > 0) {\n\t\t\t// Found barcode match(es)\n\t\t\tconst items = this.item_list.filter(item => itemIds.includes(item.name));\n\t\t\tif(items.length === 1) {\n\t\t\t\t// If only one item, auto-select it\n\t\t\t\tthis.auto_select(items[0]);\n\t\t\t\tconst itemInput = document.getElementById(\"ItemInput\");\n\t\t\t\titemInput.value = '';\n\t\t\t\treturn this.item_list;\n\t\t\t} else if(items.length > 1) {\n\t\t\t\t// If multiple items with same barcode, show only those items\n\t\t\t\treturn items;\n\t\t\t}\n\t\t}\n\n\t\t// If no barcode match or no items found, search by item name\n\t\treturn this.item_list.filter(item => \n\t\t\titem.item_name.toLowerCase().includes(value.toLowerCase())\n\t\t);\n\t}\n\n\n\tgetItemByItemGroup(item_group){\n\n\n\t\tlet groups = [];\n\n\t\tlet getChild = (grp)=>{\n\t\t\tgroups.push(grp);\n\t\t\tthis.item_group_list.forEach(g=>{\n\t\t\t\tif(g.parent_item_group == grp){\n\t\t\t\t\tgroups.push(g.name)\n\t\t\t\t\tif(g.is_group){\n\t\t\t\t\t\tgetChild(g.name)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t};\n\n\n\t\tgetChild(item_group);\n\n\n\t\tlet filtredItemList = [];\n\n\t\tlet getFiltredItems = (group)=>{\n\t\t\tthis.item_list.forEach(item =>{\n\t\t\t\tif(item.item_group == group){\n\t\t\t\t\tfiltredItemList.push(item);\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\n\n\t\tgroups.forEach(group =>{\n\t\t\tgetFiltredItems(group);\n\t\t})\n\n\n\t\treturn filtredItemList ;\n\t}\n}\n", "pos_ar.PointOfSale.pos_customer_box = class{\n\n\tconstructor(\n\t\twrapper          ,\n\t\tcustomersList    ,\n\t\tselectedCustomer ,\n\t\tbackHome         ,\n\t\tonSync           ,\n\t\tsaveCheckInOut   ,\n\t\tonMenuClick      ,\n\t\tonDebtClick      ,\n\t){\n\t\tthis.wrapper           = wrapper          ;\n\t\tthis.customers_list    = customersList    ;\n\t\tthis.selected_customer = selectedCustomer ;\n\t\tthis.back_home         = backHome         ;\n\t\tthis.on_sync           = onSync           ;\n\t\tthis.on_menu_click     = onMenuClick      ;\n\t\tthis.save_check_in_out = saveCheckInOut   ;\n\t\tthis.on_debt_click     = onDebtClick      ;\n\n\t\t//local\n\t\tthis.online       = true  ;\n\t\tthis.show_menu    = false ;\n\n\t\tthis.start_work()      ;\n\t}\n\n\tstart_work(){\n\t\tthis.prepare_customer_box();\n\t\tthis.checkForSync();\n\t\tthis.setListeners();\n\t}\n\n\tprepare_customer_box(){\n\n\t\tthis.wrapper.append('<div id=\"ActionsContainerBox\">')\n\t\tthis.actionContainer = this.wrapper.find('#ActionsContainerBox')\n\n\t\t// Sync button\n\t\tthis.actionContainer.append(`\n\t\t\t<div id=\"SyncBox\" class=\"action-btn\">\n\t\t\t\t<span id=\"syncBoxContent\">Sync</span>\n\t\t\t</div>\n\t\t`)\n\n\t\t// Home button\n\t\tthis.actionContainer.append(`\n\t\t\t<div id=\"HomeBox\" class=\"action-btn\" style=\"display:none;\">\n\t\t\t\t<img src=\"/assets/pos_ar/images/home.png\" alt=\"Home\">\n\t\t\t</div>\n\t\t`)\n\n\t\t// Debt button\n\t\tthis.actionContainer.append(`\n\t\t\t<div id=\"DebtBox\" class=\"action-btn\">\n\t\t\t\t<img src=\"/assets/pos_ar/images/debt.png\" alt=\"Debt\">\n\t\t\t</div>\n\t\t`)\n\n\t\t// Exchange button\n\t\tthis.actionContainer.append(`\n\t\t\t<div id=\"exchangeBtn\" class=\"action-btn\">\n\t\t\t\t<img src=\"/assets/pos_ar/images/exchange.png\" alt=\"Exchange\">\n\t\t\t</div>\n\t\t`)\n\n\t\t// Menu button\n\t\tthis.actionContainer.append(`\n\t\t\t<div id=\"MenuBox\" class=\"action-btn\">\n\t\t\t\t<img src=\"/assets/pos_ar/images/menu.png\" alt=\"Menu\">\n\t\t\t\t<div id=\"menuItemsContainer\">\n\t\t\t\t\t<div id=\"posInvoiceMenuItem\"       class=\"menuItem\">Recent POS Invoices</div>\n\t\t\t\t\t<div id=\"checkInOutMenuItem\"       class=\"menuItem\">Check In/Out</div>\n\t\t\t\t\t<div id=\"unsencedInvoicesMenuItem\" class=\"menuItem\">Unsenced invoices</div>\n\t\t\t\t\t<div id=\"closePosMenuItem\"         class=\"menuItem\">Close the POS</div>\n\t\t\t\t\t<div id=\"settingMenuItem\"          class=\"menuItem\">About</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`)\n\n\t\t// Initialize button references\n\t\tthis.sync_btn = this.actionContainer.find('#SyncBox')\n\t\tthis.sync_btn_content = this.sync_btn.find('#syncBoxContent')\n\t\tthis.home = this.actionContainer.find('#HomeBox')\n\t\tthis.debt = this.actionContainer.find('#DebtBox')\n\t\tthis.exchange_btn = this.actionContainer.find('#exchangeBtn')\n\t\tthis.menu = this.actionContainer.find('#MenuBox')\n\t\tthis.menuItemsContainer = this.actionContainer.find('#menuItemsContainer')\n\t\tthis.pos_invoices       = this.menuItemsContainer.find('#posInvoiceMenuItem')\n\t\tthis.check_in_out       = this.menuItemsContainer.find('#checkInOutMenuItem')\n\t\tthis.close_pos          = this.menuItemsContainer.find('#closePosMenuItem')\n\t\tthis.unsenced_invoices  = this.menuItemsContainer.find('#unsencedInvoicesMenuItem')\n\t\tthis.setting            = this.menuItemsContainer.find('#settingMenuItem')\n\n\t\t//check in out dialog\n\t\tthis.wrapper.append('<div id=\"darkFloatingBackground\"></div>')\n\t\tthis.dark_floating_background = this.wrapper.find('#darkFloatingBackground');\n\n\t\tthis.wrapper.append(`\n\t\t\t<div id=\"checkInOutDialog\">\n\t\t\t\t<div class=\"dialog-header\">\n\t\t\t\t\t<h2>Add Transaction</h2>\n\t\t\t\t</div>\n\t\t\t\t<div id=\"checkTypeContainer\">\n\t\t\t\t\t<div id=\"checkInType\" class=\"rowBox centerItem checkType selected\">\n\t\t\t\t\t\t<div class=\"type-icon\">\n\t\t\t\t\t\t\t<img src=\"/assets/pos_ar/images/arrow.png\" style=\"transform: rotate(180deg);\" alt=\"In\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"type-text\">Check In</div>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div id=\"checkOutType\" class=\"rowBox centerItem checkType\">\n\t\t\t\t\t\t<div class=\"type-icon\">\n\t\t\t\t\t\t\t<img src=\"/assets/pos_ar/images/arrow.png\" alt=\"Out\">\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"type-text\">Check Out</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"inputGroup\">\n\t\t\t\t\t<label for=\"check_in_out_input\">Amount</label>\n\t\t\t\t\t<input autocomplete=\"off\" required type=\"number\" id=\"check_in_out_input\" placeholder=\"Enter amount\">\n\t\t\t\t</div>\n\t\t\t\t<div class=\"inputGroup\">\n\t\t\t\t\t<label for=\"check_in_out_note_textarea\">Reason</label>\n\t\t\t\t\t<textarea id=\"check_in_out_note_textarea\" placeholder=\"Enter reason for transaction\"></textarea>\n\t\t\t\t</div>\n\t\t\t\t<div id=\"btnsContainers\" class=\"rowBox\">\n\t\t\t\t\t<button id=\"cancelBtn\" class=\"dialogBtn rowBox centerItem\">Cancel</button>\n\t\t\t\t\t<button id=\"confirmBtn\" class=\"dialogBtn rowBox centerItem\">Confirm</button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t`)\n\t\tthis.check_in_out_dialog = this.wrapper.find('#checkInOutDialog');\n\t\tthis.check_in_out_dialog.css('flex-direction','column')\n\n\t\tthis.check_type_container = this.check_in_out_dialog.find('#checkTypeContainer')\n\t\tthis.check_in_box  = this.check_type_container.find('#checkInType')\n\t\tthis.check_out_box = this.check_type_container.find('#checkOutType')\n\t\tthis.check_in_out_type = 'In'\n\t\tthis.check_in_out_input = this.check_in_out_dialog.find('#check_in_out_input');\n\t\tthis.check_in_out_note  = this.check_in_out_dialog.find('#check_in_out_note_textarea');\n\t\tthis.cancel_dialog_btn = this.check_in_out_dialog.find('#cancelBtn')\n\t\tthis.confirm_dialog_btn = this.check_in_out_dialog.find('#confirmBtn')\n\t}\n\n\n\t//show and hide\n\tshowHomeBar(){\n\t\tthis.home.css('display' , 'flex');\n\t}\n\thideHomeBar(){\n\t\tthis.home.css('display' , 'none');\n\t}\n\tshowSyncBar(){\n\t\tthis.sync_btn.css('display' , 'flex');\n\t}\n\thideSyncBar(){\n\t\tthis.sync_btn.css('display' , 'none');\n\t}\n\n\tshowCheckInOutDialog(){\n\t\tthis.check_in_out_dialog.css('display','flex')\n\t\tthis.dark_floating_background.css('display','flex')\n\t}\n\thideCheckInOutDialog(){\n\t\tthis.checkAmount = 0 ;\n\t\tthis.check_in_out_dialog.css('display','none')\n\t\tthis.dark_floating_background.css('display','none')\n\t\tthis.check_in_out_input.val(0)\n\t}\n\n\n\tcheckForSync(){\n\t\tthis.sync_btn.addClass('Synced');\n\t}\n\n\tsetListeners(){\n\n\t\tthis.sync_btn.on('click' , (event)=>{\n\t\t\tfrappe.confirm('Are you sure you want to sync',\n\t\t\t()=>{\n\t\t\t\tthis.on_sync();\n\t\t\t},\n\t\t\t()=>{\n\t\t\t\treturn;\n\t\t\t})\n\t\t})\n\n\t\tthis.close_pos.on('click' , (event)=>{\n\t\t\tthis.on_menu_click('close_pos');\n\t\t})\n\n\t\tthis.unsenced_invoices.on('click' , (event)=>{\n\t\t\tthis.on_menu_click('unsenced_invoices');\n\t\t})\n\n\t\tthis.pos_invoices.on('click' , (event)=>{\n\t\t\tthis.on_menu_click('recent_pos');\n\t\t})\n\n\t\tthis.setting.on('click' , (event)=>{\n\t\t\tthis.on_menu_click('settings');\n\t\t})\n\n\t\tthis.check_in_out.on('click' , (event)=>{\n\t\t\tthis.on_menu_click('checkInOut');\n\t\t})\n\n\n\t\tthis.menu.on('click' , (event)=>{\n\n\t\t\tif(this.show_menu){\n\t\t\t\tthis.show_menu = !this.show_menu\n\t\t\t\tthis.menuItemsContainer.css('visibility' , 'hidden')\n\t\t\t\tthis.menuItemsContainer.css('opacity' , '0')\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.show_menu = !this.show_menu\n\t\t\t\tthis.menuItemsContainer.css('visibility' , 'visible')\n\t\t\t\tthis.menuItemsContainer.css('opacity' , '1')\n\t\t\t}\n\n\t\t})\n\n\t\tthis.home.on('click' , (event)=>{\n\t\t\tthis.back_home()\n\t\t})\n\n\t\tthis.debt.on('click' , (event)=>{\n\t\t\tthis.on_debt_click()\n\t\t})\n\n\t\tthis.exchange_btn.on('click' , (event)=>{\n\t\t\tthis.showCheckInOutDialog();\n\t\t})\n\n\t\tthis.dark_floating_background.on('click' , (event)=>{\n\t\t\tthis.hideCheckInOutDialog();\n\t\t})\n\n\t\tthis.check_in_box.on('click', (event) => {\n\t\t\tthis.check_in_out_type = 'In';\n\t\t\tthis.check_in_box.addClass('selected');\n\t\t\tthis.check_out_box.removeClass('selected');\n\t\t})\n\n\t\tthis.check_out_box.on('click', (event) => {\n\t\t\tthis.check_in_out_type = 'Out';\n\t\t\tthis.check_out_box.addClass('selected');\n\t\t\tthis.check_in_box.removeClass('selected');\n\t\t})\n\n\t\tthis.check_in_out_input.on('input' , (event)=>{\n\t\t})\n\n\t\tthis.cancel_dialog_btn.on('click' , (event)=>{\n\t\t\tconsole.log(\"cancel\")\n\t\t\tthis.hideCheckInOutDialog();\n\t\t})\n\t\tthis.confirm_dialog_btn.on('click' , (event)=>{\n\t\t\tconst checkInOut         = frappe.model.get_new_doc('check_in_out')\n\t\t\tcheckInOut.creation_time = frappe.datetime.now_datetime();\n\t\t\tcheckInOut.user          = frappe.session.user;\n\t\t\tcheckInOut.check_type    = this.check_in_out_type;\n\t\t\tcheckInOut.amount        = parseFloat(this.check_in_out_input.val());\n\t\t\tcheckInOut.reason_note   = this.check_in_out_note.val()\n\t\t\t//valid inputs\n\t\t\tif(parseFloat(this.check_in_out_input.val()) <= 0 || this.check_in_out_note.val() == ''){\n\t\t\t\tfrappe.msgprint('you should fulfilled fileds.')\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.save_check_in_out(checkInOut);\n\t\t\tthis.hideCheckInOutDialog();\n\t\t\tconsole.log('checkInOut : ' , checkInOut);\n\t\t})\n\t}\n\n\tsetSynced(){\n\t\tthis.sync_btn.addClass('Synced')\n\t\tthis.sync_btn.removeClass('NotSynced')\n\t\tthis.sync_btn_content.html(`Synced`)\n\t}\n\n\tsetNotSynced(counter){\n\t\tthis.sync_btn.addClass('NotSynced')\n\t\tthis.sync_btn.removeClass('Synced')\n\t\tthis.sync_btn_content.html(`Sync (${counter})`)\n\t}\n\n\n\n\n\n}\n", "\npos_ar.PointOfSale.pos_selected_item_cart = class{\n\n\tconstructor(\n\t\twrapper            ,\n\t\tsettingsData       ,\n\t\tselectedItemMaps   ,\n\t\tpriceLists         ,\n\t\tcustomerList       ,\n\t\tbrandList          ,\n\t\tsalesTaxes         ,\n\t\tinvoiceData        ,\n\t\tselectedTab        ,\n\t\tselectedItem       ,\n\t\tselectedField      ,\n\t\tgetItemPrice       ,\n\t\tonSelectedItemClick,\n\t\tonTabClick         ,\n\t\tonKeyPressed       ,\n\t\tcreateNewTab       ,\n\t\tonCheckoutClick    ,\n\t\tsavePosInvoice     ,\n\t\tdb                 ,\n\t){\n\n\n\t\tthis.wrapper                 = wrapper         ;\n\t\tthis.settings_data           = settingsData    ;\n\t\tthis.selected_item_maps      = selectedItemMaps;\n\t\tthis.price_lists             = priceLists      ;\n\t\tthis.customer_list           = customerList    ;\n\t\tthis.brand_list              = brandList       ;\n\t\tthis.sales_taxes             = salesTaxes      ;\n\t\tthis.invoice_data            = invoiceData     ;\n\t\tthis.selected_tab            = selectedTab     ;\n\t\tthis.selected_item           = selectedItem    ;\n\t\tthis.selected_field          = selectedField   ;\n\t\tthis.get_item_price          = getItemPrice    ;\n\t\tthis.on_key_pressed          = onKeyPressed    ;\n\t\tthis.on_checkout_click       = onCheckoutClick ;\n\t\tthis.on_selected_item_click  = onSelectedItemClick;\n\t\tthis.on_tab_click            = onTabClick      ;\n\t\tthis.create_new_tab          = createNewTab    ;\n\t\tthis.save_pos_invoice        = savePosInvoice  ;\n\t\tthis.db                      = db              ;\n\t\t//local\n\t\tthis.taxes_map   = new Map();\n\t\tthis.total_tax_amout = 0 ;\n\t\tthis.counter    = 1 ;\n\t\tthis.show_discount = false ;\n\n\t\tthis.start_work();\n\t}\n\n\n\n\t// start the class function\n\tstart_work(){\n\t\tthis.prepare_selected_item_cart();\n\t\tthis.fulfillingSelects();\n\t\tthis.setButtonsListeners();\n\t\tthis.setListener()\n\t}\n\n\t/********************************* ui *****************************************/\n\n\tprepare_selected_item_cart(){\n\n\t\t//styles\n\t\tlet containerBoxStyle   = ''\n\t\tlet containerStyle = ''\n\t\tlet btnStyle       = ''\n\t\tlet checkoutBtn    = ''\n\n\n\t\tif(this.settings_data.settings.keyboardStyle == this.settings_data.keyboard_styles[0]){\n\t\t\tcontainerBoxStyle   =\n\t\t\t\t'margin:0px 16px;padding:0px 0px 16px 0px;'\n\t\t\tcontainerStyle =\n\t\t\t\t'width:100%;display:grid;grid-template-columns:auto auto auto auto;'\n\t\t\tbtnStyle =\n\t\t\t\t'height:45px;padding:4px;margin:6px;background:#f5f5f5;border:2px solid #e0e0e0;border-radius:12px;'+\n\t\t\t\t'color:black;font-size:small;text-align:center;'+\n\t\t\t\t'display:flex;justify-content:center;align-items:center;'\n\t\t\tcheckoutBtn =\n\t\t\t\t'width:calc(100% - 32px);margin:0px 16px 16px 16px;padding : 8px 0px ;'+\n\t\t\t\t'color:#FFFFFF;font-size:larger;font-weight:600;'+\n\t\t\t\t'background:#44A292;border:3px solid #2D6B61;border-radius:8px;outline:none;'\n\t\t}\n\t\telse{\n\t\t\tcontainerBoxStyle   =\n\t\t\t\t'width:100%;'\n\t\t\tcontainerStyle =\n\t\t\t\t'width:100%;display:grid;grid-template-columns:auto auto auto auto;'\n\n\t\t\tbtnStyle = 'height:45px;padding:4px;background:#f5f5f5;border:1px solid #a0a0a0;color:black;font-size:small;text-align:center;display:flex;justify-content:center;align-items:center;'\n\t\t\tcheckoutBtn =\n\t\t\t\t'width:100%;height:55px;'+\n\t\t\t\t'color:#FFFFFF;font-size:19px;font-weight:600;'+\n\t\t\t\t'background:#44A292;border:none;outline:none;'\n\t\t}\n\n\n\n\t\tthis.wrapper.append('<div id=\"tabs\"    class=\"rowBox\"><div id=\"tabs_container\" class=\"rowBox\" style=\"overflow-x:auto;overflow-y:hidden;\" ></div></div>')\n\t\tthis.wrapper.append('<div id=\"CartBox\" class=\"columnBox\"></div>')\n\n\n\t\tthis.tabs_bar       = this.wrapper.find(\"#tabs\")\n\t\tthis.tabs_container = this.tabs_bar.find('#tabs_container')\n\t\tthis.cartBox        = this.wrapper.find(\"#CartBox\")\n\n\n\t\tthis.tabs_container.append('<div class=\"tab selected rowBox align_center\"><div class=\"tabName\">C1</div><img src=\"/assets/pos_ar/images/cancel.png\" width=\"10px\" height=\"10px\" class=\"tabDeleteBtn\"></div>')\n\t\tthis.tabs_bar.append('<div id=\"addTabBtn\" class=\"tab unselected\">+</div>')\n\n\n\t\tthis.add_tab_button = this.tabs_bar.find('#addTabBtn')\n\n\t\tthis.cartBox.append('<div id=\"CartBoxTopBar\" class=\" rowBox align_center  row_sbtw\"><div>')\n\t\tthis.cartBox.append('<div id=\"cartHeader\" class=\"rowBox row_sbtw align_center\"></div>')\n\t\tthis.cartBox.append('<div id=\"selectedItemsContainer\" class=\"columnBox\"></div>')\n\t\tthis.cartBox.append('<div id=\"cartFooter\" class=\"columnBox\"></div>')\n\n\t\tthis.cartTopBar = this.cartBox.find('#CartBoxTopBar')\n\t\tthis.cartTopBar.append('<div id=\"selectedCustomerInput\"></div>')\n\t\tthis.cartTopBar.append('<div id=\"selectedBrandInput\"></div>')\n\t\tthis.cartTopBar.append('<div id=\"selectedItemsPriceListInput\"></div>')\n\n\t\tthis.customerInputContainer = this.cartTopBar.find(\"#selectedCustomerInput\")\n\t\tthis.customerInputContainer.append('<select  id=\"customerInput\"  placeHolder=\"Choice a customer\">')\n\t\tthis.customerInput = this.customerInputContainer.find('#customerInput')\n\n\t\tthis.priceListInputContainer = this.cartTopBar.find(\"#selectedItemsPriceListInput\")\n\t\tthis.priceListInputContainer.append('<select  id=\"PriceListInput\" name=\"PriceList\" placeHolder=\"Choice a Price list\">')\n\t\tthis.priceListInput = this.priceListInputContainer.find('#PriceListInput')\n\n\t\tthis.cartHeader = this.cartBox.find('#cartHeader')\n\t\tthis.cartHeader.append('<div style=\"font-size:16px;font-weight:600;\"><p>Item</p></div>')\n\t\tthis.cartHeader.append('<div id=\"cartHeaderTitles\" class=\"rowBox\"></div>')\n\n\t\tthis.cartHeaderTitles = this.cartHeader.find('#cartHeaderTitles')\n\t\tthis.cartHeaderTitles.append('<div id=\"quantityTitle\" style=\"font-size:16px;font-weight:600;margin-right:16px;\" >  <p>Quantity</p></div>')\n\t\tthis.cartHeaderTitles.append('<div id=\"amountTitle\"   style=\"font-size:16px;font-weight:600;\" >  <p>Amount  </p></div>')\n\n\t\tthis.selectedItemContainer = this.cartBox.find('#selectedItemsContainer')\n\n\t\tthis.cartFooter    = this.cartBox.find('#cartFooter')\n\t\tthis.cartFooter.append('<div id=\"cartDetails\" class=\"columnBox\"></div>')\n\t\tthis.cartFooter.append(`<div id=\"editSelectedItemCart\" style=\"${containerBoxStyle}\"></div>`)\n\t\tthis.cartFooter.append(`<div id=\"mainBtnContainer\" class=\"rowBox centerItem\"  style=\"${checkoutBtn}\">  </div>`)\n\n\t\tthis.cartDetails   = this.cartFooter.find('#cartDetails')\n\n\t\tthis.cartDetails.append('<div id=\"discount\" class=\"rowBox align_center row_sbtw\"></div>')\n\t\tthis.cartDetails.append('<div id=\"totalQuantity\" class=\"rowBox align_center row_sbtw\"></div>')\n\t\tthis.cartDetails.append('<div id=\"netTotal\" class=\"rowBox align_center row_sbtw\"></div>')\n\t\tthis.cartDetails.append('<div id=\"VAT\" class=\"columnBox\"></div>')\n\t\tthis.cartDetails.append('<div id=\"grandTotal\" class=\"rowBox align_center row_sbtw\"></div>')\n\n\t\tthis.discount      = this.cartDetails.find('#discount')\n\t\tthis.discount.append('<div id=\"addDiscountTitle\">Add Discount % </div>')\n\t\tthis.discount.append('<input type=\"number\" id=\"addGlobalDiscountInput\" value=\"0\" step=\"1\" min=\"0\" max=\"100\" >')\n\t\tthis.discountInput = this.discount.find('#addGlobalDiscountInput')\n\t\tthis.discountTitle = this.discount.find('#addDiscountTitle')\n\n\n\t\tthis.totalQuantity = this.cartDetails.find('#totalQuantity')\n\t\tthis.totalQuantity.append('<div id=\"totalQuantityTitle\">Total Quantity</div>')\n\t\tthis.totalQuantity.append('<div id=\"totalQuantityValue\">0</div>')\n\n\t\tthis.netTotal      = this.cartDetails.find('#netTotal')\n\t\tthis.netTotal.append('<div id=\"netTotalTitle\">Net Total</div>')\n\t\tthis.netTotal.append('<div id=\"netTotalValue\">0.00</div>')\n\n\t\tif(this.sales_taxes.length == 0){\n\t\t\tthis.netTotal.css('display' , 'none')\n\t\t}\n\n\t\tthis.vat           = this.cartDetails.find('#VAT')\n\t\tthis.sales_taxes.forEach( tax =>{\n\t\t\tthis.vat.append(`<div id=\"taxConatiner_${tax.name}\" class=\"rowBox align_center row_sbtw\"></div>`)\n\t\t\tconst taxContainer = this.vat.find(`#taxConatiner_${tax.name}`)\n\t\t\ttaxContainer.append(`<div id=\"tax_${tax.name}_Title\">${tax.description}</div>`)\n\t\t\ttaxContainer.append(`<div id=\"tax_${tax.name}_Value\">0.00</div>`)\n\t\t})\n\n\t\tthis.grandTotal    = this.cartDetails.find('#grandTotal')\n\t\tthis.grandTotal.append('<div id=\"grandTotalTitle\">Grand Total</div>')\n\t\tthis.grandTotal.append('<div id=\"grandTotalValue\">0.00</div>')\n\n\n\t\tif(!this.settings_data.settings.showDiscountField){\n\t\t\tthis.setKeyboardOrientation('landscape')\n\t\t\tthis.discount.css('display' , 'none')\n\t\t}\n\n\n\n\t\tthis.editSelectedItem = this.cartFooter.find('#editSelectedItemCart')\n\t\tthis.editSelectedItem.css('display','flex');\n\t\tthis.editSelectedItem.append(`<div class=\"grid-container\"  style=\"${containerStyle}\">`)\n\n\t\tthis.buttonsContainer = this.editSelectedItem.find('.grid-container')\n\t\tthis.buttonsContainer.append(`<button id=\"key_1\"        class=\"grid-item\"  style=\"${btnStyle}\" data-action=\"1\"        > 1         </button>`)\n\t\tthis.buttonsContainer.append(`<button id=\"key_2\"        class=\"grid-item\"  style=\"${btnStyle}\" data-action=\"2\"        > 2         </button>`)\n\t\tthis.buttonsContainer.append(`<button id=\"key_3\"        class=\"grid-item\"  style=\"${btnStyle}\" data-action=\"3\"        > 3         </button>`)\n\t\tthis.buttonsContainer.append(`<button id=\"key_quantity\" class=\"grid-item\"  style=\"${btnStyle}\" data-action=\"Quantity\" > Quantit\u00E9  </button>`)\n\t\tthis.buttonsContainer.append(`<button id=\"key_4\"        class=\"grid-item\"  style=\"${btnStyle}\" data-action=\"4\"        > 4         </button>`)\n\t\tthis.buttonsContainer.append(`<button id=\"key_5\"        class=\"grid-item\"  style=\"${btnStyle}\" data-action=\"5\"        > 5         </button>`)\n\t\tthis.buttonsContainer.append(`<button id=\"key_6\"        class=\"grid-item\"  style=\"${btnStyle}\" data-action=\"6\"        > 6         </button>`)\n\t\tthis.buttonsContainer.append(`<button id=\"key_rate\"     class=\"grid-item\"  style=\"${btnStyle}\" data-action=\"Rate\"     > Prix      </button>`)\n\t\tthis.buttonsContainer.append(`<button id=\"key_7\"        class=\"grid-item\"  style=\"${btnStyle}\" data-action=\"7\"        > 7         </button>`)\n\t\tthis.buttonsContainer.append(`<button id=\"key_8\"        class=\"grid-item\"  style=\"${btnStyle}\" data-action=\"8\"        > 8         </button>`)\n\t\tthis.buttonsContainer.append(`<button id=\"key_9\"        class=\"grid-item\"  style=\"${btnStyle}\" data-action=\"9\"        > 9         </button>`)\n\t\tthis.buttonsContainer.append(`<button id=\"key_minus\"    class=\"grid-item\"  style=\"${btnStyle}\" data-action=\"-\"        > -         </button>`)\n\t\tthis.buttonsContainer.append(`<button id=\"key_point\"    class=\"grid-item\"  style=\"${btnStyle}\" data-action=\".\"        > .         </button>`)\n\t\tthis.buttonsContainer.append(`<button id=\"key_0\"        class=\"grid-item\"  style=\"${btnStyle}\" data-action=\"0\"        > 0         </button>`)\n\t\tthis.buttonsContainer.append(`<button id=\"key_delete\"   class=\"grid-item\"  style=\"${btnStyle}\" data-action=\"Delete\"   > Supprimer </button>`)\n\t\tthis.buttonsContainer.append(`<button id=\"key_remove\"   class=\"grid-item\"  style=\"${btnStyle}color:red;font-weight:700;\" data-action=\"Remove\">Retirer</button>`)\n\n\t\tthis.mainBtnContainer = this.cartFooter.find('#mainBtnContainer')\n\n\t\tthis.mainBtnContainer.append(`<button type=\"button\" id=\"checkoutBtn\" style=\"width:50%;height:100%;background:none;border:none;border-right:2px solid #663959;color:white;\"> Payment </button>`)\n\t\tthis.mainBtnContainer.append(`<button type=\"button\" id=\"printBtn\"    style=\"width:50%;height:100%;background:#E1472B;border:none;border-left:2px solid #2D6B61;color:white;\"> Print </button>`)\n\n\n\t\tthis.mainBtnContainer.find(\"#checkoutBtn\").on('mousedown' , event =>{\n\t\t\tthis.on_checkout_click();\n\t\t})\n\t\tthis.mainBtnContainer.find(\"#printBtn\").on('mousedown' , event =>{\n\t\t\tconsole.log(\"1..the map : \" , structuredClone(this.selected_item_maps.get(this.selected_tab.tabName)))\n\t\t\tthis.on_key_pressed( \"print\" , null);\n\t\t\tconsole.log(\"2..the map : \" , structuredClone(this.selected_item_maps.get(this.selected_tab.tabName)))\n\t\t})\n\n\t}\n\n\tfulfillingSelects(){\n\t\tthis.price_lists.forEach(priceList =>{\n\t\t\tthis.priceListInput.append(`<option value=\"${priceList.name}\">${priceList.price_list_name}</option>`)\n\t\t})\n\t\tthis.customer_list.forEach(customer =>{\n\t\t\tthis.customerInput.append(`<option value=\"${customer.name}\">${customer.customer_name}</option>`)\n\t\t})\n\t}\n\n\n\trefreshTabs(){\n\t\t//clear the tabs_container\n\t\tthis.tabs_container.empty()\n\n\t\tfor(let key of this.selected_item_maps.keys() ){\n\t\t\tif(key == this.selected_tab.tabName){\n\t\t\t\tthis.tabs_container.append(`<div class=\"tab selected rowBox align_center\"><div class=\"tabName\">${key}</div>  <img src=\"/assets/pos_ar/images/cancel.png\" width=\"10px\" height=\"10px\"  class=\"tabDeleteBtn\"  >  </div>`)\n\t\t\t}\n\t\t\telse{\n\t\t\t\tthis.tabs_container.append(`<div class=\"tab\">  <div class=\"tabName\">${key}</div>  </div>`)\n\t\t\t\t//this.tabs_container.append(`<div class=\"tab rowBox\"><div class=\"tabName\">${key}</div> <img src=\"/assets/pos_ar/images/cancel.png\">  </div>`)\n\t\t\t}\n\t\t}\n\n\t\tthis.tabs_container.find(\".tab\").on('click' , (event)=>{\n\n\t\t\tconst clickedTab = $(event.target).closest('.tab').find('.tabName').text();\n\n\n\t\t\t//console.log(\"\")\n\n\n\t\t\tthis.selected_tab.tabName = clickedTab\n\n\t\t\t//update UI\n\t\t\tthis.refreshTabs();\n\t\t\tthis.refreshSelectedItem();\n\n\t\t\tthis.on_tab_click(clickedTab);\n\n\t\t})\n\n\t\tthis.tabs_container.find(\".tabDeleteBtn\").on('click' , (event) => {\n\n\t\t\t//Stop the click event from propagating to the parent .tab\n\t\t        event.stopPropagation();\n\n\t\t\tconst clickedTab = $(event.target).closest('.tab').find('.tabName').text();\n\n\n\t\t\t// Check if the associated invoice is empty\n\t\t\tconst invoiceItems = this.selected_item_maps.get(clickedTab).items; // Assuming invoice data is stored in `selected_item_maps`\n\t\t\tif (invoiceItems && invoiceItems.length > 0) {\n\t\t\t\tfrappe.confirm('Are you sure you want to proceed?',\n\t\t\t\t\t() => {\n\t\t\t\t\t\tconsole.log(\"see here : \" , this.selected_item_maps.get(clickedTab))\n\t\t\t\t\t\tthis.db.deletePosInvoice(this.selected_item_maps.get(clickedTab).name)\n\t\t\t\t\t\tthis.selected_item_maps.delete(clickedTab)\n\t\t\t\t\t\tif(this.selected_item_maps.size > 0  ){\n\t\t\t\t\t\t\tthis.selected_tab.tabName = Array.from(this.selected_item_maps.keys())[0]\n\t\t\t\t\t\t\tconsole.log(\"this.selected_tab.tabName : \" , this.selected_tab)\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\tthis.createNewTab()\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.refreshTabs()\n\t\t\t\t\t\tthis.refreshSelectedItem()\n\t\t\t\t\t}, () => {\n\t\t\t\t\t\t// action to perform if No is selected\n\t\t\t\t\t})\n\t\t\t}else{\n\t\t\t\tthis.selected_item_maps.delete(clickedTab)\n\n\t\t\t\tif(this.selected_item_maps.size > 0  ){\n\t\t\t\t\tthis.selected_tab.tabName = Array.from(this.selected_item_maps.keys())[0]\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tthis.createNewTab()\n\t\t\t\t}\n\t\t\t\tthis.refreshTabs()\n\t\t\t\tthis.refreshSelectedItem()\n\t\t\t}\n\n\n\t\t})\n\t}\n\n\n\trefreshSelectedItem(){\n\n\t\t//refresh price list:\n\t\tthis.priceListInput.val(this.selected_item_maps.get(this.selected_tab.tabName).priceList)\n\t\t//refresh customer list:\n\t\tthis.customerInput.val(this.selected_item_maps.get(this.selected_tab.tabName).customer)\n\n\t\tconst selectedItemsContainer = document.getElementById(\"selectedItemsContainer\");\n\t\tselectedItemsContainer.innerHTML = \"\";\n\n\t\tthis.selected_item_maps.get(this.selected_tab.tabName).items.forEach( item  =>{\n\n\t\t\tconst itemElement   = document.createElement(\"div\");\n\t\t\tconst leftGroup     = document.createElement(\"div\");\n\t\t\tconst rightGroup    = document.createElement(\"div\");\n\t\t\tconst itemName      = document.createElement(\"h5\") ;\n\t\t\tconst itemQuantity  = document.createElement(\"div\") ;\n\t\t\tconst itemPrice     = document.createElement(\"div\") ;\n\n\n\t\t\t//image\n\t\t\t//check if there is an image or not\n\t\t\tif(!this.settings_data.settings.showItemImage){\n\t\t\t\t//dont create image\n\t\t\t}else if(item.image){\n\t\t\t\tconst itemImage   = document.createElement(\"img\");\n\t                        itemImage.src = item.image ;\n        \t                itemImage.classList.add(\"selectedItemImage\");\n                \t        leftGroup.appendChild(itemImage);\n\t\t\t}else{\n\t\t\t\tconst itemImageHolder = document.createElement(\"div\");\n\t\t\t\tconst itemImageLatter = document.createElement(\"div\");\n\n\t\t\t\titemImageHolder.classList.add(\"selectedItemImage\" , \"rowBox\" , \"centerItem\");\n\n\t\t\t\titemImageLatter.textContent = item.name[0]\n\t\t\t\titemImageHolder.appendChild(itemImageLatter);\n\t\t\t\tleftGroup.appendChild(itemImageHolder);\n\t\t\t}\n\n\n\t\t\t//name\n\t\t\titemName.textContent = item.item_name;\n\t\t\titemName.classList.add(\"selectedItemName\");\n\t\t\tleftGroup.appendChild(itemName);\n\n\t\t\t//quantity\n\t\t\titemQuantity.textContent = item.qty\n\t\t\titemQuantity.classList.add(\"itemQuantity\");\n\t\t\titemQuantity.style.fontSize   = \"18px\"\n\t\t\titemQuantity.style.fontWeight = \"600\"\n\t\t\trightGroup.appendChild(itemQuantity);\n\t\t\t//price\n\t\t\titemPrice.textContent = (item.rate - item.discount_amount) + \" DA\"\n\t\t\titemPrice.classList.add(\"itemPrice\");\n\t\t\titemPrice.style.fontSize   = \"18px\"\n\t\t\titemPrice.style.fontWeight = \"600\"\n\t\t\titemPrice.style.width      = \"90px\"\n\t\t\titemPrice.style.display    = \"flex\"\n\t\t\titemPrice.style.flexDirection = \"row-reverse\"\n\n\t\t\trightGroup.appendChild(itemPrice);\n\n\t\t\t//leftGroup\n\t\t\tleftGroup.classList.add(\"rowBox\" , \"align_center\" , \"leftGroup\")\n\t\t\titemElement.appendChild(leftGroup);\n\n\t\t\t//rightGroup\n\t\t\trightGroup.classList.add(\"rowBox\" , \"align_center\" , \"rightGroup\")\n\t\t\titemElement.appendChild(rightGroup);\n\n\n\t\t\t//item\n\t\t\titemElement.classList.add(\"rowBox\" , \"align_center\" , \"row_sbtw\" , \"ItemElement\" , \"pointer\")\n\t\t\tif(item.name == this.selected_item.name)\n\t\t\t\titemElement.classList.add(\"selected\")\n\t\t\titemElement.addEventListener(\"click\" , event =>{\n\t\t\t\tthis.makeItemHighlight(itemElement)\n\t\t\t\tthis.on_selected_item_click(item);\n\t\t\t})\n\n\t\t\tselectedItemsContainer.appendChild(itemElement);\n\n\t\t})\n\n\t\tthis.calculateNetTotal();\n\t\tthis.calculateVAT();\n\t\tthis.calculateQnatity();\n\t\tthis.calculateGrandTotal();\n\t}\n\n\n\tscrollToBottom(){\n\t\tconsole.log(\"scrolling\")\n\t\tthis.selectedItemContainer.scrollTop(this.selectedItemContainer[0].scrollHeight);\n\t}\n\n\n\tcreateNewTab(){\n\t\t\tthis.counter += 1 ;\n\t\t\tthis.create_new_tab(this.counter);\n\t\t\t//update UI\n\t\t\tthis.refreshTabs()\n\t\t\tthis.refreshSelectedItem()\n\t}\n\trestorePos(pos){\n\t\t\tthis.counter += 1 ;\n\t\t\tthis.create_new_tab(this.counter);\n\t\t\t\n\t\t\t//update UI\n\t\t\tthis.refreshTabs()\n\t\t\tthis.refreshSelectedItem()\n\t}\n\n\tcreateTabForEditPOS(){\n\t\tthis.counter += 1 ;\n\t\treturn this.counter;\n\t}\n\n\tshowKeyboard(){\n\t\tthis.editSelectedItem.css('display','flex')\n\t}\n\n\thideKeyboard(){\n\t\tthis.editSelectedItem.css('display','none')\n\t}\n\n\tsetKeyboardOrientation( orientation ){\n\n\t\tconst discount   = this.cartDetails.find('#discount')\n\t\tconst quantity   = this.cartDetails.find('#totalQuantity')\n\t\tconst netTotal   = this.cartDetails.find('#netTotal')\n\t\tconst grandTotal = this.cartDetails.find('#grandTotal')\n\n\t\tif(orientation == \"landscape\"){\n\t\t\tthis.cartDetails.css('display' , 'flex')\n\t\t\tthis.cartDetails.addClass('rowBox align_center')\n\t\t\tthis.cartDetails.removeClass('columnBox')\n\t\t\tdiscount.css('display' , 'none')\n\t\t\tthis.vat.css('display' , 'none')\n\t\t\t//make the text smaller\n\t\t\tquantity.css('font-size' , 'smaller')\n\t\t\tnetTotal.css('font-size' , 'smaller')\n\t\t\tgrandTotal.css('font-size' , 'small')\n\t\t\tgrandTotal.css('font-weight' , '500')\n\t\t}\n\t\telse{\n\t\t\tthis.cartDetails.addClass('columnBox')\n\t\t\tthis.cartDetails.removeClass('rowBox')\n\t\t\tif(this.settings_data.settings.showDiscountField){\n\t\t\t\tdiscount.css('display','flex')\n\t\t\t}\n\t\t\tthis.vat.css('display' , 'flex')\n\n\t\t\t//reset\n\t\t\tquantity.css('font-size'   , 'small' )\n\t\t\tnetTotal.css('font-size'   , 'small' )\n\t\t\tgrandTotal.css('font-size' , 'larger')\n\t\t\tgrandTotal.css('font-weight' , '700' )\n\t\t}\n\t}\n\n\tmakeSelectedButtonHighlighted(){\n\t\tconst quantityButton = this.buttonsContainer.find('#key_quantity')\n\t\tconst rateButton     = this.buttonsContainer.find('#key_rate')\n\t\tconst minusButton    = this.buttonsContainer.find('#key_minus')\n\n\t\tif(this.selected_field.field_name == \"quantity\"){\n\t\t\tquantityButton.addClass('selected')\n\t\t\trateButton.removeClass('selected')\n\t\t\tminusButton.removeClass('selected')\n\t\t}\n\t\telse if(this.selected_field.field_name == \"rate\"){\n\t\t\tquantityButton.removeClass('selected')\n\t\t\trateButton.addClass('selected')\n\t\t\tminusButton.removeClass('selected')\n\t\t}\n\t\telse if(this.selected_field.field_name == \"discount_percentage\"){\n\t\t\tquantityButton.removeClass('selected')\n\t\t\trateButton.removeClass('selected')\n\t\t\tminusButton.addClass('selected')\n\t\t}\n\t\telse{\n\t\t\tquantityButton.removeClass('selected')\n\t\t\trateButton.removeClass('selected')\n\t\t\tminusButton.removeClass('selected')\n\t\t}\n\n\t}\n\n\n\t//hide\n\thideCart(){\n\t\tthis.tabs_bar.css('display' , 'none');\n\t\tthis.cartBox.css('display' , 'none');\n\t}\n\t//hide\n\tshowCart(){\n\t\tthis.tabs_bar.css('display' , 'flex');\n\t\tthis.cartBox.css('display' , 'flex');\n\t}\n\t/************************  set listeners  ***************************/\n\n\tsetButtonsListeners(){\n\t\tconst key_0        = this.buttonsContainer.find('#key_0')\n\t\tconst key_1        = this.buttonsContainer.find('#key_1')\n\t\tconst key_2        = this.buttonsContainer.find('#key_2')\n\t\tconst key_3        = this.buttonsContainer.find('#key_3')\n\t\tconst key_4        = this.buttonsContainer.find('#key_4')\n\t\tconst key_5        = this.buttonsContainer.find('#key_5')\n\t\tconst key_6        = this.buttonsContainer.find('#key_6')\n\t\tconst key_7        = this.buttonsContainer.find('#key_7')\n\t\tconst key_8        = this.buttonsContainer.find('#key_8')\n\t\tconst key_9        = this.buttonsContainer.find('#key_9')\n\t\tconst key_quantity = this.buttonsContainer.find('#key_quantity')\n\t\tconst key_minus    = this.buttonsContainer.find('#key_minus')\n\t\tconst key_rate     = this.buttonsContainer.find('#key_rate')\n\t\tconst key_remove   = this.buttonsContainer.find('#key_remove')\n\t\tconst key_delete   = this.buttonsContainer.find('#key_delete')\n\t\tconst key_point    = this.buttonsContainer.find('#key_point')\n\n\t\tlet keys = [key_0 , key_1 , key_2 , key_3 , key_4 , key_5 , key_6 , key_7 , key_8 , key_9 , key_quantity , key_minus , key_rate , key_remove , key_delete , key_point]\n\n\n\t\tkeys.forEach(key =>{\n\t\t\tkey.on('mousedown' , (event)=>{\n\t\t\t\tevent.preventDefault();\n\t\t\t\tconst keyContent = key.data('action');\n\n\t\t\t\tif(!isNaN(keyContent)){\n\t\t\t\t\tthis.on_key_pressed( \"addToField\" , keyContent)\n\t\t\t\t}\n\t\t\t\telse if(keyContent == \".\"){\n\t\t\t\t\tthis.on_key_pressed( \"addToField\" , keyContent)\n\t\t\t\t}\n\t\t\t\telse if(keyContent == \"Quantity\"){\n\t\t\t\t\tthis.on_key_pressed( \"quantity\" , null)\n\t\t\t\t}\n\t\t\t\telse if(keyContent == \"Rate\"){\n\t\t\t\t\tthis.on_key_pressed( \"rate\" , null)\n\t\t\t\t}\n\t\t\t\telse if(keyContent == \"-\" ){\n\t\t\t\t\tthis.on_key_pressed( \"minus\" , null)\n\t\t\t\t}\n\t\t\t\telse if(keyContent == \"Remove\"){\n\t\t\t\t\tthis.on_key_pressed( \"remove\" , null)\n\t\t\t\t}\n\t\t\t\telse if(keyContent == \"Delete\"){\n\t\t\t\t\tthis.on_key_pressed( \"delete\" , null)\n\t\t\t\t}\n\n\t\t\t})\n\t\t})\n\n\t}\n\n\tsetListener(){\n\n\t\tthis.add_tab_button.on('mousedown' , (event)=>{\n\t\t\tthis.createNewTab()\n\t\t})\n\n\n\t\tthis.discountInput.on('input' , (event)=> {\n\t\t\tif(event.target.value == ''){\n\t\t\t\tthis.selected_item_maps.get(this.selected_tab.tabName).additional_discount_percentage = 0\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse if(event.target.value > 100){\n\t\t\t\tthis.selected_item_maps.get(this.selected_tab.tabName).additional_discount_percentage = 100\n\t\t\t\treturn;\n\t\t\t}\n\n\n\t\t\tthis.selected_item_maps.get(this.selected_tab.tabName).additional_discount_percentage = parseFloat(event.target.value)\n\n\t\t\t//recalculation\n\t\t\tthis.calculateNetTotal()\n\t\t\tthis.calculateVAT()\n\t\t\tthis.calculateGrandTotal()\n\t\t})\n\t\tthis.discountInput.on('blur' , (event)=> {\n\t\t\tif(event.target.value == ''){\n\t\t\t\tevent.target.value = 0 ;\n\t\t\t}\n\t\t\telse if(event.target.value > 100){\n\t\t\t\tevent.target.value = 100 ;\n\t\t\t}\n\n\t\t\t//recalculation\n\t\t\tthis.calculateNetTotal()\n\t\t\tthis.calculateVAT()\n\t\t\tthis.calculateGrandTotal()\n\n\t\t})\n\n\n\t\tthis.priceListInput.on('input' , (event) =>{\n\t\t\tthis.selected_item_maps.get(this.selected_tab.tabName).priceList = event.target.value;\n\t\t\t//reset items rate:\n\t\t\tthis.resetItemRateBaseOnPriceList()\n\t\t\t//update the UI\n\t\t\tthis.refreshSelectedItem()\n\t\t\tthis.save_pos_invoice()\n\t\t})\n\n\t\tthis.customerInput.on('input' , (event)=>{\n\t\t\tthis.selected_item_maps.get(this.selected_tab.tabName).customer = event.target.value;\n\t\t\tlet priceList = this.getCustomerDefaultPriceList(event.target.value)\n\t\t\tif( priceList == \"\" || priceList  == null || priceList  == undefined){\n\t\t\t\t\n\t\t\t}else{\n\t\t\t\tthis.priceListInput.val(priceList)\n\t\t\t\tthis.selected_item_maps.get(this.selected_tab.tabName).priceList = priceList \t\n\t\t\t}\n\t\t\t\n\t\t\t//reset items rate:\n\t\t\tthis.resetItemRateBaseOnPriceList()\n\t\t\t//update the UI\n\t\t\tthis.refreshSelectedItem()\n\t\t\tthis.save_pos_invoice()\n\t\t})\n\t}\n\n\t/*************************  tools  **********************************/\n\n\tgetCustomerDefaultPriceList(customerId){\n\t\tlet priceList = \"\"\n\t\tthis.customer_list.forEach(customer => {\n\t\t\tif(customer.name == customerId){\n\t\t\t\tpriceList = customer.default_price_list\n\t\t\t}\n\t\t})\n\t\treturn priceList\n\t}\n\n\tcalculateNetTotal(){\n\n\t\tlet netTotal = 0;\n\t\tthis.selected_item_maps.get(this.selected_tab.tabName).items.forEach( item => {\n\t\t\tnetTotal += item.rate * item.qty\n\t\t})\n\n\t\tif(this.selected_item_maps.get(this.selected_tab.tabName).additional_discount_percentage > 0){\n\t\t\tnetTotal -= (netTotal * (this.selected_item_maps.get(this.selected_tab.tabName).additional_discount_percentage / 100))\n\t\t}\n\t\tconst netTotal_HTML = document.getElementById(\"netTotalValue\");\n\t\tnetTotal_HTML.textContent  = netTotal;\n\t\tthis.invoice_data.netTotal = netTotal;\n\t}\n\n\tcalculateVAT(){\n\t\tthis.sales_taxes.forEach( tax =>{\n\t\t\tlet saleTaxAmount = 0 ;\n\t\t\tlet taxPercentage = (tax.rate / 100)\n\t\t\tconst calculatedTax = (this.invoice_data.netTotal * taxPercentage).toFixed(2)\n\t\t\tthis.taxes_map.set(tax.name , calculatedTax)\n\t\t\tconst tax_HTML = document.getElementById(`tax_${tax.name}_Value`);\n\t\t\ttax_HTML.textContent = this.taxes_map.get(tax.name);\n\n\t\t})\n\t}\n\n\tcalculateTotalTaxAmount(){\n\t\tlet result = 0 ;\n\t\tthis.taxes_map.forEach(tax => {\n\t\t\tresult += tax ;\n\t\t})\n\t\treturn result ;\n\t}\n\n\n\tcalculateQnatity(){\n\t\tlet quantity = 0;\n\t\tthis.selected_item_maps.get(this.selected_tab.tabName).items.forEach( item => {\n\t\t\tquantity += item.qty\n\t\t})\n\t\tconst totalQuantity_HTML = document.getElementById(\"totalQuantityValue\");\n\t\ttotalQuantity_HTML.textContent = quantity;\n\t}\n\n\tcalculateGrandTotal(){\n\t\tlet grandTotal = 0 ;\n\t\tlet netTotal   = this.invoice_data.netTotal ;\n\t\tlet taxAmount  = 0 ;\n\n\t\tthis.taxes_map.forEach(tax =>{\n\t\t\ttaxAmount += parseFloat(tax)\n\t\t})\n\n\t\tgrandTotal = (netTotal + taxAmount) ;\n\t\tconst grandTotal_HTML = document.getElementById(\"grandTotalValue\");\n\t\tgrandTotal_HTML.textContent = (grandTotal).toFixed(2);\n\n\t\tthis.invoice_data.grandTotal = grandTotal\n\t}\n\n\n\tresetItemRateBaseOnPriceList(){\n\t\tthis.selected_item_maps.get(this.selected_tab.tabName).items.forEach( item  => {\n\t\t\titem.rate                = this.get_item_price(item , this.selected_item_maps.get(this.selected_tab.tabName).priceList)\n\t\t\titem.discount_percentage = 0.00\n\t\t\titem.discount_amount     = 0.00\n\t\t})\n\t}\n\n\n\tmakeItemHighlight(itemElement){\n\t\tconst selectedItemsContainer = document.getElementById(\"selectedItemsContainer\");\n\t\tconst selectedItems = selectedItemsContainer.querySelectorAll(\".selected\")\n\t\tselectedItems.forEach(selectedItem=>{\n\t\t\tselectedItem.classList.remove(\"selected\");\n\t\t})\n\t\titemElement.classList.add(\"selected\")\n\t}\n\n\tcleanHeighlight(){\n\t\tconst selectedItemsContainer = document.getElementById(\"selectedItemsContainer\");\n\t\tconst selectedItems = selectedItemsContainer.querySelectorAll(\".selected\")\n\t\tselectedItems.forEach(selectedItem=>{\n\t\t\tselectedItem.classList.remove(\"selected\");\n\t\t})\n\n\t}\n\n\n\n}\n", "pos_ar.PointOfSale.pos_item_details = class{\n\n\tconstructor(\n\t\twrapper,\n\t\twarehouse,\n\t\tpriceLists,\n\t\titemPrices,\n\t\tbinList,\n\t\tselectedItem,\n\t\tselectedField,\n\t\tonInput,\n\t\tonClose,\n\t){\n\t\tthis.wrapper        = wrapper   ;\n\t\tthis.warehouse      = warehouse ;\n\t\tthis.price_lists    = priceLists;\n\t\tthis.item_prices    = itemPrices;\n\t\tthis.selected_item  = selectedItem ;\n\t\tthis.selected_field = selectedField;\n\t\tthis.on_input       = onInput;\n\t\tthis.on_close_cart  = onClose;\n\t\tthis.bin_list       = binList;\n\n\t\tthis.start_the_work();\n\t}\n\n\n\t// start function\n\tstart_the_work(){\n\t\tthis.prepare_item_details_cart();\n\t\tthis.setDetailsFieldsListeners();\n\t}\n\n\n\t/****************************    ui functions   **********************************/\n\n        prepare_item_details_cart(){\n                this.wrapper.append('<div id=\"itemDetailsCart\" class=\"columnBox align_center\"><div>')\n\n                this.item_details_cart = this.wrapper.find(\"#itemDetailsCart\")\n                this.item_details_cart.append('<div id=\"itemDetailsCartHeader\" class=\"rowBox header align_center row_sbtw\"></div>')\n\n                this.cart_header = this.item_details_cart.find('#itemDetailsCartHeader')\n                this.cart_header.append('<h4 class=\"CartTitle\">Item Details</h4>')\n                this.cart_header.append('<img src=\"/assets/pos_ar/images/cancel.png\" alt=\"Cancel Button\" id=\"itemDetailsCartXBtn\" class=\"xBtn\">')\n\n                this.close_btn = this.cart_header.find(\"#itemDetailsCartXBtn\").on(\"click\", (event) =>{\n                        this.on_close_cart();\n                })\n\n\t\tthis.item_details_cart.append('<div id=\"itemDetailsHeader\" class=\"rowBox\"></div>')\n\n\t\tthis.header_details = this.item_details_cart.find('#itemDetailsHeader')\n\t\tthis.header_details.append('<div id=\"detailsItemImage\" class=\"rowBox centerItem\"></div>')\n\t\tthis.header_details.append('<div id=\"price_and_name\" class=\"columnBox\"></div>')\n\n\t\tthis.price_and_name_details = this.header_details.find('#price_and_name')\n\t\tthis.price_and_name_details.append('<div id=\"detailsItemName\" class=\"rowBox align_center\"></div>')\n\t\tthis.price_and_name_details.append('<div id=\"detailsItemGroupWarhouseContainer\" class=\"rowBox align_center row_sa\"></divr>')\n\n\t\tthis.item_group_warehouse_details = this.price_and_name_details.find('#detailsItemGroupWarhouseContainer')\n\t\tthis.item_group_warehouse_details.append('<div id=\"detailsItemGroup\" class=\"rowBox align_center\">Group : ...</div>')\n\t\tthis.item_group_warehouse_details.append('<div id=\"detailsItemWarehouse\" class=\"rowBox align_center\">Warehouse : ...</div>')\n\n\t\tthis.item_details_cart.append('<div id=\"itemDetailsAll\"  class=\"rowBox\"></div>')\n\n\t\tthis.details_all = this.item_details_cart.find('#itemDetailsAll')\n\t\tthis.details_all.append('<div id=\"itemDetails_C1\" class=\"columnBox\"></div>')\n\n\t\tthis.c1 = this.details_all.find('#itemDetails_C1')\n\t\tthis.c1.append('<div class=\"columnBox\"><label for=\"itemDetailsQuantityInput\">Quantity</label><input type=\"float\" id=\"itemDetailsQuantityInput\" class=\"pointerCursor\"></div>')\n\t\tthis.c1.append('<div class=\"columnBox\"><label for=\"itemDetailsRateInput\">Rate</label><input type=\"float\" id=\"itemDetailsRateInput\" class=\"pointerCursor\"></div>')\n\t\tthis.c1.append('<div class=\"columnBox\"><label for=\"itemDetailsDiscountInput\">Discount (%)</label><input type=\"float\" id=\"itemDetailsDiscountInput\" class=\"pointerCursor\"></div>')\n\t\tthis.c1.append('<div class=\"columnBox\"><label for=\"itemDetailsAvailableInput\">Available Qty at Warehouse</label><input type=\"float\" id=\"itemDetailsAvailableInput\" disabled></div>')\n\n\n\t\tthis.details_all.append('<div id=\"itemDetails_C2\" class=\"columnBox\"></div>')\n\n\t\tthis.c2 = this.details_all.find('#itemDetails_C2')\n\t\tthis.c2.append('<div class=\"columnBox\"><label for=\"itemDetailsUomInput\">UOM *</label><input type=\"text\" id=\"itemDetailsUomInput\"  disabled></div>')\n\t\tthis.c2.append('<div class=\"columnBox\"><label for=\"detailsRateWithDescount\">Discounted Rate</label>  <input type=\"text\" id=\"discountedRateInput\" disabled>  </div>')\n\t\tthis.c2.append('<div class=\"columnBox hideMe\"><label for=\"detailsPriceList\">Price List *</label><input list=\"detailsPriceList\" id=\"detailsItemPriceListInput\" class =\"rowBox align_center pointerCursor\"><datalist id=\"detailsPriceList\"><option>fetching Price Lists ...</option></datalist></div>')\n\t\tthis.c2.append('<div class=\"columnBox\"><label for=\"itemDetailsDiscountMontantInput\">Discount (montant)</label><input type=\"float\" id=\"itemDetailsDiscountMontantInput\" class=\"pointerCursor\"></div>')\n\t\tthis.c2.append('<div class=\"columnBox\"><label for=\"itemDetailsPriceListRateInput\">Price List Rate</label><input type=\"text\" id=\"itemDetailsPriceListRateInput\" disabled></div>')\n\n\n\n\t}\n\n\trefreshDate(item){\n\n\t\tconst imageContainer    = document.getElementById(\"detailsItemImage\") ;\n\t\tconst name              = document.getElementById(\"detailsItemName\");\n\t\tconst warehouse         = document.getElementById(\"detailsItemWarehouse\");\n\t\tconst itemGroup         = document.getElementById(\"detailsItemGroup\");\n\n\t\tconst quantity             = document.getElementById(\"itemDetailsQuantityInput\");\n\t\tconst rate                 = document.getElementById(\"itemDetailsRateInput\");\n\t\tconst discountedRate       = document.getElementById(\"discountedRateInput\");\n\t\tconst discount_percentage  = document.getElementById(\"itemDetailsDiscountInput\");\n\t\tconst discount_amount      = document.getElementById(\"itemDetailsDiscountMontantInput\");\n\t\tconst available            = document.getElementById(\"itemDetailsAvailableInput\");\n\n\t\tconst uom           = document.getElementById(\"itemDetailsUomInput\");\n\t\tconst priceList     = document.getElementById(\"detailsItemPriceListInput\");\n\t\tconst priceListRate = document.getElementById(\"itemDetailsPriceListRateInput\");\n\n\t\t//populate\n\t\tif(item.image){\n\t\t\tconst image = document.createElement(\"img\");\n\t\t\timage.src = item.image;\n\t\t\timageContainer.innerHTML = \"\";\n\t\t\timageContainer.appendChild(image);\n\t\t}\n\t\telse{\n\t\t\tconst image = document.createElement(\"div\");\n\t\t\timage.textContent = item.item_name[0];\n\t\t\timage.style.fontSize = \"xx-large\";\n\t\t\timage.style.fontWeight = \"700\";\n\t\t\timageContainer.innerHTML = \"\";\n\t\t\timageContainer.appendChild(image);\n\t\t}\n\n\t\t//name\n\t\tname.textContent  = item.item_name;\n\t\tname.classList.add(\"rowBox\" , \"align_center\");\n\n\n\t\t//quantity\n\t\tquantity.value = item.qty\n\n\t\t//rate\n\t\trate.value = item.rate\n\t\tdiscountedRate.value = item.rate - item.discount_amount\n\n\t\t//discount\n\t\tdiscount_amount.value     = item.discount_amount ?? 0.00;\n\t\tdiscount_percentage.value = item.discount_percentage ?? 0.00;\n\n\n\t\t//available\n\t\tavailable.value = this.getQtyInWarehouse(item.name ,  this.warehouse)\n\n\n\t\t//uom\n\t\tuom.value = item.stock_uom\n\n\n\t\t//priceList\n\t\tpriceList.value = this.price_lists[0].price_list_name\n\t\t//warehouse\n\t\twarehouse.textContent = \"Warehouse : \" + this.warehouse\n\t\t//item group\n\t\titemGroup.textContent = \"Item Group : \" + item.item_group\n\n\t\t//priceListRate\n\t\tpriceListRate.value = this.getItemPrice(item.name) + \"DA\"\n\n\n\t\tconsole.log(\"end ref\")\n\n\n\t\t//hightlited fields\n\t\tthis.makeSelectedFieldHighlighted()\n\t}\n\n\tshow_cart(){\n\t\tthis.item_details_cart.css(\"display\" , \"flex\");\n\t}\n\n\thide_cart(){\n\t\tthis.item_details_cart.css(\"display\" , \"none\");\n\t}\n\n\tmakeSelectedFieldHighlighted(){\n\n\n\t\tif(this.selected_field.field_name == \"quantity\"){\n\t\t\tthis.c1.find('#itemDetailsQuantityInput').addClass('selected')\n\t\t\tthis.c1.find('#itemDetailsRateInput').removeClass('selected')\n\t\t\tthis.c1.find('#itemDetailsDiscountInput').removeClass('selected')\n\t\t}\n\t\telse if(this.selected_field.field_name == \"rate\"){\n\t\t\tthis.c1.find('#itemDetailsQuantityInput').removeClass('selected')\n\t\t\tthis.c1.find('#itemDetailsRateInput').addClass('selected')\n\t\t\tthis.c1.find('#itemDetailsDiscountInput').removeClass('selected')\n\t\t}\n\t\telse if(this.selected_field.field_name == \"discount_percentage\"){\n\t\t\tthis.c1.find('#itemDetailsQuantityInput').removeClass('selected')\n\t\t\tthis.c1.find('#itemDetailsRateInput').removeClass('selected')\n\t\t\tthis.c1.find('#itemDetailsDiscountInput').addClass('selected')\n\t\t}\n\t\telse{\n\t\t\tthis.c1.find('#itemDetailsQuantityInput').removeClass('selected')\n\t\t\tthis.c1.find('#itemDetailsRateInput').removeClass('selected')\n\t\t\tthis.c1.find('#itemDetailsDiscountInput').removeClass('selected')\n\t\t}\n\n\t}\n\n\n\trequestFocus(field){\n\t\tif(field == \"quantity\"){\n\t\t\tthis.c1.find('#itemDetailsQuantityInput').focus();\n\t\t}\n\t\telse if(field == \"rate\"){\n\t\t\tthis.c1.find('#itemDetailsRateInput').focus();\n\t\t}\n\t\telse if(field == \"discount_percentage\"){\n\t\t\tthis.c1.find('#itemDetailsDiscountInput').focus();\n\t\t}\n\t\telse if(field == \"discount_amount\"){\n\t\t\tthis.c1.find('#itemDetailsDiscountMontantInput').focus();\n\t\t}\n\t}\n\n\n/*\n\nelse if(keyContent == \".\" && !selectedField.value.includes(\".\")){\n                                        this.on_key_pressed( \"addToField\" , key.text())\n                                }\n\n*/\n\taddToField(field , value){\n\n\t\tconsole.log('field : ' , field , 'value : ' , value )\n\n\t\tif(field == \"quantity\"){\n\t\t\tthis.c1.find('#itemDetailsQuantityInput').val( (index,currentValue) =>{\n\t\t\t\tif(value == \".\" && currentValue.includes(\".\"))\n\t\t\t\t\treturn currentValue\n\t\t\t\telse\n\t\t\t\t\treturn currentValue + value\n\t\t\t})\n\t\t}\n\t\telse if(field == \"rate\"){\n\t\t\tthis.c1.find('#itemDetailsRateInput').val( (index,currentValue) =>{\n\t\t\t\tif(value == \".\" && currentValue.includes(\".\"))\n\t\t\t\t\treturn currentValue\n\t\t\t\telse\n\t\t\t\t\treturn currentValue + value\n\t\t\t})\n\t\t}\n\t\telse if(field == \"discount_percentage\"){\n\t\t\tthis.c1.find('#itemDetailsDiscountInput').val( (index,currentValue) =>{\n\t\t\t\tif(value == \".\" && currentValue.includes(\".\"))\n\t\t\t\t\treturn currentValue\n\t\t\t\telse\n\t\t\t\t\treturn currentValue + value\n\t\t\t})\n\n\t\t}\n\t\telse if(field == \"discount_amount\"){\n\t\t\tthis.c1.find('#itemDetailsDiscountInput').val( (index,currentValue) =>{\n\t\t\t\tif(value == \".\" && currentValue.includes(\".\"))\n\t\t\t\t\treturn currentValue\n\t\t\t\telse\n\t\t\t\t\treturn currentValue + value\n\t\t\t})\n\n\t\t}\n\n\t}\n\n\tdeleteCharacter(){\n\n\t\tlet field = this.selected_field.field_name\n\n\t\tlet newValue = 0 ;\n\n\t\tif(field == \"quantity\"){\n\n\t\t\tlet field = this.c1.find(\"#itemDetailsQuantityInput\")\n\n\t\t\tlet cursor = field[0].selectionStart;\n\n\t\t\tfield.val( (index , currentValue) =>{\n\n\t\t\t\tif( currentValue.length < 0 ){\n\t\t\t\t\tnewValue = 0 ;\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\telse if( currentValue.length == 1){\n\t\t\t\t\tnewValue = 0 ;\n\t\t\t\t\treturn 0 ;\n\t\t\t\t}\n\t\t\t\telse if( cursor == 0 ){\n\t\t\t\t\tnewValue = currentValue;\n\t\t\t\t\treturn currentValue;\n\t\t\t\t}\n\t\t\t\telse if( cursor == currentValue.length){\n\t\t\t\t\tnewValue = currentValue.slice(0 , cursor-1)\n\t\t\t\t\treturn currentValue.slice(0 , cursor-1)\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnewValue = currentValue.slice(0,cursor-1) + currentValue.slice(cursor)\n\t\t\t\t\treturn currentValue.slice(0,cursor-1) + currentValue.slice(cursor)\n\t\t\t\t}\n\t\t\t})\n\n\n\t\t\t// Use setTimeout to ensure the new value is set before adjusting cursor\n\t\t\tsetTimeout(() => {\n\t\t\t\tfield[0].setSelectionRange(cursor - 1, cursor - 1); // Move cursor back after deletion\n\t\t\t\tfield[0].focus(); // Ensure the input is focused\n\t\t\t}, 0);\n\n\t\t}\n\t\tif(field == \"rate\"){\n\n\t\t\tlet field = this.c1.find(\"#itemDetailsRateInput\")\n\n\t\t\tlet cursor = field[0].selectionStart;\n\n\t\t\tfield.val( (index , currentValue) =>{\n\n\t\t\t\tif( currentValue.length < 0 ){\n\t\t\t\t\tnewValue = 0 ;\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\telse if( currentValue.length == 1){\n\t\t\t\t\tnewValue = 0 ;\n\t\t\t\t\treturn 0 ;\n\t\t\t\t}\n\t\t\t\telse if( cursor == 0 ){\n\t\t\t\t\tnewValue = currentValue ;\n\t\t\t\t\treturn currentValue;\n\t\t\t\t}\n\t\t\t\telse if( cursor == currentValue.length){\n\t\t\t\t\tnewValue = currentValue.slice(0 , cursor-1) ;\n\t\t\t\t\treturn currentValue.slice(0 , cursor-1)\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnewValue = currentValue.slice(0,cursor-1) + currentValue.slice(cursor)\n\t\t\t\t\treturn currentValue.slice(0,cursor-1) + currentValue.slice(cursor)\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t// Use setTimeout to ensure the new value is set before adjusting cursor\n\t\t\tsetTimeout(() => {\n\t\t\t\tfield[0].setSelectionRange(cursor - 1, cursor - 1); // Move cursor back after deletion\n\t\t\t\tfield[0].focus(); // Ensure the input is focused\n\t\t\t}, 0);\n\n\n\t\t}\n\t\tif(field == \"discount_percentage\"){\n\n\t\t\tlet field = this.c1.find(\"#itemDetailsDiscountInput\")\n\n\t\t\tlet cursor = field[0].selectionStart;\n\n\t\t\tfield.val( (index , currentValue) =>{\n\n\t\t\t\tif( currentValue.length < 0 ){\n\t\t\t\t\tnewValue = 0 ;\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t\telse if( currentValue.length == 1){\n\t\t\t\t\tnewValue = 0 ;\n\t\t\t\t\treturn 0 ;\n\t\t\t\t}\n\t\t\t\telse if( cursor == 0 ){\n\t\t\t\t\tnewValue = currentValue;\n\t\t\t\t\treturn currentValue;\n\t\t\t\t}\n\t\t\t\telse if( cursor == currentValue.length){\n\t\t\t\t\tnewValue = currentValue.slice(0 , cursor-1);\n\t\t\t\t\treturn currentValue.slice(0 , cursor-1)\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnewValue = currentValue.slice(0,cursor-1) + currentValue.slice(cursor)\n\t\t\t\t\treturn currentValue.slice(0,cursor-1) + currentValue.slice(cursor)\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t// Use setTimeout to ensure the new value is set before adjusting cursor\n\t\t\tsetTimeout(() => {\n\t\t\t\tfield[0].setSelectionRange(cursor - 1, cursor - 1); // Move cursor back after deletion\n\t\t\t\tfield[0].focus(); // Ensure the input is focused\n\t\t\t}, 0);\n\n\n\t\t}\n\n\t\tconsole.log(\"we reach to here \")\n\t\treturn newValue ;\n\n\t}\n\n\t/**************************  set listener  ****************************/\n\n\tsetDetailsFieldsListeners(){\n\n\t\tthis.quantityInput        = this.c1.find('#itemDetailsQuantityInput')\n\t\tthis.rateInput            = this.c1.find('#itemDetailsRateInput')\n\t\tthis.discountInput        = this.c1.find('#itemDetailsDiscountInput')\n\t\tthis.discountMontantInput = this.c2.find('#itemDetailsDiscountMontantInput')\n\n\t\t//quantity input\n\t\tthis.quantityInput.on('input' , (event)=>{\n\t\t\tconst value = event.target.value;\n\n\t\t\tif(value.length == 0){\n\t\t\t\tevent.target.value = 0\n\t\t\t}\n\t\t\telse if (!value.slice(0,-1).includes(\".\")  && value[value.length-1] == \".\"){\n\t\t\t\tevent.target.value = value\n\t\t\t}\n\t\t\telse if(value[value.length-1] == \".\"){\n\t\t\t\tevent.target.value = value.slice(0,-1);\n\t\t\t}\n\t\t\telse if(value[value.length-1] == \" \"){\n\t\t\t\tevent.target.value = value.slice(0,-1);\n\t\t\t}\n\t\t\telse if(isNaN(value[value.length-1])){\n\t\t\t\tevent.target.value = value.slice(0,-1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tevent.target.value = value\n\t\t\t}\n\n\t\t\t//new quantity\n\t\t\tlet newQuantity = parseFloat(this.quantityInput.val());\n\t\t\tif(isNaN(newQuantity)){\n\t\t\t\tconsole.warn(\"Invaide Quantity value =>\" , this.quantityInput.val())\n\t\t\t\treturn;\n\t\t\t}\n\t\t\telse if(newQuantity <= 0){\n\t\t\t\tnewQuantity = 0;\n\t\t\t}\n\n\t\t\tthis.on_input( \"input\" , \"quantity\" , newQuantity)\n\t\t})\n\n\t\tthis.quantityInput.on('focus' , (event)=>{\n\t\t\tthis.on_input( \"focus\" , \"quantity\" , null)\n\t\t})\n\n\t\tthis.quantityInput.on('blur' , (event)=>{\n\t\t\tthis.on_input( \"blur\" , \"quantity\" , null)\n\t\t})\n\n\t\t//rate field listeners\n\t\tthis.rateInput.on('input' , (event)=>{\n\t\t\tconst value = event.target.value ;\n\n\t\t\tif(value.length == 0){\n\t\t\t\tevent.target.value = 0\n\t\t\t}\n\t\t\telse if (!value.slice(0,-1).includes(\".\")  && value[value.length-1] == \".\"){\n\t\t\t\tevent.target.value = value\n\t\t\t}\n\t\t\telse if(value[value.length-1] == \".\"){\n\t\t\t\tevent.target.value = value.slice(0,-1);\n\t\t\t}\n\t\t\telse if(isNaN(value[value.length-1])){\n\t\t\t\tevent.target.value = value.slice(0,-1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tevent.target.value = value;\n\t\t\t}\n\n\t\t\tlet newRate = parseFloat(this.rateInput.val());\n\n\t\t\tconsole.log(\"new rate : \" , newRate)\n\t\t\tif(isNaN(newRate)){\n\t\t\t\tconsole.warn(\"Invalide Rate value\")\n\t\t\t\treturn;\n\t\t\t}\n\n\n\t\t\tthis.on_input( \"input\" , \"rate\" , newRate)\n\t\t})\n\t\tthis.rateInput.on('focus' , (event)=>{\n\t\t\tthis.on_input( \"focus\" , \"rate\" , null)\n\t\t})\n\t\tthis.rateInput.on('blur' , (event)=>{\n\t\t\tthis.on_input( \"blur\" , \"rate\" , null)\n\t\t})\n\n\n\n\n\t\t//discount field listener\n\t\tthis.discountInput.on('input' , (event)=>{\n\t\t\tconst value = event.target.value ;\n\n\t\t\tif(value.length == 0){\n\t\t\t\tevent.target.value = 0;\n\t\t\t}\n\t\t\telse if(!value.slice(0,-1).includes(\".\")  && value[value.length-1] == \".\"){\n\t\t\t\tevent.target.value = value;\n\t\t\t}\n\t\t\telse if(value[value.length-1] == \".\"){\n\t\t\t\tevent.target.value = value.slice(0,-1);\n\t\t\t}\n\t\t\telse if(isNaN(value[value.length-1])){\n\t\t\t\tevent.target.value = value.slice(0,-1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tevent.target.value = value ;\n\t\t\t}\n\n\t\t\tlet newDiscount = this.discountInput.val();\n\n\t\t\tconsole.log(\"the new value \" , newDiscount)\n\n\t\t\tif(isNaN(newDiscount)){\n\t\t\t\tconsole.warn(\"Invalide discount value\")\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t//console.log(\"condition ==> \" , newDiscount<100 )\n\t\t\tif(newDiscount < 100){\n\t\t\t\tthis.on_input( \"input\" , \"discount_percentage\" , newDiscount)\n\t\t\t}\n\t\t\telse{\n\t\t\t\tevent.target.value = 100;\n\t\t\t\tthis.on_input( \"input\" , \"discount_percentage\" , 100)\n\t\t\t}\n\n\t\t})\n\n\t\tthis.discountInput.on('focus' , (event)=>{\n\t\t\tthis.on_input( \"focus\" , \"discount_percentage\" , null)\n\t\t})\n\n\t\tthis.discountInput.on('blur' , (event)=>{\n\t\t\tthis.on_input( \"blur\" , \"discount_percentage\" , null)\n\t\t})\n\n\n\t\t//discount field listener\n\t\tthis.discountMontantInput.on('input' , (event)=>{\n\t\t\tconst value = event.target.value ;\n\n\t\t\tif(value.length == 0){\n\t\t\t\tevent.target.value = 0;\n\t\t\t}\n\t\t\telse if(!value.slice(0,-1).includes(\".\")  && value[value.length-1] == \".\"){\n\t\t\t\tevent.target.value = value;\n\t\t\t}\n\t\t\telse if(value[value.length-1] == \".\"){\n\t\t\t\tevent.target.value = value.slice(0,-1);\n\t\t\t}\n\t\t\telse if(isNaN(value[value.length-1])){\n\t\t\t\tevent.target.value = value.slice(0,-1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tevent.target.value = value ;\n\t\t\t}\n\n\t\t\tlet newDiscount = this.discountMontantInput.val();\n\n\t\t\tif(isNaN(newDiscount)){\n\t\t\t\tconsole.warn(\"Invalide discount value\")\n\t\t\t\treturn\n\t\t\t}\n\n\t\t\t//console.log(\"condition ==> \" , newDiscount<100 )\n\t\t\tthis.on_input( \"input\" , \"discount_amount\" , newDiscount)\n\n\t\t})\n\n\t\tthis.discountMontantInput.on('focus' , (event)=>{\n\t\t\tconsole.log(\"we are here\")\n\t\t\tthis.on_input( \"focus\" , \"discount_amount\" , null)\n\t\t})\n\n\t\tthis.discountMontantInput.on('blur' , (event)=>{\n\t\t\tthis.on_input( \"blur\" , \"discount_amount\" , null)\n\t\t})\n\n\t}\n\n\n\t/*************************** funs  ************************************/\n\n\tgetItemPrice(itemId){\n\t\tconst price = this.item_prices.find(itemPrice => itemPrice.item_code == itemId)\n\t\treturn price ? price.price_list_rate  : 0\n\t}\n\n\n\tgetQtyInWarehouse(itemId , warehouseId){\n\t\tconst bin = this.bin_list.find(bin => bin.item_code == itemId && bin.warehouse == warehouseId)\n\t\treturn bin ? bin.actual_qty : 0\n\t}\n\n\n}\n", "\npos_ar.PointOfSale.pos_payment_cart = class{\n\n\tconstructor(\n\t\twrapper,\n\t\tselectedItemMap,\n\t\tselectedTab,\n\t\tappData,\n\t\tpaymentMethods,\n\t\tselectedPaymentMythod,\n\t\tinvoiceData,\n\t\tonClose,\n\t\tonComplete,\n\t\tonInput\n\t){\n\n\n\t\tthis.wrapper                 = wrapper               ;\n\t\tthis.selected_item_map       = selectedItemMap       ;\n\t\tthis.selected_tab            = selectedTab           ;\n\t\tthis.app_data                = appData               ;\n\t\tthis.payment_methods         = paymentMethods        ;\n\t\tthis.selected_payment_method = selectedPaymentMythod ;\n\t\tthis.invoice_data            = invoiceData           ;\n\t\tthis.on_close_cart           = onClose               ;\n\t\tthis.on_complete             = onComplete            ;\n\t\tthis.on_input                = onInput               ;\n\n\t\tthis._payment_method = this.payment_methods[0]\n\n\t\tthis.start_work();\n\t}\n\n\n\t/****************************************  UI ***********************************************/\n\n\tstart_work(){\n\t\tthis.prepare_payment_cart();\n\t\tthis.calculateGrandTotal()\n\t\tthis.setListeners()\n\t}\n\n\tprepare_payment_cart(){\n\t\tthis.wrapper.append('<div id=\"paymentMethodCart\" class=\"columnBox align_center\"></div>')\n\t\tthis.paymentCart = this.wrapper.find('#paymentMethodCart')\n\n                this.paymentCart.append(\n                                `<script src=\"https://unpkg.com/@dotlottie/player-component@2.7.12/dist/dotlottie-player.mjs\" type=\"module\"></script>`+\n                                `<div id=\"payment_waitingContainer\" style=\"position:absolute;background:#00000050;top:0;left:0;inset: 0;display:none;backdrop-filter: blur(2px);z-index: 10;\" class=\"rowBox centerItem\" ><dotlottie-player src=\"https://lottie.host/d6c76206-aab9-4d5a-af73-c4a6cfc5aaa9/H8vnpKcKj9.lottie\" background=\"transparent\" speed=\"1\" style=\"width: 300px; height: 300px\" loop autoplay></dotlottie-player></div>`\n                )\n\n\t\tthis.waiting_cart = this.wrapper.find('#payment_waitingContainer')\n\n\t\tthis.cart = this.wrapper.find('#paymentMethodCart')\n\t\tthis.cart.append('<div id=\"paymentMethodCartHeader\" class=\"rowBox header align_center row_sbtw\"></div>')\n\t\tthis.cart.append('<div id=\"paymentMethodContent\" class=\"columnBox align_center\"></div>')\n\t\tthis.cart.append('<div id=\"paymentMethodCartFooter\" class=\"columnBox align_center\"></div>')\n\n\t\tthis.cart_header  = this.cart.find('#paymentMethodCartHeader')\n\t\tthis.cart_content = this.cart.find('#paymentMethodContent')\n\t\tthis.cart_footer  = this.cart.find('#paymentMethodCartFooter')\n\n\t\tthis.cart_header.append('<h4 class=\"CartTitle\">Item Details</h4>')\n\t\tthis.cart_header.append('<img src=\"/assets/pos_ar/images/cancel.png\" alt=\"Cancel Button\" id=\"paymentMethodCartXBtn\" class=\"xBtn\">')\n\n\t\tthis.cart_header.find('#paymentMethodCartXBtn').on('click' , (event)=>{\n\t\t\tthis.on_close_cart();\n\t\t})\n\n\t\tthis.cart_content.append('<div id=\"paymentContentTopSection\" class=\"rowBox\"></div>')\n\t\tthis.cart_content.append('<div id=\"paymentContentBottomSection\" class=\"columnBox\"></div>')\n\n\t\tthis.cart_content_top_section    = this.cart_content.find('#paymentContentTopSection')\n\t\tthis.cart_content_bottom_section = this.cart_content.find('#paymentContentBottomSection')\n\n\n\t\tthis.payment_methods.forEach(method =>{\n\t\t\tconst selected    = this._payment_method.name == method.name ? \"selected\" : \"\" ;\n\t\t\tconst amountField = this.getModeOfPaymentById(method.mode_of_payment).type == 'Phone' ? \"display:none;\" : \"\"\n\t\t\tthis.cart_content_top_section.append(`<div id=\"${method.name}\" class=\"paymentMethodBox ${selected}\"><div id=\"BoxTitle\" class=\"title ${selected}\">${method.mode_of_payment}</div><input type=\"number\" id=\"cachInput\" class=\"paymentInput\" value=\"0\" style=\"${amountField}\"  ></div>`)\n\t\t})\n\n\n\t\tthis.cart_content_bottom_section.append('<h4>Additional Information</h4>')\n\n\t\tthis.cart_footer.append('<div id=\"paymentDetailsContainer\" class=\"rowBox align_center\"></div>');\n\t\tthis.cart_footer.append('<button class=\"posBtn1\" type=\"button\" id=\"completeOrderBtn\">Complete Order</button>');\n\n\t\tthis.payment_details = this.cart_footer.find('#paymentDetailsContainer')\n\t\tthis.payment_details.append('<div class=\"columnBox\"><div id=\"paymentGrandTotalTitle\" class=\"rowBox centerItem\">Grand Total</div><div id=\"paymentGrandTotalValue\" class=\"rowBox centerItem\"></div></div>')\n\t\tthis.payment_details.append('<hr>')\n\t\tthis.payment_details.append(`<div id=\"paymentPaidAmount\" class=\"columnBox\"><div id=\"paymentPaidAmountTitle\" class=\"rowBox centerItem\">Paid Amount</div><div id=\"paimentPaidAmountValue\"  class=\"rowBox centerItem\"> 0 DA </div></div>`)\n\t\tthis.payment_details.append('<hr>')\n\t\tthis.payment_details.append(`<div id=\"paymentToChange\" class=\"columnBox\"><div id=\"paimentToChangeTitle\" class=\"rowBox centerItem\">To Change</div><div id=\"paimentToChangeValue\"  class=\"rowBox centerItem\"> ${this.calculateToChange()} DA </div></div>`)\n\n\t}\n\n\n\n\tpreparDefault(){\n\t\tthis.calculateGrandTotal();\n\n\t\t//reset selected method\n\t\tthis._payment_method = this.payment_methods[0]\n\t\t//reset style for  method box\n\t\tthis.cart_content_top_section.find('.paymentMethodBox').removeClass('selected');\n\t\tthis.cart_content_top_section.find(`.paymentMethodBox#${this._payment_method.name}`).addClass('selected');\n\t\tthis.cart_content_top_section.find('.paymentMethodBox .title').removeClass('selected');\n\t\tthis.cart_content_top_section.find(`.paymentMethodBox#${this._payment_method.name} .title`).addClass('selected');\n\n\n\n\t\t// Get the selected payment method's box\n\t\tconst selectedBox = $(`#${this._payment_method.name}`);\n\t\tif (selectedBox.length) {\n\t\t\t// Set the input field value to grandTotal\n\t\t\tselectedBox.find('.paymentInput').val(this.invoice_data.grandTotal);\n\n\t\t\t// Update the payment method amount in the map\n\t\t\tthis.selected_item_map.get(this.selected_tab.tabName).payments.forEach(mode => {\n\t\t\t\tif (mode.mode_of_payment == this._payment_method.mode_of_payment) {\n\t\t\t\t\tmode.amount = this.invoice_data.grandTotal;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Update paid amount and change display\n\t\t\tthis.updatePaidAmount();\n\t\t\tthis.updateToChange();\n\t\t}\n\t}\n\n\n\tshowCart(){\n\t\tthis.cart.css('display' , 'flex');\n\t\tthis.preparDefault();\n\t\t//this.clearData();\n\t}\n\n\thideCart(){\n\t\tthis.cart.css('display' , 'none');\n\t}\n\n\tshow_waiting(){\n\t\tconsole.log(\"we are heeer display\" , this.waiting_cart)\n\t\tthis.waiting_cart.css('display' , 'flex')\n\t}\n\thide_waiting(){\n\t\tconsole.log(\"we are heeer for hide\")\n\t\tthis.waiting_cart.css('display' , 'none')\n\t}\n\n\t/*clearData(){\n\n\t\tthis.invoice_data.paidAmount = 0 ;\n\t\tthis.invoice_data.toChange = 0 ;\n\n\t\t//this.cashBox.find('#cachInput').val(0)\n\n\t\tthis.calculateGrandTotal();\n\t\tthis.updateToChange();\n\t\tthis.refreshPaidAmount();\n\n\t}*\n\n\n\trefreshData(){\n\t\tconsole.log(\"refreshing data\")\n\n\t\t//this.cashBox.find('#cachInput').val(this.invoice_data.paidAmount)\n\n\t\tthis.calculateGrandTotal();\n\t\tthis.calculateToChange();\n\t\tthis.refreshPaidAmount();\n\n\t}\n\n\t/****************************************  listeners  ***********************************************/\n\n\tsetListeners(){\n\n\t\tconst me = this\n\t\t// Use event delegation to handle clicks\n\t\tthis.cart_content_top_section.on('click', '.paymentMethodBox', function () {\n\t\t\t// Remove 'selected' class from all .paymentMethodBox elements\n\t\t\t$('.paymentMethodBox').removeClass('selected');\n\t\t\t$('.paymentMethodBox div.title').removeClass('selected');\n\t\t\t//add to clicked ones\n\t\t\t$(this).addClass('selected')\n\t\t\t$(this).find('.title').addClass('selected')\n\t\t\tconst clickedId = $(this).attr('id')\n\t\t\tme.payment_methods.forEach(method=>{\n\t\t\t\tif(method.name == clickedId){\n\t\t\t\t\tme._payment_method = method\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t// Reset input fields in all other boxes\n\t\t\t$('.paymentMethodBox').not(this).find('.paymentInput').val(0);\n \t\t\t// Set the selected box input field to grandTotal\n\t\t\t$(this).find('.paymentInput').val(me.invoice_data.grandTotal);\n\n\t\t\tme.selected_item_map.get(me.selected_tab.tabName).payments.forEach(mode =>{\n\t\t\t\tif(mode.mode_of_payment != me._payment_method.mode_of_payment){\n\t\t\t\t\tmode.amount = 0\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\t//check if not pay\n\t\t\t\t\tif(me.getModeOfPaymentById(mode.mode_of_payment).type == \"Phone\" ){\n\t\t\t\t\t\tmode.amount = 0\n\t\t\t\t\t}else{\n\t\t\t\t\t\tmode.amount = me.invoice_data.grandTotal\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t})\n\t\t\tme.updatePaidAmount()\n\t\t\tme.updateToChange()\n\t\t});\n\n\n\n\t\t// Add a listener for all inputs within .paymentMethodBox\n\t\tthis.cart_content_top_section.on('input', '.paymentInput', function () {\n\n\t\t\tconst inputValue = parseFloat($(this).val()) || 0; // Get the input value\n\t\t\tconst boxId = $(this).closest('.paymentMethodBox').attr('id'); // Get the box ID\n\n\t\t\tme.selected_item_map.get(me.selected_tab.tabName).payments.forEach(mode =>{\n\t\t\t\tif(mode.mode_of_payment == me._payment_method.mode_of_payment){\n\t\t\t\t\tmode.amount = parseFloat(inputValue)\n\t\t\t\t}\n\t\t\t})\n\t\t\tme.updatePaidAmount()\n\t\t\tme.updateToChange()\n\t\t});\n\n\n\t\t/*\n\t\tthis.cashBox.find('#cachInput').on('focus' , (event)=>{\n\t\t\tthis.on_input('focus' , 'cash' , null)\n\t\t})\n\t\t*/\n\n\n\t\tthis.cart_footer.find(\"#completeOrderBtn\").on('click' , (event)=>{\n\n\t\t\tfrappe.confirm('Submit the invoice ?',\n\t\t\t()=>{/*yes*/\n\t\t\t\tthis.on_complete()\n\t\t\t},()=>{\n\n\t\t\t})\n\t\t})\n\n\n\t}\n\n\n\t/************************************ tools  ***************************************/\n\n\n\thandleInput(key){\n\n\t\t/*\n\t\tlet previousValue = this.cashBox.find('#cachInput').val() ;\n\t\t// Check if the previous value contains a period (.)\n\t\tif( previousValue.includes('.') && key == \".\"){\n\t\t\treturn ;\n\t\t}\n\t\t// Append the key to the paidAmount if there is no period\n\t\tthis.invoice_data.paidAmount += key;\n\t\t// Refresh the payment cart\n\t\tthis.refreshData();*/\n\t}\n\n\tdeleteKeyPress(){\n\n\t\tlet cashField = this.cashBox.find('#cachInput');\n\t\tlet newValue = 0 ;\n\t\tlet cursor = cashField[0].selectionStart;\n\n\t\tcashField.val( (index , currentValue) =>{\n\t\t\tif( currentValue.length < 0 ){\n\t\t\t\tconsole.log(\"cnd 1\")\n\t\t\t\tnewValue = 0 ;\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\telse if( currentValue.length == 1){\n\t\t\t\tconsole.log(\"cnd 2\")\n\t\t\t\tnewValue = 0 ;\n\t\t\t\treturn 0 ;\n\t\t\t}\n\t\t\telse if( cursor == 0 ){\n\t\t\t\tconsole.log(\"cnd 3\")\n\t\t\t\tnewValue = currentValue;\n\t\t\t\treturn currentValue;\n\t\t\t}\n\t\t\telse if( cursor == currentValue.length){\n\t\t\t\tconsole.log(\"cnd 4\")\n\t\t\t\tnewValue = currentValue.slice(0 , cursor-1)\n\t\t\t\treturn currentValue.slice(0 , cursor-1)\n\t\t\t}\n\t\t\telse{\n\t\t\t\tconsole.log(\"cursor : \" , cursor ,\" current val ==> \" , currentValue , \" cnd 5 newValue ==> \" , currentValue.slice(0,cursor-1) + currentValue.slice(cursor))\n\t\t\t\tnewValue = currentValue.slice(0,cursor-1) + currentValue.slice(cursor)\n\t\t\t\treturn currentValue.slice(0,cursor-1) + currentValue.slice(cursor)\n\t\t\t}\n\t\t})\n\n\t\tconsole.log(\"we are in newValue ==> \" , newValue);\n\n\t\tthis.invoice_data.paidAmount = newValue;\n\n\t\t// Use setTimeout to ensure the new value is set before adjusting cursor\n\t\tsetTimeout(() => {\n\t\t\tcashField[0].setSelectionRange(cursor - 1, cursor - 1); // Move cursor back after deletion\n\t\t\tcashField[0].focus(); // Ensure the input is focused\n\t\t}, 0);\n\n\t\tthis.refreshData();\n\t}\n\n\n\tcalculatePaidAmount(){\n\t\tlet paidAmountDA = 0;\n\t\tthis.selected_item_map.get(this.selected_tab.tabName).payments.forEach(mode =>{\n\t\t\tpaidAmountDA += mode.amount\n\t\t})\n\t\treturn paidAmountDA\n\t}\n\n\tupdatePaidAmount(){\n\t\tthis.payment_details.find('#paimentPaidAmountValue').text(`${this.calculatePaidAmount()} DA`)\n\t}\n\n\n\tcalculateToChange(){\n\t\tconsole.log(\"see why the error \" , \" calculatePaidAmount \" ,  this.calculatePaidAmount() , \" grandTotal \" , this.invoice_data.grandTotal)\n\t\treturn this.calculatePaidAmount() - this.invoice_data.grandTotal\n\t}\n\n\n\tupdateToChange(){\n\t\tthis.payment_details.find('#paimentToChangeValue').text(`${this.calculateToChange().toFixed(2)} DA`)\n\t}\n\n\n\tcalculateGrandTotal(){\n\t\tthis.payment_details.find('#paymentGrandTotalValue').text(`${this.invoice_data.grandTotal.toFixed(2)} DA`)\n\t\treturn parseFloat(this.invoice_data.grandTotal.toFixed(2))\n\t}\n\n\n\n\n\tgetModeOfPaymentById(id){\n\t\tlet r = null\n\t\tthis.app_data.posProfileModeOfPayments.forEach(mode=>{\n\t\t\tif(mode.name == id){\n\t\t\t\tr = mode\n\t\t\t}\n\t\t})\n\t\treturn r\n\t}\n\n}\n", "pos_ar.PointOfSale.pos_history = class {\n\n\tconstructor(\n\t\twrapper,\n\t\tdb,\n\t\tselectedPosProfile,\n\t\tappData,\n\t\tappSettings,\n\t\tcompany,\n\t\tsalesTaxes,\n\t\tonClick\n\t){\n\t\tthis.wrapper               = wrapper     ;\n\t\tthis.db                    = db          ;\n\t\tthis.selected_pos_profile  = selectedPosProfile;\n\t\tthis.app_data              = appData     ;\n\t\tthis.app_settings          = appSettings ;\n\t\tthis.company               = company     ;\n\t\tthis.sales_taxes           = salesTaxes  ;\n\t\tthis.on_click              = onClick     ;\n\n\t\t//local data\n\t\tthis.localPosInvoice   = { lastTime : null , pos_invoices : [] }\n\t\tthis.filter            = \"\" ;\n\t\tthis.search_value      = \"\" ;\n\n\t\tthis.filtered_pos_list = [] ;\n\t\tthis.selected_pos      = null ;\n\n\t\tthis.start_work();\n\t}\n\n\tasync start_work(){\n\t\tthis.prepare_history_cart();\n\t\tconst result = await this.db.getAllPosInvoice()\n\n\t\tthis.localPosInvoice.pos_invoices = result ;\n\n\t\tthis.filtered_pos_list = this.localPosInvoice.pos_invoices.filter( pos => {\n\t\t\tif(pos.status == 'Unpaid' ){\n\t\t\t\treturn true ;\n\t\t\t}else{\n\t\t\t\treturn false ;\n\t\t\t}\n\t\t})\n\t\tconsole.log(\"log init data : \" , this.filtered_pos_list)\n\t\tif(this.filtered_pos_list.length == 0){\n\t\t\tthis.selected_pos = null\n\t\t}else{\n\t\t\tthis.selected_pos = structuredClone(this.filtered_pos_list[0])\n\t\t}\n\t\tthis.refreshData()\n\t\tthis.setListener();\n\t}\n\n\n\t/*************************************    UI    *******************************************************/\n\n\tprepare_history_cart(){\n\t\tthis.wrapper.find('#LeftSection').append('<div id=\"historyLeftContainer\" class=\"columnBox\"></div>')\n\t\tthis.wrapper.find('#RightSection').append('<div id=\"historyRightContainer\" class=\"columnBox\"></div>')\n\n\t\tthis.left_container  = this.wrapper.find('#historyLeftContainer')\n\t\tthis.right_container = this.wrapper.find('#historyRightContainer')\n\n\n\t\t//pos details  the container of the pos details\n\t\tthis.left_container.append('<div id=\"PosContentHeader\" class=\"rowBox\" ><div class=\"c1 columnBox\"><div id=\"posCustomer\">Customer</div><div id=\"posSoldBy\"></div><div id=\"posStatus\" class=\"Paid\"></div></div><div class=\"c2 columnBox\"><div id=\"posCost\">0,0000 DA</div><div id=\"posId\">ACC-PSINV-2024-ID</div><div id=\"posRealId\">POS realI</div></div></div>')\n\n\t\t//first this.selected_pos.taxes_and_charges = \"\"section is the header information\n\t\tthis.pos_header = this.left_container.find('#PosContentHeader');\n\n\t\tthis.left_container.append('<div id=\"posContent\" class=\"columnBox\"></div>')\n\n\t\t//second section is the data like items , cost and payments methods.\n\t\tthis.pos_content = this.left_container.find('#posContent')\n\t\tthis.pos_content.append('<div id=\"posItemContainer\"><div class=\"posSectionTitle\">Items</div><div id=\"posItemList\"></div></div>')\n\n\t\tthis.itemContainer = this.pos_content.find('#posItemContainer')\n\t\tthis.itemList      = this.itemContainer.find('#posItemList')\n\n\t\tthis.pos_content.append('<div id=\"posTotalsContainer\"><div class=\"posSectionTitle\">Totals</div><div id=\"posTotalList\"></div></div>')\n\n\t\tthis.totalsContainer = this.pos_content.find('#posTotalsContainer')\n\t\tthis.totalList       = this.pos_content.find('#posTotalList')\n\n\t\tthis.pos_content.append('<div id=\"posPaymentsContainer\"><div class=\"posSectionTitle\">Payments</div><div id=\"posMethodList\"></div></div>')\n\n\t\tthis.paymentsContainer = this.pos_content.find('#posPaymentsContainer')\n\t\tthis.methodList        = this.pos_content.find('#posMethodList')\n\n\t\tthis.left_container.append('<div id=\"posActionsContainer\" class=\"rowBox align_content\"  style=\"display = none ;\" > <div id=\"posPrintBtn\" class=\"actionBtn rowBox centerItem\"> Print Receipt </div>  <div id=\"posDuplicateBtn\" class=\"actionBtn rowBox centerItem\"> Duplicate </div>   <div id=\"posReturnBtn\" class=\"actionBtn rowBox centerItem\"> Return </div>  </div>')\n\t\tthis.left_container.append('<div id=\"posDraftActionsContainer\" class=\"rowBox align_content\" style=\"display = none ;\"> <div id=\"posEditBtn\" class=\"actionBtn rowBox centerItem\"> Edit Invoice </div>  <div id=\"posDeleteBtn\" class=\"actionBtn rowBox centerItem\"> Delete Invoice </div>  </div>')\n\n\t\t//third and last section is the action buttons\n\t\tthis.actionButtonsContainer = this.left_container.find('#posActionsContainer')\n\t\tthis.printBtn      = this.actionButtonsContainer.find('#posPrintBtn')\n\t\tthis.duplicateBtn  = this.actionButtonsContainer.find('#posDuplicateBtn')\n\t\tthis.returnBtn     = this.actionButtonsContainer.find('#posReturnBtn')\n\n\t\tthis.draftActionButtonsContainer = this.left_container.find('#posDraftActionsContainer')\n\t\tthis.deleteBtn  = this.draftActionButtonsContainer.find('#posDeleteBtn')\n\t\tthis.editBtn    = this.draftActionButtonsContainer.find('#posEditBtn')\n\n\n\t\tthis.right_container.append(`<div id=\"historyRightContainerHeader\" class=\"rowBox align_center\" ><h4 class=\"CartTitle\">Recent Orders</h4></div>`)\n\t\tthis.right_container.append('<div id=\"historyRightSearchContainer\" class=\"rowBox align_center\" ></div>');\n\n\t\tthis.search_container = this.right_container.find('#historyRightSearchContainer');\n\t\tthis.search_container.append('<select  id=\"PosInvoiceTypeInput\" placeholder=\"POS Invoice Type\">');\n\n\t\tthis.filter_input = this.search_container.find(\"#PosInvoiceTypeInput\")\n\t\tthis.filter_input.append('<option value=\"Draft\">Draft</option><option value=\"Paid\">Paid</option> <option value=\"Unpaid\" selected>Unpaid</option>')\n\n\t\tthis.search_container.append('<input type=\"text\" id=\"historyInput\" placeholder=\"Search by invoice id or custumer name\">');\n\t\tthis.search_field = this.search_container.find(\"#historyInput\")\n\n\t\tthis.right_container.append('<div id=\"historyRecentInvoicesContainer\" ></div>');\n\n\t\tthis.right_data_container = this.right_container.find('#historyRecentInvoicesContainer')\n\t}\n\n\n\trefreshData(){\n\t\tthis.right_data_container.html('');\n\n\t\tthis.filtered_pos_list.forEach( record => {\n\n\t\t\tconst posContainer = document.createElement('div');\n\t\t\tposContainer.classList.add('posInvoiceContainer')\n\t\t\tposContainer.classList.add('columnBox')\n\t\t\tposContainer.classList.add('align_content')\n\n\t\t\t//line 1\n\t\t\tconst l1           = document.createElement('div')\n\t\t\tl1.classList.add('l1')\n\t\t\tl1.classList.add('rowBox')\n\t\t\tl1.classList.add('align_content')\n\n\t\t\tconst posName      = document.createElement('div')\n\t\t\tposName.classList.add('posName')\n\t\t\tposName.textContent = record.refNum\n\n\t\t\tconst posCost      = document.createElement('div')\n\t\t\tposCost.classList.add('posCost')\n\t\t\tposCost.textContent = record.paid_amount + \" DA\" ?? 0 + \" DA\"\n\n\t\t\tl1.appendChild(posName)\n\t\t\tif (record.consolidated_invoice) {\n                const consolidatedFlag = document.createElement('div')\n                consolidatedFlag.classList.add('consolidated-flag')\n\t\t\t\tconsolidatedFlag.style.margin = '0 8px 0 8px'\n                consolidatedFlag.innerHTML = `Consolidated`\n                l1.appendChild(consolidatedFlag)\n            }\n            l1.appendChild(posCost)\n\n\t\t\t///////////// line 2\n\t\t\tconst l2           = document.createElement('div')\n\t\t\tl2.classList.add('l2')\n\t\t\tl2.classList.add('rowBox')\n\t\t\tl2.classList.add('align_content')\n\n\t\t\t//l2 customer\n\t\t\tconst customer = document.createElement('div')\n\t\t\tcustomer.classList.add('customer')\n\t\t\tcustomer.classList.add('rowBox')\n\t\t\tcustomer.classList.add('align_content')\n\n\t\t\tconst customerLogo  = document.createElement('img')\n\t\t\tcustomerLogo.src    = '/assets/pos_ar/images/customer.png' ;\n\t\t\tcustomerLogo.width  = 16 ;\n\t\t\tcustomerLogo.height = 16 ;\n\t\t\tcustomerLogo.classList.add('customerLogo');\n\n\t\t\tconst customerName       = document.createElement('div')\n\t\t\tcustomerName.textContent = record.customer\n\t\t\tcustomerName.classList.add('customerName');\n\n\t\t\tcustomer.appendChild(customerLogo);\n\t\t\tcustomer.appendChild(customerName);\n\n\t\t\tl2.appendChild(customer);\n\n\t\t\t//l2 creation time\n\t\t\tconst creationTime  = document.createElement('div')\n\t\t\tcreationTime.textContent = record.creation_time\n\t\t\tl2.appendChild(creationTime);\n\n\t\t\tposContainer.appendChild(l1)\n\t\t\tposContainer.appendChild(l2)\n\n\t\t\tposContainer.addEventListener('click' , () => {\n\t\t\t\tconsole.log('click' , record)\n\t\t\t\tthis.selected_pos = record\n\t\t\t\tthis.refreshPosDetailsData();\n\t\t\t})\n\n\t\t\tthis.right_data_container.append(posContainer);\n\t\t})\n\n\n\t\t//dont forget to refresh the details cart view because the selected pos may change\n\t\tthis.refreshPosDetailsData();\n\n\t}\n\n\n\n\trefreshPosDetailsData(){\n\n\t\t/******************  check if there is a selected one *********************/\n\t\t// render the empty page or the selected pos details.\n\t\tif(this.selected_pos == null ){\n\t\t\tthis.setEmpty();\n\t\t\treturn;\n\t\t}else{\n\t\t\tthis.setData();\n\t\t}\n\n\t\tthis.pos_header.find('#posCustomer').text(this.selected_pos.customer?? \"CustomerName\")\n\t\t//this.pos_header.find('#posSoldBy').text('Sold By : ' + this.selected_pos.owner?? \"saler\")\n\t\t//it is not the paid amount it should be the total invoice amount\n\t\tthis.pos_header.find('#posCost').text(this.selected_pos.paid_amount +\" DA\" ??0 + \" DA\")\n\t\tthis.pos_header.find('#posId').text(this.selected_pos.refNum?? \"POS Invoice CachId\")\n\n\t\tthis.pos_header.find('#posRealId').text(this.selected_pos.real_name ?? \"\")\n\n\t\tthis.pos_header.find('#posStatus').text(this.selected_pos.status)\n\t\tthis.pos_header.find('#posStatus').removeClass().addClass(`${this.selected_pos.status}`)\n\n        // Add consolidated information if present\n        if (this.selected_pos.consolidated_invoice) {\n            if (!this.pos_header.find('#posConsolidated').length) {\n                this.pos_header.find('.c1').append('<div id=\"posConsolidated\" class=\"consolidated-info\"></div>')\n            }\n            this.pos_header.find('#posConsolidated').html(`\n                <span class=\"consolidated-label\">Consolidated:</span>\n                <span class=\"consolidated-value\">${this.selected_pos.consolidated_invoice}</span>\n            `)\n        } else {\n            this.pos_header.find('#posConsolidated').remove()\n        }\n\n\t\tif(this.selected_pos.status == \"Draft\"){\n\t\t\tthis.draftActionButtonsContainer.css('display' , 'flex')\n\t\t\tthis.actionButtonsContainer.css('display' , 'none')\n\t\t}else{\n\t\t\tthis.draftActionButtonsContainer.css('display' , 'none')\n\t\t\tthis.actionButtonsContainer.css('display' , 'flex')\n\t\t}\n\n\n\t\t/**********************  items list ***************************/\n\t\tthis.itemList.html('');\n\t\tthis.selected_pos.items.forEach(item => {\n\t\t\tthis.itemList.append(`<div class=\"rowBox align_item\">    <div class=\"itemName rowBox align_center\">${item.item_name}</div>   <div class=\"itemQuantity rowBox align_center\">${item.qty}</div>   <div class=\"itemCost rowBox align_center\">${item.qty * item.rate} DA</div>  </div>`)\n\t\t})\n\n\n\t\t/*********************  net ,  VAT  , Discount , Grand Total *******************/\n\n\t\tthis.totalList.html('');\n\n\n\t\t//if there are no taxes we should show only the grand total\n\n\t\t/////net total\n\t\tlet netTotal = 0 ;\n\t\tthis.selected_pos.items.forEach(item => {\n\t\t\tnetTotal += item.rate * item.qty\n\t\t})\n\n\n\t\tif(this.selected_pos.taxes_and_charges == \"\" || this.selected_pos.taxes_and_charges == null){\n\t\t\t// grand otal\n\t\t\tthis.totalList.append(`<div class=\"rowBox align_item\"> <div class=\"grandTotalName rowBox align_center\">Grand Total</div> <div class=\"grandTotalPrice rowBox align_center\">${netTotal} DA</div> </div>`)\n\t\t}else{\n\t\t\tthis.totalList.append(`<div class=\"rowBox align_item\"> <div class=\"name rowBox align_center\">Net Total</div> <div class=\"price rowBox align_center\">${netTotal} DA</div> </div>`)\n\t\t\tlet allTax = 0\n\t\t\tif(this.selected_pos.taxes_and_charges != \"\" && this.selected_pos.taxes_and_charges != null){\n\t\t\t\tthis.sales_taxes.forEach( tax =>{\n\t\t\t\t\tallTax += (tax.rate/100) * netTotal\n\t\t\t\t\tthis.totalList.append(`<div class=\"rowBox align_item\"> <div class=\"name rowBox align_center\">${tax.description}</div> <div class=\"price rowBox align_center\">${(tax.rate/100) * netTotal} DA</div> </div>`)\n\t\t\t\t})\n\t\t\t}\n\t\t\t// grand otal\n\t\t\tthis.totalList.append(`<div class=\"rowBox align_item\"> <div class=\"grandTotalName rowBox align_center\">Grand Total</div> <div class=\"grandTotalPrice rowBox align_center\">${netTotal + allTax} DA</div> </div>`)\n\t\t}\n\n\n\n\n\n\n\t\t/***************************** payment methode list *********************************/\n\t\tthis.methodList.html('')\n\t\tconst payments = this.selected_pos.payments ;\n\n\t\tif(payments != null && payments != \"\"){\n\t\t\tpayments.forEach( method => {\n\t\t\t\tthis.methodList.append(`<div class=\"rowBox align_item\"> <div class=\"name rowBox align_center\">${method.mode_of_payment}</div> <div class=\"price rowBox align_center\">${method.amount} DA</div> </div>`)\n\t\t\t})\n\t\t}\n\n\t}\n\n\n\n\t//show and hide\n\tshow_cart(){\n\t\tthis.left_container.css('display' , 'flex');\n\t\tthis.right_container.css('display' , 'flex');\n\n\t\tconst filter = this.filter_input.val();\n\n\t\t//refrenshing data\n\t\tthis.db.getAllPosInvoice_callback(\n\t\t\t\t\t\t(result)=>{\n\t\t\t\t\t\t\tthis.localPosInvoice.pos_invoices = result ;\n\t\t\t\t\t\t\tthis.filtered_pos_list = this.localPosInvoice.pos_invoices.filter( pos => {\n\n\t\t\t\t\t\t\t\tif(pos.status == filter ){\n\t\t\t\t\t\t\t\t\treturn true ;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\treturn false ;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\n\t\t\t\t\t\t\tif(this.filtered_pos_list.length == 0){\n\t\t\t\t\t\t\t\tthis.selected_pos = null\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tthis.selected_pos = this.filtered_pos_list[0]\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.refreshData()\n\t\t\t\t\t\t},(error) => {\n\t\t\t\t\t\t\tconsole.log(error)\n\t\t\t\t\t\t}\n\t\t)\n\n\t}\n\n\t//hide and hide\n\thide_cart(){\n\t\tthis.left_container.css('display' , 'none');\n\t\tthis.right_container.css('display' , 'none');\n\t}\n\n\n\t//set empty\n\tsetEmpty(){\n\t\tthis.pos_header.css('display' , 'none')\n\t\tthis.pos_content.css('display' , 'none')\n\t\tthis.actionButtonsContainer.css('display' , 'none')\n\t\tthis.draftActionButtonsContainer.css('display' , 'none')\n\t}\n\n\t//set data\n\tsetData(){\n\t\tthis.pos_header.css('display' , 'flex')\n\t\tthis.pos_content.css('display' , 'flex')\n\t}\n\n\n\n\t/************************************* set listeners  ***********************************************/\n\t//set listeners\n\tsetListener(){\n\n\t\tthis.filter_input.on('input' , (event) => {\n\t\t\tconsole.log(\"we are here1\")\n\t\t\tthis.filterList( this.search_field.val() , this.filter_input.val())\n\t\t});\n\n\t\tthis.search_field.on('input' , (event) =>{\n\t\t\tconsole.log(\"we are here2\")\n\t\t\tthis.filterList( this.search_field.val() , this.filter_input.val())\n\t\t})\n\n\t\tthis.deleteBtn.on('click' , (event)=>{\n\t\t\tthis.db.deletePosInvoice_callback(\n\t\t\t\tthis.selected_pos.name,\n\t\t\t\t(event)=>{\n\t\t\t\t\t//remove the deleted one from the filtred list\n\t\t\t\t\tthis.filtered_pos_list = this.filtered_pos_list.filter(pos => pos.name != this.selected_pos.name)\n\t\t\t\t\t//selected new pos\n\t\t\t\t\tif(this.filtered_pos_list.length > 0){\n\t\t\t\t\t\tthis.selected_pos = this.filtered_pos_list[0]\n\t\t\t\t\t}\n\t\t\t\t\telse{\n\t\t\t\t\t\tthis.selected_pos = null ;\n\t\t\t\t\t}\n\t\t\t\t\tthis.refreshData()\n\t\t\t\t},\n\t\t\t\t(error)=>{\n\t\t\t\t\t//error callback\n\t\t\t\t\tconsole.log(\"error on deleting the pos : \" , error);\n\t\t\t\t}\n\t\t\t)\n\t\t})\n\n\t\tthis.editBtn.on('click' , (event)=>{\n\t\t\tthis.on_click('edit' , this.selected_pos );\n\t\t})\n\n\t\tthis.returnBtn.on('click' , (event)=>{\n\t\t\tconsole.log(\"returned invoice : \" , this.selected_pos)\n\t\t\tthis.on_click('return' , this.selected_pos );\n\t\t})\n\n\t\tthis.printBtn.on('click' , (event)=>{\n\t\t\tthis.print_receipt(this.selected_pos)\n\t\t})\n\n\t\tthis.duplicateBtn.on('click' , (event)=>{\n\t\t\tthis.on_click('duplicate' , this.selected_pos );\n\t\t})\n\n\t}\n\n\t/******************************************** functions  ********************************************************/\n\n\n\tfilterList(search , filter){\n\t\tconsole.log(\"log : \" , this.filtered_pos_list)\n\t\tthis.filtered_pos_list = this.localPosInvoice.pos_invoices.filter( pos => {\n\n\n\t\t\tconst matchesCustomer  = (pos.customer  || \"\" ).toLowerCase().includes(search.toLowerCase());\n\t\t\tconst matchesRefNum    = (pos.refNum    || \"\" ).toLowerCase().includes(search.toLowerCase());\n\t\t\tconst matchesName      = (pos.real_name || \"\" ).toLowerCase().includes(search.toLowerCase());\n\t\t\tconst matchesAll       = search == \"\" ;\n\t\t\tconst matchesFilter    = pos.status == filter ;\n\n\t\t\treturn matchesFilter && ( matchesCustomer || matchesRefNum  || matchesName ||  matchesAll );\n\t\t})\n\n\t\tif(this.filtered_pos_list.length == 0){\n\t\t\tthis.selected_pos = null;\n\t\t}else{\n\t\t\tthis.selected_pos = this.filtered_pos_list[0]\n\t\t\tconsole.log(\"debuging invoice : \" , this.selected_pos , \"and : \" , this.filtered_pos_list)\n\t\t}\n\t\tthis.refreshData();\n\t}\n\n\n\tasync print_receipt(pos) {\n\n\t\tlet netTotal   = 0\n\t\tlet taxes      = 0\n\t\tlet grandTotal = 0\n\n\t\tconsole.log(\"appData : \" , this.app_data)\n\t\tlet customer = this.app_data.appData.customers.find(customer => customer.name == pos.customer)\n\n\t\tlet ancien_sold = customer.custom_debt;\n\n\t\tconsole.log(\"check the condition : \" , this.app_settings.settings.onlineDebt )\n\t\tif(this.app_settings.settings.onlineDebt){\n\t\t\tancien_sold = await this.app_data.fetchCustomerDebt(customer.name);\n\t\t\tconsole.log(\"the result id : \" , ancien_sold)\n\t\t}\n\n\t\tconst creation_time = pos.creation_time\n\t\tconst [date, time]  = creation_time.split(' ')\n\n\n\t\tlet invoiceHTML =\n\t\t\t'<style>'+\n\t\t\t\t'#company_container {'+\n\t\t\t\t\t'width: 100% ; height: 40px ; '+\n\t\t\t\t\t'display:flex; align-items:center; '+\n\t\t\t\t\t'font-size : 12px;'+\n\t\t\t\t'}'+\n\t\t\t\t'table{'+\n\t\t\t\t\t//'border: 1px solid #505050; border-spacing:0px;'+\n\t\t\t\t\t'width: 100%; margin-top:16px;'+\n\t\t\t\t'}'+\n\t\t\t\t'tr{'+\n\t\t\t\t\t'width:100%; height:16px;'+\n\t\t\t\t'}'+\n\t\t\t\t'tr:nth-child(1){'+\n\t\t\t\t\t''+\n\t\t\t\t'}'+\n\t\t\t\t'#first_row{'+\n\t\t\t\t\t'border: 5px solid black;'+\n\t\t\t\t'}'+\n\t\t\t\t'#logContainer{'+\n\t\t\t\t\t'width: 100%;height:80px;'+\n\t\t\t\t\t'display : flex;'+\n\t\t\t\t\t'justify-content:center;'+\n\t\t\t\t'}'+\n\t\t\t\t'#logContainer img{'+\n\t\t\t\t\t'width:50%; height:100%;'+\n\t\t\t\t'}'+\n\t\t\t\t'#top_data_container{'+\n\t\t\t\t\t'width:100%;display:flex;'+\n\t\t\t\t'}'+\n\t\t\t\t'#top_data_container>div.c1{'+\n\t\t\t\t\t'font-size:12px;flex-grow:1;'+\n\t\t\t\t'}'+\n\t\t\t\t'#top_data_container>div.c2{'+\n\t\t\t\t\t'font-size:12px;flex-grow:1;'+\n\t\t\t\t\t'display:flex;flex-direction:column;align-items:end;'+\n\t\t\t\t'}'+\n\t\t\t\t'td>div{'+\n\t\t\t\t\t'height:18px; width:100%;'+\n\t\t\t\t\t'font-size:12px;'+\n\t\t\t\t\t'display:flex; justify-content:start; align-items:center;'+\n\t\t\t\t'}'+\n\t\t\t\t'#footer_message{'+\n\t\t\t\t\t'height:20px;'+\n\t\t\t\t'}'+\n\t\t\t\t'</style>'+\n\t\t\t\t'<div style=\"display:flex; flex-direction:column;\">'+\n\t\t\t\t\t'<div id=\"logContainer\"  >'+\n\t\t\t\t\t\t'<div style=\"width:20%;\"></div>'+\n\t\t\t\t\t\t'<img src=\"/assets/pos_ar/images/logo.jpg\"  id=\"company_logo\">'+\n\t\t\t\t\t\t'<div style=\"width:20%;\"></div>'+\n\t\t\t\t\t'</div>'+\n\t\t\t\t\t'<div id=\"company_container\">' +\n\t\t\t\t\t\t'<div style=\"flex-grow:1;\"></div>'+\n\t\t\t\t\t\t`<p style=\"margin:0px 25px;\">${this.company.company_name}</p>`+\n\t\t\t\t\t\t'<div style=\"flex-grow:1;\"></div>'+\n\t\t\t\t\t'</div>'+\n\t\t\t\t\t'<div id=\"top_data_container\">'+\n\t\t\t\t\t\t'<div class=\"c1\">'+\n\t\t\t\t\t\t\t`<div class=\"customer\" style=\"font-weight:600;font-size:18px;\"> Customer : ${pos.customer} </div>`+\n\t\t\t\t\t\t\t`<div class=\"refrence\"> Commande : ${pos.refNum} </div>`+\n\t\t\t\t\t\t'</div>'+\n\t\t\t\t\t\t'<div class=\"c2\">'+\n\t\t\t\t\t\t\t`<div class=\"date\"> ${date}/${time} </div>`+\n\t\t\t\t\t\t'</div>'+\n\t\t\t\t\t'</div>'+\n\t\t\t\t\t'<table>'+\n\t\t\t\t\t\t'<tr id=\"first_row\" ><th style=\"boder:1px solid black;\">Nom</th><th>Qt\u00E9</th><th>Prix</th><th>Value</th>'\n\n\t\tpos.items.forEach(item => {\n\t\t\tnetTotal    += item.rate * item.qty\n\t\t\tinvoiceHTML += `<tr > <td ><div >${item.item_name}</div></td>  <td><div>${item.qty}</div></td>  <td><div>${item.rate}</div></td>  <td><div>${item.rate * item.qty}</div></td></tr>`\n\t\t})\n\n\t\t\tinvoiceHTML += `<tr style=\"height:23px;font-size:12px;font-weight:700;\" > <td colspan=\"3\" ><div >      </div></td>   <td><div> ${netTotal+(netTotal*(taxes/100)) - pos.additional_discount_percentage * netTotal} DA </div></td></tr>`\n\t\t\tinvoiceHTML += `<tr style=\"height:23px;font-size:12px;font-weight:700;\" > <td colspan=\"3\" ><div >Ancien Sold        </div></td>   <td><div> ${ancien_sold} DA </div></td></tr>`\n\t\t\t//invoiceHTML += `<tr style=\"height:23px;font-size:12px;font-weight:700;\" > <td colspan=\"3\" ><div >Versement   </div></td>   <td><div> ${pos.total_customer_payment} DA </div></td></tr>`\n\n\n\n\t\tinvoiceHTML += '</table>'\n\n\t\t/*\n\n\t\tinvoiceHTML += `<div style=\"height:23px;\"> <p style=\"font-size:12px;font-weight:500;\" ><span style=\"font-size:12px;font-weight:600;\">Sous-total : </span> ${netTotal} DA </p> </div>`\n\t\tinvoiceHTML += `<div style=\"height:23px;\"> <p style=\"font-size:12px;font-weight:500;\" ><span style=\"font-size:12px;font-weight:600;\">Reduction : </span> ${pos.additional_discount_percentage * netTotal} DA </p> </div>`\n\n\t\tthis.sales_taxes.forEach(tax => {\n\t\t\ttaxes += tax.rate\n\t\t\tinvoiceHTML += `<div style=\"height:23px;\"> <p style=\"font-size:12px;font-weight:500;\" ><span style=\"font-size:12px;font-weight:600;\">${tax.description} : </span> ${tax.rate} % </p> </div>`\n\t\t})\n\n\t\tinvoiceHTML += `<div style=\"height:23px;\"> <p style=\"font-size:12px;font-weight:500;\" ><span style=\"font-size:12px;font-weight:600;\">Total : </span> ${netTotal+(netTotal*(taxes/100)) - pos.additional_discount_percentage * netTotal} DA </p> </div>`\n\t\t*/\n\n\t\tinvoiceHTML +=\n\t\t'<div id=\"footer_message\" style=\"width:100%; display:flex; align-items:center; margin-top:30px;\">'+\n\t\t\t'<div style=\"flex-grow:1;\"></div>'+\n\t\t\t'<div style=\"margin:30px 25px;\"> Thank You, Come Again</div>'+\n\t\t\t'<div style=\"flex-grow:1;\"></div>'+\n\t\t'</div>'\n\n\t\tinvoiceHTML += '</div>'\n\n\n\n\t\t// Open a new window and print the HTML content\n\t\tconst printWindow = window.open('', '_blank');\n\t\tprintWindow.document.write(invoiceHTML);\n\t\tprintWindow.document.close();\n\n\n\t\tconst logoImage = printWindow.document.getElementById('company_logo');\n\t\tlogoImage.onload = () => {\n\t\t\tprintWindow.focus();\n\t\t\tprintWindow.print();\n\t\t\tprintWindow.close();\n\t\t};\n\n\n\n\n        }\n\n}\n", "pos_ar.PointOfSale.pos_db  = class POSDatabase {\n\n\tconstructor(db) {\n\t\tthis.db = db;\n\t\tthis.setupDatabase();\n\t}\n\n\n\tstatic async openDatabase(){\n\t\treturn new Promise((resolve , reject) => {\n\n\t\t\t// Let us open our database\n\t\t\tconst request = window.indexedDB.open( 'POSDB_test33' , 8);\n\n\t\t\trequest.onerror = (event) => {\n\t\t\t\t// Do something with request.error!\n\t\t\t\treject(request.error)\n\t\t\t};\n\n\t\t\trequest.onsuccess = (event) => {\n\t\t\t\t// Do something with request.result!\n\t\t\t\tresolve(new pos_ar.PointOfSale.pos_db(event.target.result))\n\t\t\t};\n\n \t\t\trequest.onupgradeneeded = (event) => {\n\t\t\t \tconst db = event.target.result;\n\n\n\t\t\t\t let posInvoiceStore;\n\t\t\t\t let checkInOutStore;\n\n\t\t\t\t// Create object stores (tables)\n\t\t\t\tif (!db.objectStoreNames.contains('Customer')) {\n\t\t\t\t\tdb.createObjectStore('Customer', { keyPath: 'name' });\n\t\t\t\t}\n\t\t\t\tif (!db.objectStoreNames.contains('Item Group')) {\n\t\t\t\t\tdb.createObjectStore('Item Group', { keyPath: 'name' });\n\t\t\t\t}\n\t\t\t\tif (!db.objectStoreNames.contains('Item')) {\n\t\t\t\t\tdb.createObjectStore('Item', { keyPath: 'name' });\n\t\t\t\t}\n\t\t\t\tif (!db.objectStoreNames.contains('Item Price')) {\n\t\t\t\t\tdb.createObjectStore('Item Price', { keyPath: 'name' });\n\t\t\t\t}\n\t\t\t\tif (!db.objectStoreNames.contains('Price List')) {\n\t\t\t\t\tdb.createObjectStore('Price List', { keyPath: 'name' });\n\t\t\t\t}\n\t\t\t\tif (!db.objectStoreNames.contains('Warehouse')) {\n\t\t\t\t\tdb.createObjectStore('Warehouse', { keyPath: 'name' });\n\t\t\t\t}\n\t\t\t\tif (!db.objectStoreNames.contains('POS Profile')) {\n\t\t\t\t\tdb.createObjectStore('POS Profile', { keyPath: 'name' });\n\t\t\t\t}\n\t\t\t\tif (!db.objectStoreNames.contains('Bin')) {\n\t\t\t\t\tdb.createObjectStore('Bin', { keyPath: 'name' });\n\t\t\t\t}\n\n\t\t\t\t//pos invoice\n\t\t\t\tif (!db.objectStoreNames.contains('POS Invoice')) {\n\t\t\t\t\tposInvoiceStore = db.createObjectStore('POS Invoice', { keyPath : 'name' });\n\t\t\t\t}else{\n\t\t\t\t\tposInvoiceStore = event.target.transaction.objectStore('POS Invoice');\n\t\t\t\t}\n\n\n\t\t\t\t// Check and create indexes if they do not already exist\n\t\t\t\tif (!posInvoiceStore.indexNames.contains('docstatus')) {\n\t\t\t\t\tposInvoiceStore.createIndex('docstatus', 'docstatus', { unique: false });\n\t\t\t\t}\n\t\t\t\tif (!posInvoiceStore.indexNames.contains('opened')) {\n\t\t\t\t\tposInvoiceStore.createIndex('opened', 'opened', { unique: false });\n\t\t\t\t}\n\t\t\t\tif (!posInvoiceStore.indexNames.contains('creation_time')) {\n\t\t\t\t\tposInvoiceStore.createIndex('creation_time', 'creation_time', { unique: false });\n\t\t\t\t}\n\n\n\n\t\t\t\tif (!db.objectStoreNames.contains('check_in_out')) {\n\t\t\t\t\tcheckInOutStore = db.createObjectStore('check_in_out', { keyPath : 'name' });\n\t\t\t\t}else{\n\t\t\t\t\tcheckInOutStore = event.target.transaction.objectStore('check_in_out');\n\t\t\t\t}\n\t\t\t\t// Check and create indexes if they do not already exist\n\t\t\t\tif (!checkInOutStore.indexNames.contains('creation_time')) {\n\t\t\t\t\tcheckInOutStore.createIndex('creation_time', 'creation_time', { unique: false });\n\t\t\t\t}\n\n\n\t\t\t\tif (!db.objectStoreNames.contains('POS Settings')) {\n\t\t\t\t\tdb.createObjectStore('POS Settings', { keyPath : 'id' });\n\t\t\t\t}\n\n\n\n\t\t\t};\n\n\n\t\t})\n\t}\n\n\n\n\tsetupDatabase(){\n\t\tthis.db.onerror = (event) => {\n\t\t\t// Generic error handler for all errors targeted at this database's\n\t\t\t// requests!\n\t\t\tconsole.error(`Database error: ${event.target.error?.message}`);\n\t\t};\n\t}\n\n\n\n\t/************************************  counte ***************************************/\n\t/************************************************************************************/\n\t/************************************************************************************/\n\n\n\n\tgetPosCounter(){\n\t\treturn new Promise((resolve , reject) => {\n\t\t\tconst transaction = this.db.transaction(['Counter'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Counter')\n\n\t\t})\n\t}\n\n\n\n\n\t/************************************   Item  ***************************************/\n\t/************************************************************************************/\n\t/************************************************************************************/\n\n\tsaveItemList( itemList ){\n\t\treturn new Promise((resolve , reject) => {\n\t\t\tconst transaction = this.db.transaction(['Item'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Item')\n\t\t\t// Loop through the list of items  and add each one to the store\n\t\t\titemList.forEach(item => {\n\t\t\t\tconst request = store.put(item)\n\t\t\t\trequest.onerror = (err)=>{\n\t\t\t\t\tconsole.error(\"db => error saving Item : \" , item ,  \"err : \" , err)\n\t\t\t\t\treject(err)\n\t\t\t\t}\n\t\t\t})\n\t\t\t// Transaction's oncomplete event will be triggered\n\t\t\t//once all requests in this transaction complete successfully\n\t\t\ttransaction.oncomplete = () => {\n\t\t\t\tresolve()\n\t\t\t};\n\t\t\ttransaction.onerror = (err) => {\n\t\t\t\tconsole.error(\"db => error saving Item.\")\n\t\t\t\treject(err)\n\t\t\t};\n\t\t})\n\t}\n\n\tgetAllItems(){\n\t\treturn new Promise((resolve,reject) =>{\n\t\t\tconst transaction = this.db.transaction(['Item'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Item');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value);\n\t\t\t}\n\t\t\tresult.onerror = (err) => {\n\t\t\t\treject(err);\n\t\t\t}\n\t\t})\n\t}\n\n\n\t/*********************************   POS Profile  ***********************************/\n\t/************************************************************************************/\n\t/************************************************************************************/\n\n\tsavePosProfileList( posProfileList ){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Profile'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('POS Profile')\n\t\t\t// Loop through the list of pos profile and add each one to the store\n\t\t\tposProfileList.forEach(posProfile => {\n\t\t\t\tconst request = store.put(posProfile)\n\t\t\t\trequest.onerror = (err)=>{\n\t\t\t\t\tconsole.error(\"db => error saving POS Profile : \" ,posProfile ,  \"err : \" , err)\n\t\t\t\t\treject(err)\n\t\t\t\t}\n\t\t\t})\n\t\t\t// Transaction's oncomplete event will be triggered\n\t\t\t//once all requests in this transaction complete successfully\n\t\t\ttransaction.oncomplete = () => {\n\t\t\t\tresolve()\n\t\t\t};\n\t\t\ttransaction.onerror = (err) => {\n\t\t\t\tconsole.error(\"db => error saving POS Profile.\")\n\t\t\t\treject(err)\n\t\t\t};\n\t\t})\n\n\t}\n\n\tgetAllPosProfile(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Profile'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('POS Profile');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value);\n\t\t\t}\n\t\t\tresult.onerror = (err) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\treject(value);\n\t\t\t}\n\t\t})\n\t}\n\n\n\n\t/*********************************       Bin      ***********************************/\n\t/************************************************************************************/\n\t/************************************************************************************/\n\n\tsaveBinList( binList ){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Bin'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Bin')\n\t\t\t// Loop through the list of bin  and add each one to the store\n\t\t\tbinList.forEach(bin => {\n\t\t\t\tconst request = store.put(bin)\n\t\t\t\trequest.onerror = (err)=>{\n\t\t\t\t\tconsole.error(\"db => error saving Bin : \" , bin ,  \"err : \" , err)\n\t\t\t\t\treject(err)\n\t\t\t\t}\n\t\t\t})\n\t\t\t// Transaction's oncomplete event will be triggered\n\t\t\t//once all requests in this transaction complete successfully\n\t\t\ttransaction.oncomplete = () => {\n\t\t\t\tresolve()\n\t\t\t};\n\t\t\ttransaction.onerror = (err) => {\n\t\t\t\tconsole.error(\"db => error saving Bin.\")\n\t\t\t\treject(err)\n\t\t\t};\n\t\t})\n\t}\n\n\tgetAllBin(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Bin'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Bin');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value);\n\t\t\t}\n\t\t\tresult.onerror = (err)=> {\n\t\t\t\treject(err);\n\t\t\t}\n\t\t})\n\t}\n\n\n\n\n\t/*********************************   Warehouse    ***********************************/\n\t/************************************************************************************/\n\t/************************************************************************************/\n\n\tsaveWarehouseList(warehouseList){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Warehouse'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Warehouse')\n\t\t\t// Loop through the list of warehouse and add each one to the store\n\t\t\twarehouseList.forEach(warehouse => {\n\t\t\t\tconst request = store.put(warehouse)\n\t\t\t\trequest.onerror = (err)=>{\n\t\t\t\t\tconsole.error(\"db => error saving Warehouse : \" ,warehouse ,  \"err : \" , err)\n\t\t\t\t\treject(err)\n\t\t\t\t}\n\t\t\t})\n\t\t\t// Transaction's oncomplete event will be triggered\n\t\t\t//once all requests in this transaction complete successfully\n\t\t\ttransaction.oncomplete = () => {\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\ttransaction.onerror = (event) => {\n\t\t\t\tconsole.error(\"db => error saving Warehouse List.\")\n\t\t\t\treject(event);\n\t\t\t};\n\t\t})\n\t}\n\n\tgetAllWarehouse(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Warehouse'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Warehouse');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value);\n\t\t\t}\n\t\t\tresult.onerror = (err) => {\n\t\t\t\treject(err);\n\t\t\t}\n\t\t})\n\t}\n\n\n\n\t/*********************************   Price List   ***********************************/\n\t/************************************************************************************/\n\t/************************************************************************************/\n\n\tsavePriceLists(priceLists){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Price List'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Price List')\n\n\t\t\t// Loop through the list of price lists and add each one to the store\n\t\t\tpriceLists.forEach(priceList => {\n\t\t\t\tconst request = store.put(priceList)\n\t\t\t\trequest.onerror = (err)=>{\n\t\t\t\t\tconsole.error(\"db => error saving Price List : \" ,itemPrice ,  \"err : \" , err)\n\t\t\t\t\treject(err)\n\t\t\t\t}\n\t\t\t})\n\n\t\t\t// Transaction's oncomplete event will be triggered\n\t\t\t//once all requests in this transaction complete successfully\n\t\t\ttransaction.oncomplete = () => {\n\t\t\t\tresolve();\n\t\t\t};\n\n\t\t\ttransaction.onerror = (err) => {\n\t\t\t\tconsole.error(\"db => error saving Price Lists.\")\n\t\t\t\treject(err);\n\t\t\t};\n\t\t})\n\n\t}\n\n\tgetAllPriceList(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Price List'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Price List');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value);\n\t\t\t}\n\t\t\tresult.onerror = (err)=>{\n\t\t\t\treject(err)\n\t\t\t}\n\t\t})\n\t}\n\n\n\n\n\t/*********************************   Item Price   ***********************************/\n\t/************************************************************************************/\n\t/************************************************************************************/\n\n\tsaveItemPriceList(itemPriceList){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Item Price'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Item Price')\n\t\t\t// Loop through the list of item price and add each one to the store\n\t\t\titemPriceList.forEach(itemPrice => {\n\t\t\t\tconst request = store.put(itemPrice)\n\t\t\t\trequest.onerror = (err)=>{\n\t\t\t\t\tconsole.error(\"db => error saving Item Price : \" ,itemPrice ,  \"err : \" , err)\n\t\t\t\t\treject(err)\n\t\t\t\t}\n\t\t\t})\n\t\t\t// Transaction's oncomplete event will be triggered\n\t\t\t//once all requests in this transaction complete successfully\n\t\t\ttransaction.oncomplete = () => {\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\ttransaction.onerror = (err) => {\n\t\t\t\tconsole.error(\"db => error saving Item Price.\")\n\t\t\t\treject(err);\n\t\t\t};\n\t\t})\n\t}\n\n\tgetAllItemPrice(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Item Price'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Item Price');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value);\n\t\t\t}\n\t\t\tresult.onerror = (err)=>{\n\t\t\t\treject(err);\n\t\t\t}\n\t\t})\n\t}\n\n\n\t/*********************************   Item Group   ***********************************/\n\t/************************************************************************************/\n\t/************************************************************************************/\n\n\tsaveItemGroupList(itemGroupList){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Item Group'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Item Group')\n\t\t\t// Loop through the list of item group and add each one to the store\n\t\t\titemGroupList.forEach(itemGroup => {\n\t\t\t\tconst request = store.put(itemGroup)\n\t\t\t\trequest.onerror = (err)=>{\n\t\t\t\t\treject(err);\n\t\t\t\t\tconsole.error(\"db => error saving Item Group : \" ,itemGroup ,  \"err : \" , err)\n\t\t\t\t}\n\t\t\t})\n\t\t\t// Transaction's oncomplete event will be triggered\n\t\t\t//once all requests in this transaction complete successfully\n\t\t\ttransaction.oncomplete = () => {\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\ttransaction.onerror = (err) => {\n\t\t\t\tconsole.error(\"db => error saving Item Group.\")\n\t\t\t\treject(err);\n\t\t\t};\n\t\t})\n\t}\n\n\tgetAllItemGroup(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Item Group'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Item Group');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value);\n\t\t\t}\n\t\t\tresult.onerror = (err)=>{\n\t\t\t\treject(err);\n\t\t\t}\n\t\t})\n\t}\n\n\n\n\t/*********************************   cutomers   *************************************/\n\t/************************************************************************************/\n\t/************************************************************************************/\n\n\tsaveCustomerList(customerList ){\n\t\treturn new Promise((resolve,reject) => {\n\t\t\tconst transaction = this.db.transaction(['Customer'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('Customer')\n\t\t\t// Loop through the list of customers and add each one to the store\n\t\t\tcustomerList.forEach(customer => {\n\t\t\t\tconst request = store.put(customer)\n\t\t\t\trequest.onerror = (err)=>{\n\t\t\t\t\tconsole.error(\"db => error saving customer : \" ,customer ,  \"err : \" , err)\n\t\t\t\t\treject(err)\n\t\t\t\t}\n\t\t\t})\n\t\t\t// Transaction's oncomplete event will be triggered\n\t\t\t//once all requests in this transaction complete successfully\n\t\t\ttransaction.oncomplete = () => {\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\ttransaction.onerror = (event) => {\n\t\t\t\tconsole.error(\"db => error saving customer.\")\n\t\t\t\treject(event)\n\t\t\t};\n\n\t\t})\n\t}\n\n\tgetAllCustomers(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['Customer'] , \"readonly\");\n\t\t\tconst store       = transaction.objectStore('Customer');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value)\n\t\t\t}\n\t\t\tresult.onerror = (value)=>{\n\t\t\t\tconsole.error(\"error when getting customer from db\")\n\t\t\t\treject(event)\n\t\t\t}\n\t\t})\n\t}\n\n\n\n\n\n\t/****************************** pos invoice *********************************/\n\t/****************************************************************************/\n\t/****************************************************************************/\n\n\tsavePosInvoice(posInvoice){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Invoice'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('POS Invoice')\n\t\t\tconst request     = store.put(posInvoice)\n\t\t\trequest.onsuccess = (event) => {\n\t\t\t\tresolve(event);\n\t\t\t};\n\t\t\trequest.onerror = (event) => {\n\t\t\t\treject(event);\n\t\t\t};\n\t\t})\n\n\t}\n\n\tupdatePosInvoice(posInvoice) {\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Invoice'], \"readwrite\");\n\t\t\tconst store = transaction.objectStore('POS Invoice');\n\t\t\t// add if not exists or update if it exists.\n\t\t\tconst request = store.put(posInvoice);\n\t\t\trequest.onsuccess = (event) => {\n\t\t\t\tresolve(event.target.result);\n\t\t\t};\n\t\t\trequest.onerror = (event) => {\n\t\t\t\treject(event);\n    \t\t\t};\n\t\t})\n\t}\n\n\t//async\n\tgetAllPosInvoice(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Invoice'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('POS Invoice');\n\t\t\tconst dateIndex   = store.index('creation_time');\n\n\t\t\tconst invoices    = []\n\t\t\tconst request     = dateIndex.openCursor(null , 'prev') //use prev for descenfing order\n\n\t\t\trequest.onsuccess = (event) =>{\n\t\t\t\tconst cursor = event.target.result;\n\t\t\t\tif(cursor){\n\t\t\t\t\tinvoices.push(cursor.value);\n\t\t\t\t\tcursor.continue() //Move to the next record\n\t\t\t\t}else{\n\t\t\t\t\tconsole.log('check the response : ' , invoices)\n\t\t\t\t\tresolve(invoices);\n\t\t\t\t}\n\t\t\t};\n\t\t\trequest.onerror = (err)=>{\n\t\t\t\treject(err)\n\t\t\t}\n\n\t\t})\n\t}\n\n\t//async\n\tgetAllOpenedPosInvoice(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Invoice'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('POS Invoice');\n\t\t\tconst result      = store.getAll()\n\t\t\tresult.onsuccess = (event) => {\n\t\t\t\tconst value = event.target.result\n\t\t\t\tresolve(value.filter(pos => pos.opened == 1));\n\t\t\t}\n\t\t\tresult.onerror = (err)=>{\n\t\t\t\treject(err)\n\t\t\t}\n\t\t})\n\n\t}\n\n\t//callBack version\n\tgetAllPosInvoice_callback(onSuccess,onFailure){\n\t\tconst transaction = this.db.transaction(['POS Invoice'] , \"readwrite\");\n\t\tconst store       = transaction.objectStore('POS Invoice');\n\t\tconst dateIndex = store.index('creation_time');\n\n\t\tconst invoices  = []\n\t\tconst request   = dateIndex.openCursor(null , 'prev') //use prev for descenfing order\n\n\t\trequest.onsuccess = (event) =>{\n\t\t\tconst cursor = event.target.result;\n\t\t\tif(cursor){\n\t\t\t\tinvoices.push(cursor.value);\n\t\t\t\tcursor.continue() //Move to the next record\n\t\t\t}else{\n\t\t\t\tconsole.log('check the response : ' , invoices)\n\t\t\t\tonSuccess(invoices);\n\t\t\t}\n\t\t};\n\t\trequest.onerror = (err)=>{\n\t\t\tonFailure(err)\n\t\t}\n\t}\n\n\tgetDraftPosInvoice(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction_posInvoice     = this.db.transaction(['POS Invoice'] , \"readwrite\");\n\t\t\tconst store_posInvoice           = transaction_posInvoice.objectStore('POS Invoice');\n\t\t\tconst index_docstatus_posInvoice = store_posInvoice.index('docstatus');\n\t\t\tconst request = index_docstatus_posInvoice.getAll(0);\n\t\t\trequest.onsuccess = (event) => {\n\t\t\t\tresolve(event.target.result);\n\t\t\t};\n\t\t\trequest.onerror = (err) => {\n\t\t\t\treject(err);\n\t\t\t};\n\t\t})\n\n\t}\n\n\tgetNotSyncedPosNumber(onSuccess,onFailure){\n\t\t\tconst transaction_posInvoice     = this.db.transaction(['POS Invoice'] , \"readwrite\");\n\t\t\tconst store_posInvoice           = transaction_posInvoice.objectStore('POS Invoice');\n\t\t\tconst index_docstatus_posInvoice = store_posInvoice.index('docstatus');\n\t\t\tconst request = index_docstatus_posInvoice.getAll(1);\n\t\t\trequest.onsuccess = (result) => {\n\t\t\t\tconst filtredResult = result.target.result.filter(invoice => invoice.synced == false )\n\t\t\t\tonSuccess(filtredResult.length);\n\t\t\t}\n\t\t\trequest.onerror = (err) => {\n\t\t\t\tonFailure(err);\n\t\t\t}\n\t}\n\n\n\tgetNotSyncedPos(onSuccess,onFailure){\n\t\tconst transaction_posInvoice     = this.db.transaction(['POS Invoice'] , \"readwrite\");\n\t\tconst store_posInvoice           = transaction_posInvoice.objectStore('POS Invoice');\n\t\tconst index_docstatus_posInvoice = store_posInvoice.index('docstatus');\n\t\tconst request = index_docstatus_posInvoice.getAll(1);\n\t\trequest.onsuccess = (result) => {\n\t\t\tconst filtredResult = result.target.result.filter(invoice => invoice.synced == false )\n\t\t\tonSuccess(filtredResult);\n\t\t}\n\t\trequest.onerror = (err) => {\n\t\t\tonFailure(err);\n\t\t}\n\t}\n\n\t// New delete function to remove a POS Invoice\n\tdeletePosInvoice(invoiceName) {\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Invoice'], \"readwrite\");\n\t\t\tconst store = transaction.objectStore('POS Invoice');\n\t\t\tconst request = store.delete(invoiceName);  // Deletes the record with the key 'invoiceName', (i set the name as keypath , in erpnext name is the id.)\n\t\t\trequest.onsuccess = () => {\n\t\t\t\tresolve();  // Call success callback if the deletion is successful\n\t\t\t};\n\t\t\trequest.onerror = (err) => {\n\t\t\t\treject(err);  // Call failure callback if there is an error\n\t\t\t};\n\t\t})\n\t}\n\n\t// New delete function to remove a POS Invoice\n\tdeletePosInvoice_callback(invoiceName,onSuccess,onFailure) {\n\t\tconst transaction = this.db.transaction(['POS Invoice'], \"readwrite\");\n\t\tconst store = transaction.objectStore('POS Invoice');\n\t\tconst request = store.delete(invoiceName);  // Deletes the record with the key 'invoiceName', (i set the name as keypath , in erpnext name is the id.)\n\t\trequest.onsuccess = () => {\n\t\t\tonSuccess();  // Call success callback if the deletion is successful\n\t\t};\n\t\trequest.onerror = (err) => {\n\t\t\tonFailure(err);  // Call failure callback if there is an error\n\t\t};\n\t}\n\n\tdeleteAllPosInvoice() {\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Invoice'], 'readwrite');\n\t\t\tconst store = transaction.objectStore('POS Invoice');\n\t\t\tconst request = store.clear(); // Clear all entries in the store\n\t\t\trequest.onsuccess = () => {\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\trequest.onerror = (err) => {\n\t\t\t\treject(err);\n\t\t\t};\n\t\t})\n\t}\n\n\n\n\t/********************************* check_in_out ***********************************************/\n\n\tsaveCheckInOut(checkInOut,onSuccess,onFailure){\n\t\tconsole.log(\"saveCheckInOut : \" , checkInOut)\n\t\tconst transaction = this.db.transaction(['check_in_out'] , \"readwrite\");\n\t\tconst store       = transaction.objectStore('check_in_out')\n\t\tconst request     = store.put(checkInOut)\n\t\trequest.onsuccess = (event) => {\n\t\t\tonSuccess(event.target.result);\n\t\t};\n\t\trequest.onerror = (err) => {\n\t\t\tonFailure(err);\n\t\t};\n\t}\n\n\t\n\n\tgetAllCheckInOut(){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['check_in_out'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('check_in_out');\n\t\t\tconst dateIndex   = store.index('creation_time');\n\t\t\tconst checks      = []\n\t\t\tconst request     = dateIndex.openCursor(null , 'prev') //use prev for descenfing order\n\n\n\t\t\trequest.onsuccess = (event) =>{\n\t\t\t\tconst cursor = event.target.result;\n\t\t\t\tif(cursor){\n\t\t\t\t\tchecks.push(cursor.value);\n\t\t\t\t\tcursor.continue() //Move to the next record\n\t\t\t\t}else{\n\t\t\t\t\tconsole.log('check the response : ' , checks)\n\t\t\t\t\tresolve(checks);\n\t\t\t\t}\n\t\t\t};\n\t\t\trequest.onerror = (err)=>{\n\t\t\t\treject(err)\n\t\t\t}\n\t\t})\n\t}\n\n\n\tgetAllCheckInOut_callback(onSuccess,onFailure){\n\t\tconst transaction = this.db.transaction(['check_in_out'] , \"readwrite\");\n\t\tconst store       = transaction.objectStore('check_in_out');\n\n\t\tconst dateIndex   = store.index('creation_time');\n\t\tconst checks      = []\n\t\tconst request     = dateIndex.openCursor(null , 'prev') //use prev for descenfing order\n\n\n\t\trequest.onsuccess = (event) =>{\n\t\t\tconst cursor = event.target.result;\n\t\t\tif(cursor){\n\t\t\t\tchecks.push(cursor.value);\n\t\t\t\tcursor.continue() //Move to the next record\n\t\t\t}else{\n\t\t\t\tconsole.log('check the response : ' , checks)\n\t\t\t\tonSuccess(checks);\n\t\t\t}\n\t\t};\n\t\trequest.onerror = (err)=>{\n\t\t\tonFailure(err)\n\t\t}\n\n\t}\n\n\tdeleteAllCheckInOut() {\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['check_in_out'], 'readwrite');\n\t\t\tconst store = transaction.objectStore('check_in_out');\n\t\t\tconst request = store.clear(); // Clear all entries in the store\n\t\t\trequest.onsuccess = () => {\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\trequest.onerror = (err) => {\n\t\t\t\treject(err);\n\t\t\t};\n\t\t})\n\t}\n\n\tupdateCheckInOutSync(date) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst transaction = this.db.transaction(['check_in_out'], 'readwrite');\n\t\t\tconst store = transaction.objectStore('check_in_out');\n\t\t\tconst request = store.getAll();\n\t\t\t\n\t\t\trequest.onsuccess = (event) => {\n\t\t\t\tconst records = event.target.result;\n\t\t\t\tconst updatePromises = []; // Define the array here\n\t\t\t\t\n\t\t\t\trecords.forEach(record => {\n\t\t\t\t\tconsole.log(\"date : \" , new Date(record.creation_time) , \"the dat \" , new Date(date) ,\"record :  \",record)\n\t\t\t\t\tif (!record.is_sync && new Date(record.creation_time) <= new Date(date)) {\n\t\t\t\t\t\trecord.is_sync = 1;\n\t\t\t\t\t\tupdatePromises.push(new Promise((resolveUpdate, rejectUpdate) => {\n\t\t\t\t\t\t\tconst updateRequest = store.put(record);\n\t\t\t\t\t\t\tupdateRequest.onsuccess = () => resolveUpdate();\n\t\t\t\t\t\t\tupdateRequest.onerror = (err) => rejectUpdate(err);\n\t\t\t\t\t\t}));\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tPromise.all(updatePromises)\n\t\t\t\t\t.then(() => resolve())\n\t\t\t\t\t.catch(err => reject(err));\n\t\t\t};\n\t\t\t\n\t\t\trequest.onerror = (err) => reject(err);\n\t\t});\n\t}\n\n\tupdateCheckInOutSync_callback(date, onSuccess, onFailure) {\n\t\tconst transaction = this.db.transaction(['check_in_out'], 'readwrite');\n\t\tconst store = transaction.objectStore('check_in_out');\n\t\tconst request = store.getAll();\n\t\t\n\t\trequest.onsuccess = (event) => {\n\t\t\tconst records = event.target.result;\n\t\t\tlet updatedCount = 0;\n\t\t\tlet totalToUpdate = 0;\n\t\t\t\n\t\t\t// First count how many records need updating\n\t\t\trecords.forEach(record => {\n\t\t\t\tif (!record.is_sync && new Date(record.creation) <= new Date(date)) {\n\t\t\t\t\ttotalToUpdate++;\n\t\t\t\t}\n\t\t\t});\n\t\t\t\n\t\t\tif (totalToUpdate === 0) {\n\t\t\t\tonSuccess();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\trecords.forEach(record => {\n\t\t\t\tif (!record.is_sync && new Date(record.creation) <= new Date(date)) {\n\t\t\t\t\trecord.is_sync = 1;\n\t\t\t\t\tconst updateRequest = store.put(record);\n\t\t\t\t\t\n\t\t\t\t\tupdateRequest.onsuccess = () => {\n\t\t\t\t\t\tupdatedCount++;\n\t\t\t\t\t\tif (updatedCount === totalToUpdate) {\n\t\t\t\t\t\t\tonSuccess();\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t\t\n\t\t\t\t\tupdateRequest.onerror = (err) => {\n\t\t\t\t\t\tonFailure(err);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\t\n\t\trequest.onerror = (err) => onFailure(err);\n\t}\n\n\t/****************************** pos settings *********************************/\n\t/*****************************************************************************/\n\t/*****************************************************************************/\n\n\tupdateSettings(settings){\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Settings'] , \"readwrite\");\n\t\t\tconst store       = transaction.objectStore('POS Settings')\n\t\t\tconst request     = store.put({id : 1 , ...settings});\n\t\t\trequest.onsuccess = (event) => {\n\t\t\t\tresolve(event.target.result);\n\t\t\t};\n\t\t\trequest.onerror = (err) => {\n\t\t\t\treject(err);\n\t\t\t};\n\t\t})\n\t}\n\t//callback version\n\tupdateSettings_callback(settings,onSuccess,onFailure){\n\t\tconst transaction = this.db.transaction(['POS Settings'] , \"readwrite\");\n\t\tconst store       = transaction.objectStore('POS Settings')\n\t\tconst request     = store.put({id : 1 , ...settings});\n\t\trequest.onsuccess = (event) => {\n\t\t\tonSuccess(event.target.result);\n\t\t};\n\t\trequest.onerror = (err) => {\n\t\t\tonFailure(err);\n\t\t};\n\t}\n\n\n\tgetSettings(onSuccess,onFailure) {\n\t\tconst transaction = this.db.transaction(['POS Settings'], 'readwrite');\n\t\tconst store = transaction.objectStore('POS Settings');\n\t\tconst request = store.get(1); // Get the settings using the unique ID\n\t\trequest.onsuccess = (event) => {\n\t\t\tonSuccess(event.target.result);\n\t\t};\n\t\trequest.onerror = (err) => {\n\t\t\tonFailure(err);\n\t\t};\n\t}\n\n\tdeleteAllSettings() {\n\t\treturn new Promise((resolve,reject)=>{\n\t\t\tconst transaction = this.db.transaction(['POS Settings'], 'readwrite');\n\t\t\tconst store = transaction.objectStore('POS Settings');\n\t\t\tconst request = store.clear(); // Clear all entries in the store\n\t\t\trequest.onsuccess = () => {\n\t\t\t\tresolve();\n\t\t\t};\n\t\t\trequest.onerror = (err) => {\n\t\t\t\treject(err);\n\t\t\t};\n\t\t})\n\t}\n\n}\n", "pos_ar.PointOfSale.pos_settings = class{\n\n\tconstructor(\n\t\twrapper,\n\t\tsettingsData,\n\t\tselectedPosProfile,\n\t\tonSettingsChange,\n\t){\n\t\tthis.wrapper              = wrapper            ;\n\t\tthis.settings_data        = settingsData       ;\n\t\tthis.selected_pos_profile = selectedPosProfile ;\n\t\tthis.on_settings_change   = onSettingsChange   ;\n\t\t//scene\n\t\tthis.scene = 'pos_profile'\n\n\t\tthis.start_work()\n\t}\n\n\tstart_work(){\n\t\tthis.prepareSettingsCart();\n\t\tthis.refreshLeftSection();\n\t\tthis.setListener();\n\t}\n\n\n\tprepareSettingsCart(){\n\t\tthis.wrapper.find('#RightSection').append('<div id=\"settingsRightContainer\" class=\"columnBox\"></div>')\n\t\tthis.wrapper.find('#LeftSection').append('<div id=\"settingsLeftContainer\" class=\"columnBox\"></div>')\n\n\t\tthis.leftContainer = this.wrapper.find('#settingsLeftContainer')\n\t\tthis.rightContainer  = this.wrapper.find('#settingsRightContainer')\n\n\n\t\t//right section\n\t\tthis.rightContainer.append('<div id=\"pos_profile_btn\"      class=\"settings_tab active\" >POS Profile</div>')\n\t\tthis.rightContainer.append('<div id=\"general_settings_btn\" class=\"settings_tab\"        >Generale Settings</div>')\n\t\tthis.rightContainer.append('<div id=\"about_us_btn\"         class=\"settings_tab\"        >About Us</div>')\n\n\t\tthis.pos_profile_btn      = this.rightContainer.find('#pos_profile_btn')\n\t\tthis.general_settings_btn = this.rightContainer.find('#general_settings_btn')\n\t\tthis.about_us_btn         = this.rightContainer.find('#about_us_btn')\n\t}\n\n\trefreshLeftSection(){\n\t\tthis.leftContainer.html('')\n\t\tif(this.scene == 'pos_profile'){\n\t\t\tthis.refreshPosProfileScene();\n\t\t}else if(this.scene == 'general_settings'){\n\t\t\tthis.refreshGeneralSettings();\n\t\t}else if(this.scene == \"about_us\"){\n\t\t\tthis.refreshAboutUs();\n\t\t}\n\t}\n\n\trefreshPosProfileScene(){\n\t\t//left container\n\t\tthis.leftContainer.addClass('columnBox')\n\t\tthis.leftContainer.append('<h4 class=\"CartTitle\" style=\"margin-bottom:35px; font-size:35px;\" >POS Profile</h4>')\n\t\tthis.leftContainer.append('<div id=\"settingsCartContentsContainer\">  </div>')\n\t\tthis.contentsContainer = this.leftContainer.find('#settingsCartContentsContainer');\n\n\t\t//pos profile:\n\t\tthis.contentsContainer.append('<div id=\"posProfileContent\" class=\"contentContainer rowBox\" style=\"width:100%;\"> <div class=\"c1 columnBox\"></div>   <div class=\"c2 columnBox\"></div> </div>')\n\t\tthis.pos_profile_content = this.contentsContainer.find('#posProfileContent')\n\t\tthis.c1 = this.pos_profile_content.find('div.c1')\n\t\tthis.c2 = this.pos_profile_content.find('div.c2')\n\n\t\tthis.c1.append('<label for=\"pos_profile\"> POS Profile </label>')\n\t\tthis.c1.append('<select  name=\"pos_profile\" id=\"posProfileSelect\" disabled ></select>')\n\n\t\tthis.pos_profile_select = this.c1.find('#posProfileSelect')\n\t\tthis.pos_profile_select.append(`<option value=\"${this.selected_pos_profile.name} selected \">${this.selected_pos_profile.name}</option>`)\n\n\t\tthis.c1.append(`<label for=\"warehouse\">POS Warehouse</label>`)\n\t\tthis.c1.append(`<input name=\"warehouse\" value=\"${this.selected_pos_profile.warehouse}\" disabled>`)\n\n\t\tthis.c1.append(`<label for=\"income_account\">POS income account</label>`)\n\t\tthis.c1.append(`<input name=\"income_account\" value=\"${this.selected_pos_profile.income_account}\" disabled>`)\n\n\t\tthis.c2.append(`<label for=\"write_off_account\">POS write off account</label>`)\n\t\tthis.c2.append(`<input name=\"write_off_account\" value=\"${this.selected_pos_profile.write_off_account}\" disabled>`)\n\n\t\tthis.c2.append(`<label for=\"write_off_cost_center\">POS write off cost center</label>`)\n\t\tthis.c2.append(`<input name=\"write_off_cost_center\" value=\"${this.selected_pos_profile.write_off_cost_center}\" disabled>`)\n\n\t\tthis.c2.append(`<label for=\"taxes_and_charges\">POS taxes and charges</label>`)\n\t\tthis.c2.append(`<input name=\"taxes_and_charges\" value=\"${this.selected_pos_profile.taxes_and_charges}\" disabled>`)\n\n\t}\n\n\n\trefreshGeneralSettings(){\n\n\t\tconst priceBase           = this.settings_data.settings.itemPriceBasedOn\n\t\tconst showItemDetailsCart = this.settings_data.settings.showItemDetails   ? \"checked\" : \"\"\n\t\tconst showItemImage       = this.settings_data.settings.showItemImage     ? \"checked\" : \"\"\n\t\tconst showDiscountField   = this.settings_data.settings.showDiscountField ? \"checked\" : \"\"\n\t\tconst searchByGroup       = this.settings_data.settings.search_by_group   ? \"checked\" : \"\"\n\t\tconst onlineDebt          = this.settings_data.settings.onlineDebt        ? \"checked\" : \"\"\n\t\tconst keyboardStyle       = this.settings_data.settings.keyboard_style\n\n\n\t\tconsole.log(\"check it here : \" , this.settings_data.settings.onlineDebt);\n\n\t\t//left container\n\t\tthis.leftContainer.addClass('columnBox')\n\t\tthis.leftContainer.append('<h4 class=\"CartTitle\" style=\"margin-bottom:35px; font-size:35px;\" >General Settings</h4>')\n\t\tthis.leftContainer.append('<div id=\"settingsCartContentsContainer\">  </div>')\n\t\tthis.contentsContainer = this.leftContainer.find('#settingsCartContentsContainer');\n\n\t\t//settings :\n\t\tthis.contentsContainer.append('<div id=\"generalSettingsContent\" class=\"contentContainer rowBox\" style=\"width:100%;\"> <div class=\"c1 columnBox\"></div>   <div class=\"c2 columnBox\"></div> </div>')\n\t\tthis.general_settings_content = this.contentsContainer.find('#generalSettingsContent')\n\t\tthis.general_settings_c1 = this.general_settings_content.find('div.c1')\n\t\tthis.general_settings_c2 = this.general_settings_content.find('div.c2')\n\n\t\t//price base on\n\t\tthis.general_settings_c1.append('<label for=\"priceBasedOn\" style=\"font-weight:600;\"> Item Price Based On : </label>')\n\t\tthis.general_settings_c1.append('<select  name=\"priceBasedOn\" id=\"priceBasedOnSelect\" ></select>')\n\t\tthis.item_price_based_on_select = this.general_settings_c1.find('#priceBasedOnSelect')\n\n\t\tthis.settings_data.getAllPriceBases().forEach( base =>{\n\t\t\tif(this.settings_data.settings.itemPriceBasedOn == base){\n\t\t\t\tthis.item_price_based_on_select.append(`<option value=\"${base}\" selected> ${base} </option>`)\n\t\t\t}else{\n\t\t\t\tthis.item_price_based_on_select.append(`<option value=\"${base}\"> ${base} </option>`)\n\t\t\t}\n\t\t})\n\n\n\t\t//keyboard style\n\t\tthis.general_settings_c2.append('<label for=\"keyboardStyle\" style=\"font-weight:600;\"> Keyboard Style : </label>')\n\t\tthis.general_settings_c2.append('<select  name=\"keyboardStyle\" id=\"keyboardStyle\" ></select>')\n\t\tthis.keyboard_style_select = this.general_settings_c2.find('#keyboardStyle')\n\n\t\tthis.settings_data.getAllKeyboardStyles().forEach( style =>{\n\t\t\tif(this.settings_data.settings.keyboardStyle == style){\n\t\t\t\tthis.keyboard_style_select.append(`<option value=\"${style}\" selected> ${style} </option>`)\n\t\t\t}else{\n\t\t\t\tthis.keyboard_style_select.append(`<option value=\"${style}\"> ${style} </option>`)\n\t\t\t}\n\t\t})\n\n\n\t\tthis.general_settings_c2.append('<div for=\"showItemDetailsCartCheckBox\" style=\"font-weight:600;\"> Get Client Debt OnLine : </div>')\n\t\tthis.general_settings_c2.append(`<div class=\"rowBox align_center\" style=\"height:50px;\"><label for=\"onlineDebtCheckBox\" style=\"margin-right:16px;width:50%;\" > online debt: </label> <input type=\"checkbox\"  name=\"onlineDebtCheckBox\" id=\"onlineDebtCheckBoxCheckBox\" ${onlineDebt} ></div>`)\n\n\n\n\t\t//show item details cart\n\t\tthis.general_settings_c1.append('<div for=\"showItemDetailsCartCheckBox\" style=\"font-weight:600;\"> Item Details Cart : </div>')\n\t\tthis.general_settings_c1.append(`<div class=\"rowBox align_center\" style=\"height:50px;\"><label for=\"showItemDetailsCartCheckBox\" style=\"margin-right:16px;width:50%;\" > show cart: </label> <input type=\"checkbox\"  name=\"showItemDetailsCartCheckBox\" id=\"showItemDetailsCartCheckBox\" ${showItemDetailsCart} ></div>`)\n\n\t\t//show item details cart\n\t\tthis.general_settings_c1.append('<div for=\"showItemDetailsCartCheckBox\" style=\"font-weight:600;\"> Item Image : </div>')\n\t\tthis.general_settings_c1.append(`<div class=\"rowBox align_center\" style=\"height:50px;\" ><label for=\"showItemImageCheckBox\" style=\"margin-right:16px;width:50%;\"> show item image: </label> <input type=\"checkbox\"  name=\"showItemImageCheckBox\" id=\"showItemImageCheckBox\" ${showItemImage} ></div>`)\n\n\t\t//show item details cart\n\t\tthis.general_settings_c1.append('<div for=\"showItemDetailsCartCheckBox\" style=\"font-weight:600;\"> Discount feature : </div>')\n\t\tthis.general_settings_c1.append(`<div class=\"rowBox align_center\" style=\"height:50px;\" ><label for=\"showDiscountFieldCheckBox\" style=\"margin-right:16px;width:50%;\"> show discount field: </label> <input type=\"checkbox\"  name=\"showDiscountFieldCheckBox\" id=\"showDiscountFieldCheckBox\" ${showDiscountField} ></div>`)\n\n\t\t//show item details cart\n\t\tthis.general_settings_c1.append('<div for=\"showItemDetailsCartCheckBox\" style=\"font-weight:600;\"> filter item by group : </div>')\n\t\tthis.general_settings_c1.append(`<div class=\"rowBox align_center\" style=\"height:50px;\" ><label for=\"showItemGroupFilterCheckBox\" style=\"margin-right:16px;width:50%;\"> show item group filter: </label> <input type=\"checkbox\"  name=\"showItemGroupFilterCheckBox\" id=\"showItemGroupFilterCheckBox\" ${searchByGroup} ></div>`)\n\n\n\t\t//set listeners\n\t\tthis.item_price_based_on_select.on('input' , (event)=>{\n\t\t\tthis.settings_data.setPriceItemBasedOn(\n\t\t\t\tevent.target.value,\n\t\t\t\t()=>{\n\t\t\t\t\tthis.on_settings_change(\"itemPriceBasedOn\")\n\t\t\t\t},()=>{\n\t\t\t\t\tconsole.error(\"error to save the settings changes (settings.js)\")\n\t\t\t\t}\n\t\t\t)\n\t\t})\n\n\t\tthis.keyboard_style_select.on('input' , (event)=>{\n\t\t\tthis.settings_data.settings.keyboardStyle =  event.target.value\n\t\t\tthis.settings_data.setSettings(\n\t\t\t\tthis.settings_data.settings,\n\t\t\t\t()=>{\n\t\t\t\t\tthis.on_settings_change(\"showItemImage\")\n\t\t\t\t},()=>{\n\t\t\t\t\tconsole.error(\"error to save the settings changes (settings.js)\")\n\t\t\t\t}\n\t\t\t)\n\t\t})\n\n\t\tthis.general_settings_c1.find(\"#showItemDetailsCartCheckBox\").on('click' , (event)=>{\n\t\t\tthis.settings_data.settings.showItemDetails =  $(event.target).is(':checked')\n\t\t\tthis.settings_data.setSettings(\n\t\t\t\tthis.settings_data.settings,\n\t\t\t\t()=>{\n\t\t\t\t\tthis.on_settings_change(\"showItemDetails\")\n\t\t\t\t},()=>{\n\t\t\t\t\tconsole.error(\"error to save the settings changes (settings.js)\")\n\t\t\t\t}\n\t\t\t)\n\t\t})\n\t\tthis.general_settings_c1.find(\"#showItemImageCheckBox\").on('click' , (event)=>{\n\t\t\tthis.settings_data.settings.showItemImage =  $(event.target).is(':checked')\n\t\t\tthis.settings_data.setSettings(\n\t\t\t\tthis.settings_data.settings,\n\t\t\t\t()=>{\n\t\t\t\t\tthis.on_settings_change(\"showItemImage\")\n\t\t\t\t},()=>{\n\t\t\t\t\tconsole.error(\"error to save the settings changes (settings.js)\")\n\t\t\t\t}\n\t\t\t)\n\t\t})\n\t\tthis.general_settings_c1.find(\"#showDiscountFieldCheckBox\").on('click' , (event)=>{\n\t\t\tthis.settings_data.settings.showDiscountField =  $(event.target).is(':checked')\n\t\t\tthis.settings_data.setSettings(\n\t\t\t\tthis.settings_data.settings,\n\t\t\t\t()=>{\n\t\t\t\t\tthis.on_settings_change(\"showDiscountField\")\n\t\t\t\t},()=>{\n\t\t\t\t\tconsole.error(\"error to save the settings changes (settings.js)\")\n\t\t\t\t}\n\t\t\t)\n\t\t})\n\t\tthis.general_settings_c1.find(\"#showItemGroupFilterCheckBox\").on('click' , (event)=>{\n\t\t\tthis.settings_data.settings.search_by_group =  $(event.target).is(':checked')\n\t\t\tthis.settings_data.setSettings(\n\t\t\t\tthis.settings_data.settings,\n\t\t\t\t()=>{\n\t\t\t\t\tthis.on_settings_change(\"\")\n\t\t\t\t},()=>{\n\t\t\t\t\tconsole.error(\"error to save the settings changes (settings.js)\")\n\t\t\t\t}\n\t\t\t)\n\t\t})\n\t\tthis.general_settings_c2.find('#onlineDebtCheckBoxCheckBox').on('click' , (event)=>{\n\t\t\tthis.settings_data.settings.onlineDebt =  $(event.target).is(':checked')\n\t\t\tthis.settings_data.setSettings(\n\t\t\t\tthis.settings_data.settings,\n\t\t\t\t()=>{\n\t\t\t\t\tthis.on_settings_change(\"\")\n\t\t\t\t},()=>{\n\t\t\t\t\tconsole.error(\"error to save the settings changes (pos_settings.js)\")\n\t\t\t\t}\n\t\t\t)\n\t\t})\n\n\n\t}\n\trefreshAboutUs(){\n\t\t//left container\n\t\tthis.leftContainer.addClass('columnBox')\n\t\tthis.leftContainer.append('<h4 class=\"CartTitle\" style=\"margin-bottom:35px; font-size:35px;\" >About Us</h4>')\n\t\tthis.leftContainer.append('<div id=\"settingsCartContentsContainer\">  </div>')\n\t\tthis.contentsContainer = this.leftContainer.find('#settingsCartContentsContainer');\n\n\t}\n\n\n\tshowCart(){\n\t\tthis.rightContainer.css('display' , 'flex')\n\t\tthis.leftContainer.css('display' , 'flex')\n\t}\n\thideCart(){\n\t\tthis.rightContainer.css('display' , 'none')\n\t\tthis.leftContainer.css('display' , 'none')\n\t}\n\n\t/*********************** set listener  ********************************/\n\n\tsetListener(){\n\t\tconst tabs = document.querySelectorAll('.settings_tab');\n\t\tconst all_content = document.querySelectorAll('.contentContainer')\n\n\t\ttabs.forEach((tab , index)=>{\n\t\t\ttab.addEventListener('click' , ()=>{\n\t\t\t\ttabs.forEach(tab => {\n\t\t\t\t\ttab.classList.remove('active');\n\t\t\t\t})\n\t\t\t\ttab.classList.add('active');\n\t\t\t})\n\t\t})\n\n\n\t\tthis.pos_profile_btn.on('click' , (event)=>{\n\t\t\tthis.scene = 'pos_profile';\n\t\t\tthis.refreshLeftSection();\n\t\t})\n\n\n\t\tthis.general_settings_btn.on('click' , (event)=>{\n\t\t\tthis.scene = 'general_settings';\n\t\t\tthis.refreshLeftSection()\n\t\t})\n\n\t\tthis.about_us_btn.on('click' , (event)=>{\n\t\t\tthis.scene = 'about_us';\n\t\t\tthis.refreshLeftSection()\n\t\t})\n\n\t}\n\n\n}\n", "pos_ar.PointOfSale.pos_check_in_out = class {\n\n\tconstructor(\n\t\twrapper,\n\t\tdb\n\t){\n\t\tthis.wrapper   = wrapper;\n\t\tthis.db        = db;\n\n\t\t//local\n\t\tthis.checkList = [];\n\t\tthis.filter    = 'All';\n\t\tthis.selectedCheckInOut = null;\n\n\t\tthis.start_work();\n\t}\n\n\tstart_work(){\n\t\tthis.prepare_checkInOut_cart();\n\t\tthis.getAllCheckInOut();\n\t\tthis.setListeners();\n\t}\n\n\t/****************************************    UI    *******************************************************/\n\n\tprepare_checkInOut_cart(){\n\t\tthis.wrapper.find('#LeftSection').append('<div id=\"checkInOutLeftContainer\" class=\"columnBox\"></div>')\n\t\tthis.wrapper.find('#RightSection').append('<div id=\"checkInOutRightContainer\" class=\"columnBox\"></div>')\n\n\t\tthis.left_container  = this.wrapper.find('#checkInOutLeftContainer')\n\t\tthis.right_container = this.wrapper.find('#checkInOutRightContainer')\n\n\t\t///////////////////right section\n\t\t//checkInOut tab\n\t\tthis.right_container.append('<div id=\"checkInOutTabContainer\" class=\"rowBox\">  <div id=\"tabAll\" class=\"tab selected\">All</div> <div id=\"tabCheckIn\" class=\"tab\">Check In</div> <div id=\"tabCheckOut\" class=\"tab\">Check Out</div>  </div>')\n\t\tthis.tab_container = this.right_container.find('#checkInOutTabContainer')\n\t\tthis.tab_all = this.tab_container.find('#tabAll')\n\t\tthis.tab_in  = this.tab_container.find('#tabCheckIn')\n\t\tthis.tab_out = this.tab_container.find('#tabCheckOut')\n\t\t//checkInOut list\n\t\tthis.right_container.append('<div id=\"checkInOutList\" class=\"columnBox\"></div>')\n\t\tthis.check_in_out_list = this.right_container.find('#checkInOutList')\n\n\t\t//////////////////now left section\n\t\tconst header =\n\t\t\t'<div id=\"detailsCheckInOutHeader\" class=\"rowBox\" >'+\n\t\t\t\t'<div class=\"checkInAmount columnBox\" >'+\n\t\t\t\t\t'<div class=\"rowBox centerItem\" style=\"width:100%;height:50%;\">'+\n\t\t\t\t\t\t'<div style=\"font-size:25px; font-weight:700;\">Check In</div>'+\n\t\t\t\t\t'</div>'+\n\t\t\t\t\t'<div id=\"TotalCheckInValue\" class=\"rowBox centerItem\" style=\"height:50%; width:100%;\">...DA</div>'+\n\t\t\t\t'</div>'+\n\t\t\t\t'<div class=\"checkOutAmount columnBox\" >'+\n\t\t\t\t\t'<div class=\"rowBox centerItem\" style=\"width:100%;height:50%;\" >'+\n\t\t\t\t\t\t'<div style=\"font-size:25px; font-weight:700;\">Check Out</div>'+\n\t\t\t\t\t'</div>'+\n\t\t\t\t\t'<div id=\"TotalCheckOutValue\" class=\"rowBox centerItem\" style=\"width:100%;height:50%;\"> ...DA </div>'+\n\t\t\t\t'</div>'+\n\t\t\t\t'<div class=\"totalCheckInOutAmount columnBox centerItem\">'+\n\t\t\t\t\t'<div class=\"rowBox centerItem\" style=\"width:100%;height:50%;\">'+\n\t\t\t\t\t\t'<div style=\"font-size:25px; font-weight:700;\">Total</div>'+\n\t\t\t\t\t'</div>'+\n\t\t\t\t\t'<div id=\"TotalCheckInOutValue\" class=\"rowBox centerItem\" style=\"height:50%; width:100%;\">...DA</div>'+\n\t\t\t\t'</div>'+\n\t\t\t'</div>'\n\t\tthis.left_container.append(header)\n\t\tthis.details_checkInOut_header = this.left_container.find('#detailsCheckInOutHeader')\n\n\t\t//Amounts\n\t\tthis.check_in_amount           = this.details_checkInOut_header.find('#TotalCheckInValue')\n\t\tthis.check_out_amount          = this.details_checkInOut_header.find('#TotalCheckOutValue')\n\t\tthis.check_total_in_out_amount = this.details_checkInOut_header.find('#TotalCheckInOutValue')\n\n\n\t\t// one checkInOut details content\n\t\tthis.left_container.append('<div id=\"detailsCheckInOutContent\" class=\"columnBox\"></div>')\n\t\tthis.detailsCheckInOutContent = this.left_container.find('#detailsCheckInOutContent')\n\t\tconst details =\n\t\t\t'<div class=\"l1 rowBox\">'+\n\t\t\t\t'<div><span class=\"key\">Check Type :<span> <span id=\"selectedCheckInOutType\" class=\"value\"> THE_TYPE </span></div>'+\n\t\t\t\t'<div><span class=\"value\" id=\"selectedCheckInOutCreationTime\"> THE_DATE </span></div>'+\n\t\t\t'</div>'+\n\t\t\t'<div class=\"l2 rowBox\">'+\n\t\t\t\t'<div><span class=\"key\">Amount :</span> <span id=\"selectedCheckInOutAmount\" class=\"value\">THE AMOUNT</span></div>'+\n\t\t\t\t'<div><span id=\"selectedCheckInOutOwner\" class=\"value\">THE OWNER</span></div>'+\n\t\t\t'</div>'+\n\t\t\t'<div class=\"l3\">'+\n\t\t\t\t'<div class=\"title\">Reason</div>'+\n\t\t\t\t'<textarea id=\"selectedCheckInOutReason\" disabled ></textarea>'+\n\t\t\t'</div>'\n\t\tthis.detailsCheckInOutContent.append(details)\n\n\t\tthis.checkType         = this.detailsCheckInOutContent.find('#selectedCheckInOutType')\n\t\tthis.checkAmount       = this.detailsCheckInOutContent.find('#selectedCheckInOutAmount')\n\t\tthis.checkCreationTime = this.detailsCheckInOutContent.find('#selectedCheckInOutCreationTime')\n\t\tthis.checkOwner        = this.detailsCheckInOutContent.find('#selectedCheckInOutOwner')\n\t\tthis.checkReason       = this.detailsCheckInOutContent.find('#selectedCheckInOutReason')\n\t}\n\n\trefreshCheckInOutList(){\n\t\tthis.check_in_out_list.empty();\n\n\t\tconsole.log(\"this.checkList : \" , this.checkList)\n\n\t\tconst filteredList = this.checkList.filter( item => item.check_type == this.filter || this.filter == 'All')\n\n\t\tfilteredList.forEach(checkInOut =>{\n\n\t\t\tconst checkInOutObject = document.createElement('div')\n\t\t\tcheckInOutObject.classList.add('checkInOutItem','rowBox')\n\t\t\t//type div container\n\t\t\tconst type_div = document.createElement('div')\n\t\t\ttype_div.classList.add('type')\n\t\t\t//type img image\n\t\t\tconst type_img           = document.createElement('img')\n\t\t\ttype_img.src             = '/assets/pos_ar/images/arrow.png'\n\t\t\ttype_img.style.width     = '35px'\n\t\t\ttype_img.style.height    = '35px'\n\t\t\ttype_img.style.transform = checkInOut.check_type === 'In' ? 'rotate(180deg)' : ''\n\n\t\t\tconsole.log(\"checkInOut.check_type : \" , checkInOut.check_type === 'In' ? 'rotate(180deg);' : '')\n\n\t\t\t//type div value\n\t\t\tconst type_value_div       = document.createElement('div')\n\t\t\ttype_value_div.textContent = checkInOut.check_type\n\t\t\t//creation time\n\t\t\tconst creationTimeDiv = document.createElement('div');\n\t\t\tcreationTimeDiv.classList.add('creationTime')\n\t\t\tcreationTimeDiv.textContent = checkInOut.creation_time;\n\t\t\t//amount div\n\t\t\tconst amountDiv       = document.createElement('div')\n\t\t\tamountDiv.classList.add('amount')\n\t\t\tamountDiv.textContent = checkInOut.amount + ' DA'\n\t\t\t//linking stage\n\t\t\ttype_div.append(type_img)\n\t\t\ttype_div.append(type_value_div)\n\t\t\tcheckInOutObject.append(type_div)\n\t\t\tcheckInOutObject.append(creationTimeDiv)\n\t\t\tcheckInOutObject.append(amountDiv)\n\n\n\t\t\t//set listener\n\t\t\tcheckInOutObject.addEventListener('click' , ()=>{\n\t\t\t\tthis.selectedCheckInOut = checkInOut ;\n\t\t\t\tthis.refreshCheckInOutDetails()\n\t\t\t});\n\n\t\t\tthis.check_in_out_list.append(checkInOutObject)\n\t\t})\n\n\t}\n\n\trefreshCheckInOutAmount(){\n\t\tthis.check_total_in_out_amount.html('');\n\t\tthis.check_in_amount.html('');\n\t\tthis.check_out_amount.html('');\n\n\t\tlet inAmount  = 0.00 ;\n\t\tlet outAmount = 0.00 ;\n\t\tlet allAmount = 0.00 ;\n\n\t\tthis.checkList.forEach(item =>{\n\t\t\tallAmount += parseFloat(item.amount) || 0.00;\n\t\t\tif(item.check_type == 'In')\n\t\t\t\tinAmount += parseFloat(item.amount) || 0.00;\n\t\t\telse if(item.check_type == 'Out')\n\t\t\t\toutAmount += parseFloat(item.amount) || 0.00;\n\t\t})\n\t\tthis.check_in_amount.append(`${inAmount.toFixed(2)} DA`)\n\t\tthis.check_out_amount.append(`${outAmount.toFixed(2)} DA`)\n\t\tthis.check_total_in_out_amount.append(`${allAmount.toFixed(2)} DA`)\n\t}\n\n\trefreshCheckInOutDetails(){\n\n\t\tif(this.selectedCheckInOut == null)\n\t\t\treturn;\n\n\t\tthis.checkType.html('')\n\t\tthis.checkCreationTime.html('')\n\t\tthis.checkReason.html('')\n\t\tthis.checkOwner.html('')\n\t\tthis.checkAmount.html('')\n\n\t\tthis.checkType.append(this.selectedCheckInOut.check_type)\n\t\tthis.checkCreationTime.append(this.selectedCheckInOut.creation_time)\n\t\tthis.checkAmount.append(this.selectedCheckInOut.amount + ' DA')\n\t\tthis.checkReason.append(this.selectedCheckInOut.reason || this.selectedCheckInOut.reason_note)\n\t\tthis.checkOwner.append(this.selectedCheckInOut.owner)\n\n\t\tconsole.log(\"this.checkReason.scrollHeight : \" , this.checkReason.get(0).scrollHeight)\n\t\tthis.checkReason.get(0).style.height = 'auto';\n\t\tthis.checkReason.get(0).style.height = this.checkReason.get(0).scrollHeight + 'px'\n\t}\n\n\n\n\t//show && hide functions\n\tshowCart(){\n\t\tthis.left_container.css('display','flex')\n\t\tthis.right_container.css('display','flex')\n\t}\n\thideCart(){\n\t\tthis.left_container.css('display','none')\n\t\tthis.right_container.css('display','none')\n\t}\n\n\t/*****************************************  listener  **************************************************/\n\t/********************************************************************************************************/\n\n\tsetListeners(){\n\t\tthis.tab_all.on('click' , (event)=>{\n\t\t\tthis.filter = 'All'\n\t\t\tthis.tab_all.addClass('selected')\n\t\t\tthis.tab_out.removeClass('selected')\n\t\t\tthis.tab_in.removeClass('selected')\n\t\t\tthis.refreshCheckInOutList();\n\t\t})\n\t\tthis.tab_in.on('click' , (event)=>{\n\t\t\tthis.filter = 'In'\n\t\t\tthis.tab_in.addClass('selected')\n\t\t\tthis.tab_out.removeClass('selected')\n\t\t\tthis.tab_all.removeClass('selected')\n\t\t\tthis.refreshCheckInOutList();\n\t\t})\n\t\tthis.tab_out.on('click' , (event)=>{\n\t\t\tthis.filter = 'Out'\n\t\t\tthis.tab_out.addClass('selected')\n\t\t\tthis.tab_all.removeClass('selected')\n\t\t\tthis.tab_in.removeClass('selected')\n\t\t\tthis.refreshCheckInOutList();\n\t\t})\n\t}\n\n\t/*****************************************  functions  **************************************************/\n\t/********************************************************************************************************/\n\n\tasync getAllCheckInOut(){\n\t\tthis.db.getAllCheckInOut_callback(\n\t\t\t(res)=>{\n\t\t\t\tif(res.length > 0){\n\t\t\t\t\tthis.selectedCheckInOut = res[0]\n\t\t\t\t}\n\t\t\t\tthis.checkList = res ;\n\t\t\t\tthis.refreshCheckInOutList();\n\t\t\t\tthis.refreshCheckInOutAmount();\n\t\t\t\tthis.refreshCheckInOutDetails();\n\t\t\t\tconsole.log(\"res : \" , res)\n\t\t\t},(err)=>{\n\t\t\t\tconsole.log(\"err : \" , err)\n\t\t\t}\n\t\t)\n\t}\n\n}\n", "pos_ar.PointOfSale.pos_debt_cart = class{\n\n\tconstructor(\n\t\twrapper,\n\t\tappData,\n\t\trefreshCheckInOut\n\t){\n\t\tthis.wrapper              = wrapper\n\t\tthis.app_data             = appData\n\t\tthis.refresh_check_in_out = refreshCheckInOut \n\n\t\t//local vars\n\t\tthis._filtredClientList = this.app_data.appData.customers\n\t\tthis.selected_client = {}\n\t\tthis.payment_amount = 0\n\n\t\tthis._pos_invoice      = []\n\t\tthis._sales_invoice    = []\n\n\t\tthis._selected_invoice = []\n\n\t\tthis.start_work()\n\t}\n\n\tstart_work(){\n\t\tthis.prepare_cart()\n\t\tthis.refreshClientPart()\n\t\tthis.setListener()\n\t}\n\n\tprepare_cart(){\n\t\tthis.wrapper.find('#LeftSection').append('<div id=\"debtLeftContainer\" class=\"columnBox\"></div>')\n\t\tthis.wrapper.find('#RightSection').append('<div id=\"debtRightContainer\" class=\"columnBox\"></div>')\n\n\t\tthis.leftContainer  = this.wrapper.find('#debtLeftContainer')\n\t\tthis.rightContainer = this.wrapper.find('#debtRightContainer')\n\n\t\t// Customer search section\n\t\tthis.rightContainer.append(`\n\t\t\t<div class=\"debt-header\">\n\t\t\t\t<input type=\"text\" \n\t\t\t\t\tid=\"debt_filterClientList\" \n\t\t\t\t\tplaceholder=\"Search customers...\"\n\t\t\t\t>\n\t\t\t</div>\n\t\t\t<div id=\"debt_customerList\"></div>\n\t\t`)\n\n\t\tthis.customerList = this.rightContainer.find('#debt_customerList')\n\n\t\t// Payment section\n\t\tthis.leftContainer.append(`\n\t\t\t<div class=\"payment-header\">\n\t\t\t\t<div class=\"amount-input\">\n\t\t\t\t\t<input id=\"debt_paymentAmount\" type=\"number\" placeholder=\"Enter amount\">\n\t\t\t\t</div>\n\t\t\t\t<div id=\"total_client_debt\">Total: 0 DA</div>\n\t\t\t\t<div id=\"partially_client_debt\">Selected: 0 DA</div>\n\t\t\t\t<button id=\"pay_selected_invoices_btn\">Pay</button>\n\t\t\t</div>\n\t\t\t<div id=\"debt_debtsList\"></div>\n\t\t`)\n\n\t\t// Loading animation\n\t\tthis.leftContainer.append(`\n\t\t\t<script src=\"https://unpkg.com/@dotlottie/player-component@2.7.12/dist/dotlottie-player.mjs\" type=\"module\"></script>\n\t\t\t<div id=\"debt_waitingContainer\" style=\"display:none;\">\n\t\t\t\t<dotlottie-player \n\t\t\t\t\tsrc=\"https://lottie.host/d6c76206-aab9-4d5a-af73-c4a6cfc5aaa9/H8vnpKcKj9.lottie\" \n\t\t\t\t\tbackground=\"transparent\" \n\t\t\t\t\tspeed=\"1\" \n\t\t\t\t\tstyle=\"width: 300px; height: 300px\" \n\t\t\t\t\tloop \n\t\t\t\t\tautoplay\n\t\t\t\t></dotlottie-player>\n\t\t\t</div>\n\t\t`)\n\n\t\t// Initialize components\n\t\tthis.waiting_cart = this.leftContainer.find('#debt_waitingContainer')\n\t\tthis.total_client_debt = this.leftContainer.find('#total_client_debt')\n\t\tthis.partially_client_debt = this.leftContainer.find('#partially_client_debt')\n\t\tthis.pay_selected_invoices_btn = this.leftContainer.find('#pay_selected_invoices_btn')\n\t\tthis.debtList = this.leftContainer.find('#debt_debtsList')\n\t}\n\n\tadd_customer_to_list(customer) {\n\t\tconst customerElement = document.createElement('div')\n\t\tcustomerElement.className = 'customer-item'\n\t\tcustomerElement.innerHTML = `\n\t\t\t<div class=\"customer-name\">${customer.customer_name}</div>\n\t\t\t<div class=\"customer-info\">\n\t\t\t\t<span>${customer.customer_primary_contact || ''}</span>\n\t\t\t\t<span>${customer.mobile_no || ''}</span>\n\t\t\t</div>\n\t\t`\n\t\t\n\t\tcustomerElement.addEventListener('click', () => {\n\t\t\tthis.customerList.find('.customer-item').removeClass('selected')\n\t\t\tcustomerElement.classList.add('selected')\n\t\t\t\n\t\t\t// Update the selected customer and refresh the debt part\n\t\t\tthis.selected_client = structuredClone(customer)\n\t\t\tthis.refreshClientDebtPart(customer)\n\t\t})\n\n\t\tthis.customerList.append(customerElement)\n\t}\n\n\tshowCart(){\n\t\tthis.leftContainer.css('display' , 'flex')\n\t\tthis.rightContainer.css('display' , 'flex')\n\t}\n\thideCart(){\n\t\tthis.leftContainer.css('display' , 'none')\n\t\tthis.rightContainer.css('display' , 'none')\n\t}\n\n\tshow_waiting(){\n\t\tthis.waiting_cart.css('display' , 'flex')\n\t}\n\thide_waiting(){\n\t\tthis.waiting_cart.css('display' , 'none')\n\t}\n\n\tsetListener(){\n\t\t//filter clients\n\t\tthis.rightContainer.find(\"#debt_filterClientList\").on('input' , event =>{\n\t\t\tconst value = this.rightContainer.find(\"#debt_filterClientList\").val().trim().toLowerCase();\n\t\t\tthis._filtredClientList = this.app_data.appData.customers.filter(customer =>\n\t\t\t\tcustomer.customer_name.toLowerCase().includes(value)\n\t\t\t);\n \t\t\tthis.refreshClientPart()\n\n\t\t})\n\t\tthis.leftContainer.find(\"#debt_paymentAmount\").on('input',event =>{\n\t\t\tthis.payment_amount = parseFloat(this.leftContainer.find(\"#debt_paymentAmount\").val())\n\t\t})\n\t\tthis.pay_selected_invoices_btn.on('click' , async () =>{\n\t\t\tconsole.log(\"check the list ==> \" , this._selected_invoice)\n\t\t\tthis.paySelectedInvoice()\n\t\t})\n\t\tthis.debtList.on('click', '.invoiceBox input[type=\"checkbox\"]', event => {\n\t\t\tconst checkbox                 = $(event.target);\n\t\t\tconst invoiceName              = checkbox.data('invoice-name');\n\t\t\tconst invoiceOutstandingAmount = checkbox.data('outstanding-amount')\n\t\t\tconst invoiceType              = checkbox.data('invoice-type')\n\n\t\t\tconst invoice_data = { 'name' : invoiceName , 'outstanding_amount' : invoiceOutstandingAmount , 'type' : invoiceType }\n\n\t\t\tif (checkbox.is(':checked')) {\n\t\t\t\t// Add the invoice name to the selected list\n\t\t\t\tif (!this._selected_invoice.some(invoice => invoice.name == invoiceName)) {\n\t\t\t\t\tthis._selected_invoice.push(invoice_data);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Remove the invoice name from the selected list\n\t\t\t\tconst index = this._selected_invoice.findIndex(invoice => invoice.name == invoiceName);\n\t\t\t\tif (index > -1) {\n\t\t\t\t\tthis._selected_invoice.splice(index, 1);\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.refresh_partially_paid()\n\t\t});\n\n\t}\n\n\trefreshClientPart(){\n\n\t\tthis.customerList.html('')\n\t\tthis._filtredClientList.forEach(customer=>{\n\t\t\tthis.add_customer_to_list(customer)\n\t\t})\n\t}\n\n\trefreshTotal(total_debt){\n\t\tthis.total_client_debt.text(`Total Debt : ${total_debt} DA`);\n\t}\n\trefresh_partially_paid(){\n\t\t//calculate the client selected pos debt based on selected check box\n\t\tlet partially_paid = 0 ;\n\t\tthis._selected_invoice.forEach(invoice=>{\n\t\t\tpartially_paid += invoice.outstanding_amount\n\t\t})\n\n\t\tthis.partially_client_debt.text(`Selected Debt : ${partially_paid} DA`)\n\t}\n\n\tasync  refreshClientDebtPart(customer){\n\t\t//make the total text to loading... indicator rather than false value.\n\t\tthis.refreshTotal( \"Loading ...\" );\n\t\tthis._selected_invoice = []\n\t\tthis.refresh_partially_paid();\n\n\t\t//styles\n\t\tconst invoiceStyle = 'width:calc(100% - 40px);height:60px;min-height:60px;border-bottom:2px solid #505050;'\n\t\tconst payBtnStyle  = 'width:80px;height:35px;color:white;background:green;border-radius:12px;margin:0px 20px;cursor:pointer;'\n\n\t\tlet total_debt = 0 ;\n\n\t\tthis.debtList.html('')\n\t\tconst result  = await this.app_data.fetchDebts(customer.name)\n\t\tconst result2 = await this.app_data.fetchDebtsSalesInvoices(customer.name)\n\n\t\tresult.forEach(invoice=>{\n\n\t\t\ttotal_debt += invoice.outstanding_amount ;\n\n\t\t\tconst customerBox = $(\n\t\t\t\t`<div  style=\"${invoiceStyle}\" class=\"rowBox C_A_Center invoiceBox\" data-invoice-name=\"${invoice.name}\"></div>`\n\t\t\t)\n\t\t\tconst checkbox = $(`<input type=\"checkbox\" class=\"select_checkbox\" style=\"margin:0px 16px;\" data-invoice-type=\"POS Invoice\" data-invoice-name=\"${invoice.name}\" data-outstanding-amount=\"${invoice.outstanding_amount}\" ></input>`)\n\t\t\t//customerBox.append(checkbox)\n\t\t\tcustomerBox.append(`<div style=\"flex-grow:1;\">${invoice.name}</div>`)\n\t\t\tcustomerBox.append(`<div style=\"flex-grow:1;\">${invoice.outstanding_amount} DA</div>`)\n\t\t\tcustomerBox.append(`<div style=\"flex-grow:1;\">${invoice.posting_date}</div>`)\n\t\t\tcustomerBox.append(`<div style=\"flex-grow:1;\">POS Invoice</div>`)\n\t\t\tcustomerBox.append(`<div class=\"rowBox centerItem payBtn\" style=\"${payBtnStyle}\">Pay</div>`)\n\n\t\t\t // Set up the click event listener for the Pay button\n\t\t\tcustomerBox.find('.payBtn').on('click', async () => {\n\t\t\t\t// Get the invoice name from the customerBox\n\t\t\t\t//const invoiceName = customerBox.data('invoice-name');\n\t\t\t\t// Proceed to pay the invoice with a predefined payment amount (e.g., 1000 DA)\n\t\t\t\tawait this.payPosInvoice(invoice);\n\t\t\t});\n\n\n\t\t\tthis.debtList.append(customerBox)\n\t\t})\n\n\t\tresult2.forEach(invoice=>{\n\t\t\ttotal_debt += invoice.outstanding_amount ;\n\n\t\t\tconst customerBox = $(\n\t\t\t\t`<div  style=\"${invoiceStyle}\" class=\"rowBox C_A_Center invoiceBox\" data-invoice-name=\"${invoice.name}\"></div>`\n\t\t\t)\n\t\t\tcustomerBox.append(`<input type=\"checkbox\" style=\"margin:0px 16px;\" data-invoice-type=\"Sales Invoice\" data-invoice-name=\"${invoice.name}\" data-outstanding-amount=\"${invoice.outstanding_amount}\" ></input>`)\n\t\t\tcustomerBox.append(`<div style=\"flex-grow:1;\">${invoice.name}</div>`)\n\t\t\tcustomerBox.append(`<div style=\"flex-grow:1;\">${invoice.outstanding_amount} DA</div>`)\n\t\t\tcustomerBox.append(`<div style=\"flex-grow:1;\">${invoice.posting_date}</div>`)\n\t\t\tcustomerBox.append(`<div style=\"flex-grow:1;\">Sales Invoice</div>`)\n\t\t\tcustomerBox.append(`<div class=\"rowBox centerItem payBtn\" style=\"${payBtnStyle}\">Pay</div>`)\n\n\t\t\t // Set up the click event listener for the Pay button\n\t\t\tcustomerBox.find('.payBtn').on('click', async () => {\n\t\t\t\t// Get the invoice name from the customerBox\n\t\t\t\t//const invoiceName = customerBox.data('invoice-name');\n\t\t\t\t// Proceed to pay the invoice with a predefined payment amount (e.g., 1000 DA)\n\t\t\t\tawait this.paySalesInvoice(invoice);\n\t\t\t});\n\t\t\tthis.debtList.append(customerBox)\n\t\t})\n\n\n\n\t\tthis.refreshTotal( total_debt );\n\n\n\t}\n\n\n\tasync payPosInvoice(invoice) {\n\n\t\t// Ensure the payment amount is a valid float\n\t\tconst paymentAmount = parseFloat(this.payment_amount) || 0;\n\t\tif(this.paymentAmount <= 0){\n\t\t\tfrappe.msgprint(__('The paid amount should be grant than 0'));\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tthis.show_waiting();\n\n\t\t\t// Call the server method to update the invoice payment\n\t\t\tconst result = await this.app_data.update_invoice_payment(invoice.name, this.payment_amount);\n\n\t\t\t// Update the payment amount and UI\n\t\t\tthis.payment_amount = result.remaining;\n\t\t\tthis.leftContainer.find(\"#debt_paymentAmount\").val(result.remaining);\n\n\t\t\t// Refresh the client's debt details\n\t\t\tawait this.refreshClientDebtPart(this.selected_client);\n\t\t} catch (error) {\n\t\t\t// Handle errors gracefully\n\t\t\tconsole.error(\"Error processing payment:\", error);\n\n\t\t\t// Optional: Notify the user about the error\n\t\t\talert(\"An error occurred while processing the payment. Please try again.\");\n\t\t} finally {\n\t\t\t// Ensure waiting spinner is hidden regardless of success or failure\n\t\t\tthis.hide_waiting();\n\t\t}\n\t}\n\n\tasync paySalesInvoice(invoice) {\n\t\ttry {\n\t\t\tthis.show_waiting();\n\n\t\t\t// Ensure the payment amount is a valid float\n\t\t\tconst paymentAmount = parseFloat(this.payment_amount) || 0;\n\n\t\t\tif(paymentAmount <= 0){\n\t\t\t\tfrappe.msgprint(__('The paid amount should be grant than 0'));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Call the server method to update the invoice payment\n\t\t\tconst result = await this.app_data.update_sales_invoice_payment(invoice.name, paymentAmount);\n\n\t\t\t// add check in to the voucher.\n\t\t\tconst check_in_amount  = this.payment_amount - result.remaining;\n\t\t\tconst checkInOut         = frappe.model.get_new_doc('check_in_out')\n\t\t\tcheckInOut.creation_time = frappe.datetime.now_datetime();\n\t\t\tcheckInOut.user          = frappe.session.user;\n\t\t\tcheckInOut.check_type    = 'In';\n\t\t\tcheckInOut.is_sync       = 0 ;\n\t\t\tcheckInOut.amount        = parseFloat(check_in_amount);\n\t\t\tcheckInOut.reason_note   = 'Debt payment.';\n\t\t\t\n\t\t\t\n\t\t\tthis.app_data.saveCheckInOut(\n\t\t\t\tcheckInOut,\n\t\t\t\t(res)=>{\n\t\t\t\t\tthis.refresh_check_in_out()\n\t\t\t\t},(err)=>{\n\t\t\t\t\tconsole.log('err to save checkInOut : ' , err)\n\t\t\t\t}\n\t\t\t)\n\n\t\t\t// Ensure result is valid and contains the `remaining` field\n\t\t\tif (result && typeof result.remaining === \"number\") {\n\t\t\t\t// Update the payment amount and UI\n\t\t\t\tthis.payment_amount = result.remaining;\n\t\t\t\tthis.leftContainer.find(\"#debt_paymentAmount\").val(result.remaining);\n\n\t\t\t\t// Refresh the client's debt details\n\t\t\t\tawait this.refreshClientDebtPart(this.selected_client);\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"Unexpected server response. Please try again.\");\n\t\t\t}\n\t\t} catch (error) {\n\t\t\t// Log the error for debugging purposes\n\t\t\tconsole.error(\"Error processing sales invoice payment:\", error);\n\n\t\t\t// Notify the user about the error\n\t\t\talert(\"An error occurred while processing the payment. Please try again later.\");\n\t\t} finally {\n\t\t\t// Ensure the waiting spinner is hidden regardless of success or failure\n\t\t\tthis.hide_waiting();\n\t\t}\n\t}\n\n\n\n\tasync paySelectedInvoice() {\n\t\ttry {\n\t\t\tthis.show_waiting();\n\n\t\t\t// Ensure the payment amount is a valid float\n\t\t\tconst paymentAmount = parseFloat(this.payment_amount) || 0;\n\n\t\t\t// Call the server method to update the invoice payment\n\t\t\tconst result = await this.app_data.paySelectedInvoice(this._selected_invoice , paymentAmount);\n\n\t\t\t// add check in to the voucher.\n\t\t\tconst check_in_amount    = paymentAmount - result.remaining;\n\t\t\tconst checkInOut         = frappe.model.get_new_doc('check_in_out')\n\t\t\tcheckInOut.creation_time = frappe.datetime.now_datetime();\n\t\t\tcheckInOut.user          = frappe.session.user;\n\t\t\tcheckInOut.check_type    = 'In';\n\t\t\tcheckInOut.is_sync       = 0   ;\n\t\t\tcheckInOut.amount        = parseFloat(check_in_amount);\n\t\t\tcheckInOut.reason_note   = 'Debt payment.';\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\tthis.app_data.saveCheckInOut(\n\t\t\t\tcheckInOut,\n\t\t\t\t(res)=>{\n\t\t\t\t\tthis.refresh_check_in_out()\n\t\t\t\t},(err)=>{\n\t\t\t\t\tconsole.log('err to save checkInOut : ' , err)\n\t\t\t\t}\n\t\t\t)\n\n\t\t\t// Ensure result is valid and contains the `remaining` field\n\t\t\tif (result && typeof result.remaining === \"number\") {\n\t\t\t\t// Update the payment amount and UI\n\t\t\t\tthis.payment_amount = result.remaining;\n\t\t\t\tthis.leftContainer.find(\"#debt_paymentAmount\").val(result.remaining);\n\n\t\t\t\t// Refresh the client's debt details\n\t\t\t\tawait this.refreshClientDebtPart(this.selected_client);\n\t\t\t} else {\n\t\t\t\tthrow new Error(\"Unexpected server response. Please try again.\");\n\t\t\t}\n\t\t} catch (error) {\n\t\t\t// Log the error for debugging purposes\n\t\t\tconsole.error(\"Error processing sales invoice payment:\", error);\n\n\t\t\t// Notify the user about the error\n\t\t\talert(\"An error occurred while processing the payment. Please try again later.\");\n\t\t} finally {\n\t\t\t// Ensure the waiting spinner is hidden regardless of success or failure\n\t\t\tthis.hide_waiting();\n\t\t}\n\t}\n\n\n\n\n\n}\n", "pos_ar.PointOfSale.pos_unsynced_cart = class {\n\n    constructor(\n        wrapper,\n        appData,\n        db,\n        viewDetailsCallback,\n        onDeleteCallback\n    ){\n        this.wrapper   = wrapper;\n        this.app_data  = appData;\n        this.db        = db;\n        this.view_details_callback = viewDetailsCallback ;\n        this.on_delete_callback = onDeleteCallback;\n\n        //local data\n        this.invoices = [];\n        this.filter = 'All';\n        this.selectedInvoice = null;\n        this.search_value = '';\n\n        this.start_work();\n    }\n\n    /****************************************    INIT    *******************************************************/\n    async start_work() {\n        this.prepare_unsynced_pos_cart();\n        await this.getAllUnsyncedInvoices();\n        this.setListeners();\n    }\n\n    /****************************************    UI    *******************************************************/\n    prepare_unsynced_pos_cart() {\n        this.wrapper.find('#LeftSection').append('<div id=\"unsyncedPosLeftContainer\" class=\"columnBox\" style=\"display:none;\"></div>')\n        this.wrapper.find('#RightSection').append('<div id=\"unsyncedPosRightContainer\" class=\"columnBox\" style=\"display:none;\"></div>')\n\n        this.left_container = this.wrapper.find('#unsyncedPosLeftContainer')\n        this.right_container = this.wrapper.find('#unsyncedPosRightContainer')\n\n        ///////////////////right section\n        this.right_container.append(`<div id=\"unsyncedRightContainerHeader\" class=\"rowBox align_center\"><h4 class=\"CartTitle\">Unsynced Invoices</h4></div>`)\n        \n        //search and filter\n        this.right_container.append('<div id=\"unsyncedRightSearchContainer\" class=\"rowBox align_center\"></div>');\n        this.search_container = this.right_container.find('#unsyncedRightSearchContainer');\n        \n        this.search_container.append('<select id=\"unsyncedFilterInput\" placeholder=\"Filter Status\">');\n        this.filter_input = this.search_container.find(\"#unsyncedFilterInput\")\n        this.filter_input.append('<option value=\"All\" selected>All</option><option value=\"Not Synced\">Not Synced</option><option value=\"Failed\">Failed</option>')\n        \n        this.search_container.append('<input type=\"text\" id=\"unsyncedSearchInput\" placeholder=\"Search by invoice number\">');\n        this.search_field = this.search_container.find(\"#unsyncedSearchInput\")\n\n        //invoice list\n        this.right_container.append('<div id=\"unsyncedInvoiceList\" class=\"columnBox\"></div>')\n        this.unsynced_invoice_list = this.right_container.find('#unsyncedInvoiceList')\n\n        //////////////////now left section\n        //header with status and amounts\n        const header =\n            '<div id=\"detailsUnsyncedHeader\" class=\"rowBox\">' +\n                '<div class=\"c1 columnBox\">' +\n                    '<div id=\"unsyncedCustomer\">Customer</div>' +\n                    '<div id=\"unsyncedSoldBy\"></div>' +\n                    '<div id=\"unsyncedStatus\" class=\"status\"></div>' +\n                '</div>' +\n                '<div class=\"c2 columnBox\">' +\n                    '<div id=\"unsyncedCost\">0,0000 DA</div>' +\n                    '<div id=\"unsyncedId\">ACC-PSINV-2024-ID</div>' +\n                    '<div id=\"unsyncedRealId\">POS realI</div>' +\n                '</div>' +\n            '</div>'\n        this.left_container.append(header)\n        this.details_unsynced_header = this.left_container.find('#detailsUnsyncedHeader')\n\n        // invoice details content\n        this.left_container.append('<div id=\"unsyncedContent\" class=\"columnBox\"></div>')\n        this.unsyncedContent = this.left_container.find('#unsyncedContent')\n        \n        //items section\n        this.unsyncedContent.append('<div id=\"unsyncedItemContainer\"><div class=\"posSectionTitle\">Items</div><div id=\"unsyncedItemList\"></div></div>')\n        this.itemContainer = this.unsyncedContent.find('#unsyncedItemContainer')\n        this.itemList = this.itemContainer.find('#unsyncedItemList')\n\n        //totals section\n        this.unsyncedContent.append('<div id=\"unsyncedTotalsContainer\"><div class=\"posSectionTitle\">Totals</div><div id=\"unsyncedTotalList\"></div></div>')\n        this.totalsContainer = this.unsyncedContent.find('#unsyncedTotalsContainer')\n        this.totalList = this.unsyncedContent.find('#unsyncedTotalList')\n\n        //payments section\n        this.unsyncedContent.append('<div id=\"unsyncedPaymentsContainer\"><div class=\"posSectionTitle\">Payments</div><div id=\"unsyncedMethodList\"></div></div>')\n        this.paymentsContainer = this.unsyncedContent.find('#unsyncedPaymentsContainer')\n        this.methodList = this.unsyncedContent.find('#unsyncedMethodList')\n\n        //action buttons\n        this.left_container.append('<div id=\"unsyncedActionsContainer\" class=\"rowBox align_content\">' +\n            '<div id=\"unsyncedRetryBtn\" class=\"actionBtn rowBox centerItem\">Retry Sync</div>' +\n            '<div id=\"unsyncedViewBtn\" class=\"actionBtn rowBox centerItem\">View Details</div>' +\n        '</div>')\n\n        this.actionButtonsContainer = this.left_container.find('#unsyncedActionsContainer')\n        this.retryButton = this.actionButtonsContainer.find('#unsyncedRetryBtn')\n        this.viewButton = this.actionButtonsContainer.find('#unsyncedViewBtn')\n    }\n\n    refreshData() {\n        this.unsynced_invoice_list.empty();\n        \n        console.log(\"refreshing unsynced invoice list\" , this.invoices , \"unsynced \" , this.invoices.filter(invoice => !invoice.synced))\n        const filteredList = this.invoices.filter(invoice => !invoice.synced)\n        if (!filteredList.length) {\n            this.unsynced_invoice_list.append('<div class=\"empty-state\">No unsynced invoices found</div>');\n            return;\n        }\n\n        filteredList.forEach(invoice => {\n            const invoiceContainer = document.createElement('div');\n            invoiceContainer.classList.add('posInvoiceContainer')\n            invoiceContainer.classList.add('columnBox')\n            invoiceContainer.classList.add('align_content')\n\n            //line 1\n            const l1 = document.createElement('div')\n            l1.classList.add('l1')\n            l1.classList.add('rowBox')\n            l1.classList.add('align_content')\n\n            const posName = document.createElement('div')\n            posName.classList.add('posName')\n            posName.textContent = invoice.name\n\n            const posCost = document.createElement('div')\n            posCost.classList.add('posCost')\n            posCost.textContent = format_currency(invoice.grand_total, invoice.currency)\n\n            l1.appendChild(posName)\n            l1.appendChild(posCost)\n\n            //line 2\n            const l2 = document.createElement('div')\n            l2.classList.add('l2')\n            l2.classList.add('rowBox')\n            l2.classList.add('align_content')\n\n            //l2 customer\n            const customer = document.createElement('div')\n            customer.classList.add('customer')\n            customer.classList.add('rowBox')\n            customer.classList.add('align_content')\n\n            const customerLogo = document.createElement('img')\n            customerLogo.src = '/assets/pos_ar/images/customer.png'\n            customerLogo.width = 16\n            customerLogo.height = 16\n            customerLogo.classList.add('customerLogo')\n\n            const customerName = document.createElement('div')\n            customerName.textContent = invoice.customer || 'Guest'\n            customerName.classList.add('customerName')\n\n            customer.appendChild(customerLogo)\n            customer.appendChild(customerName)\n\n            l2.appendChild(customer)\n\n            //l2 status\n            const status = document.createElement('div')\n            status.classList.add('status')\n            status.classList.add(invoice.status.toLowerCase().replace(' ', '-'))\n            status.textContent = invoice.status\n            l2.appendChild(status)\n\n            // Add delete button\n            const deleteBtn = document.createElement('button');\n            deleteBtn.classList.add('invoice-delete-btn');\n            deleteBtn.innerHTML = `<i class=\"fa fa-trash fa-lg\"></i>`;\n            l2.appendChild(deleteBtn);\n\n            // Add click event for delete button\n            deleteBtn.addEventListener('click', (e) => {\n                e.stopPropagation();  // Prevent invoice selection when clicking delete\n                this.app_data.deletePosInvoice_callback(\n                    invoice.name,\n                    ()=>{\n                        this.getAllUnsyncedInvoices()\n                        this.on_delete_callback()\n                        //this.refreshInvoiceDetails()\n                    },(err)=>{\n                        console.error('Error deleting invoice:', err);\n                        frappe.msgprint({\n                            title: __('Error'),\n                            indicator: 'red',\n                            message: __('Failed to delete invoice')\n                        });\n                    }\n                );\n            });\n\n            //add all to container\n            invoiceContainer.appendChild(l1)\n            invoiceContainer.appendChild(l2)\n\n            invoiceContainer.addEventListener('click', () => {\n                this.selectedInvoice = invoice;\n                this.refreshInvoiceDetails();\n                console.log(\"selected invoice : \" , this.selectedInvoice)\n                this.unsynced_invoice_list.find('.posInvoiceContainer').removeClass('selected');\n                $(invoiceContainer).addClass('selected');\n            })\n\n            this.unsynced_invoice_list.append(invoiceContainer);\n        });\n\n        //refresh details if needed\n        if (this.selectedInvoice) {\n            this.refreshInvoiceDetails();\n        }\n    }\n\n    refreshInvoiceDetails() {\n        // Check if selected invoice exists and is still in the invoices list\n        if (!this.selectedInvoice || !this.invoices.find(inv => inv.name === this.selectedInvoice.name)) {\n            this.selectedInvoice = null;\n            this.unsyncedContent.addClass('d-none');\n            // Clear all data\n            const header = this.details_unsynced_header;\n            header.find('#unsyncedCustomer').text('');\n            header.find('#unsyncedSoldBy').text('');\n            header.find('#unsyncedStatus').text('').removeClass();\n            header.find('#unsyncedCost').text('');\n            header.find('#unsyncedId').text('');\n            header.find('#unsyncedRealId').text('');\n            this.itemList.empty();\n            this.totalList.empty();\n            this.methodList.empty();\n            return;\n        }\n\n        this.unsyncedContent.removeClass('d-none');\n        \n        //update header\n        const header = this.details_unsynced_header;\n        header.find('#unsyncedCustomer').text(this.selectedInvoice.customer || 'Guest');\n        header.find('#unsyncedSoldBy').text(this.selectedInvoice.owner);\n        header.find('#unsyncedStatus').text(this.selectedInvoice.status)\n            .removeClass('not-synced failed')\n            .addClass(this.selectedInvoice.status.toLowerCase().replace(' ', '-'));\n        header.find('#unsyncedCost').text(format_currency(this.selectedInvoice.grand_total, this.selectedInvoice.currency));\n        header.find('#unsyncedId').text(this.selectedInvoice.name);\n        header.find('#unsyncedRealId').text(this.selectedInvoice.pos_profile);\n\n        //update items\n        this.itemList.empty();\n        this.selectedInvoice.items.forEach(item => {\n            const itemRow = document.createElement('div');\n            itemRow.classList.add('itemRow', 'rowBox');\n            \n            const itemName = document.createElement('div');\n            itemName.classList.add('itemName');\n            itemName.textContent = item.item_name;\n            \n            const itemQty = document.createElement('div');\n            itemQty.classList.add('itemQty');\n            itemQty.textContent = item.qty;\n            \n            const itemRate = document.createElement('div');\n            itemRate.classList.add('itemRate');\n            itemRate.textContent = format_currency(item.rate, this.selectedInvoice.currency);\n            \n            const itemAmount = document.createElement('div');\n            itemAmount.classList.add('itemAmount');\n            itemAmount.textContent = format_currency(item.amount, this.selectedInvoice.currency);\n            \n            itemRow.appendChild(itemName);\n            itemRow.appendChild(itemQty);\n            itemRow.appendChild(itemRate);\n            itemRow.appendChild(itemAmount);\n            \n            this.itemList.append(itemRow);\n        });\n\n        //update totals\n        this.totalList.empty();\n        const totalRow = document.createElement('div');\n        totalRow.classList.add('totalRow', 'rowBox');\n        \n        const totalLabel = document.createElement('div');\n        totalLabel.classList.add('totalLabel');\n        totalLabel.textContent = 'Grand Total';\n        \n        const totalAmount = document.createElement('div');\n        totalAmount.classList.add('totalAmount');\n        totalAmount.textContent = format_currency(this.selectedInvoice.grand_total, this.selectedInvoice.currency);\n        \n        totalRow.appendChild(totalLabel);\n        totalRow.appendChild(totalAmount);\n        this.totalList.append(totalRow);\n\n        //update payments\n        this.methodList.empty();\n        this.selectedInvoice.payments.forEach(payment => {\n            const paymentRow = document.createElement('div');\n            paymentRow.classList.add('paymentRow', 'rowBox');\n            \n            const paymentMode = document.createElement('div');\n            paymentMode.classList.add('paymentMode');\n            paymentMode.textContent = payment.mode_of_payment;\n            \n            const paymentAmount = document.createElement('div');\n            paymentAmount.classList.add('paymentAmount');\n            paymentAmount.textContent = format_currency(payment.amount, this.selectedInvoice.currency);\n            \n            paymentRow.appendChild(paymentMode);\n            paymentRow.appendChild(paymentAmount);\n            \n            this.methodList.append(paymentRow);\n        });\n    }\n\n    show_cart() {\n        this.left_container.css(\"display\", \"flex\");\n        this.right_container.css(\"display\", \"flex\");\n        this.getAllUnsyncedInvoices();\n    }\n\n    hide_cart() {\n        this.left_container.css(\"display\", \"none\");\n        this.right_container.css(\"display\", \"none\");\n    }\n\n    async getAllUnsyncedInvoices() {\n        this.invoices = await this.db.getAllPosInvoice()\n        this.refreshData();\n        this.refreshInvoiceDetails();\n    }\n\n    async retrySync(invoice) {\n\n        frappe.db.insert(\n            invoice\n        ).then(r =>{\n            const updatedPos = structuredClone(invoice)\n            updatedPos.synced = true;\n            updatedPos.real_name = r.name\n            this.appData.updatePosInvoice(updatedPos)\n            \n            //this.customer_box.setSynced();\n            //this.unsyncedPos = 0;\n            \n        }).catch(err =>{\n            console.error('Error retrying sync:', err);\n            frappe.msgprint({\n                title: __('Error'),\n                indicator: 'red',\n                message: __('Failed to sync invoice')\n            });\n        })\n    }\n\n    async deleteInvoice(invoice_name) {\n        if (!confirm('Are you sure you want to delete this unsynced invoice?')) {\n            return;\n        }\n        \n        try {\n            \n            // Remove from local list\n            //this.invoices = this.invoices.filter(inv => inv.name !== invoice_name);\n            this.refreshData();\n            frappe.show_alert({\n                message: __('Invoice deleted successfully'),\n                indicator: 'green'\n            });\n        } catch (error) {\n            frappe.show_alert({\n                message: __('Failed to delete invoice'),\n                indicator: 'red'\n            });\n        }\n    }\n\n    setListeners() {\n        this.filter_input.on('change', () => {\n            this.filter = this.filter_input.val();\n            this.refreshData();\n        });\n\n        this.search_field.on('input', () => {\n            this.search_value = this.search_field.val();\n            this.refreshData();\n        });\n\n        this.retryButton.on('click', () => {\n            if (this.selectedInvoice) {\n                this.retrySync(this.selectedInvoice);\n            }\n        });\n\n        this.viewButton.on('click', () => {\n            if (this.selectedInvoice) {\n                this.view_details_callback(this.selectedInvoice)\n            }\n        });\n    }\n}", "pos_ar.PointOfSale.posSettingsData = class{\n\n\n\tconstructor(db){\n\n\t\tthis.db = db;\n\t\t//Array of valid values\n\t\tthis.price_bases     = ['brand'   , 'priceList']\n\t\tthis.keyboard_styles = ['primery' , 'secondary']\n\n\t\tconst defaults = {\n\t\t\titemPriceBasedOn  : 'brand'     ,\n\t\t\tkeyboardStyle     : 'secondary' ,\n\t\t\tshowItemDetails   : false       ,\n\t\t\tshowItemImage     : false       ,\n\t\t\tshowDiscountField : false       ,\n\t\t\tonlineDebt        : true        ,\n\t\t\ttesting           : false,\n\t\t\tsearch_by_group   : false\n\t\t}\n\n\n\t\t//Default setting (it could be more)\n\t\tthis.db.getSettings(\n\n\t\t\t(res)=>{\n\t\t\t\tif(res && res.itemPriceBasedOn ){\n\t\t\t\t\tthis.settings = {...defaults , ...( res || {} ) }\n\t\t\t\t}else{\n\t\t\t\t\t//default\n\t\t\t\t\tthis.settings = {\n\t\t\t\t\t\titemPriceBasedOn  : 'brand'     ,\n\t\t\t\t\t\tkeyboardStyle     : 'secondary' ,\n\t\t\t\t\t\tshowItemDetails   : false       ,\n\t\t\t\t\t\tshowItemImage     : false       ,\n\t\t\t\t\t\tshowDiscountField : false       ,\n\t\t\t\t\t\tonlineDebt        : true        ,\n\t\t\t\t\t\tsearch_by_group   : false\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tconsole.log(\"test result : \" , this.settings)\n\n\t\t\t},\n\t\t\t(err)=>{\n\t\t\t\tconsole.log(\"error when trying to get the setting from local, so we use the default.\")\n\t\t\t\tthis.settings = {\n\t\t\t\t\titemPriceBasedOn  : 'brand'     ,\n\t\t\t\t\tkeyboardStyle     : 'secondary' ,\n\t\t\t\t\tshowItemDetails   : false       ,\n\t\t\t\t\tshowItemImage     : false       ,\n\t\t\t\t\tshowDiscountField : false       ,\n\t\t\t\t\tonlineDebt        : true        ,\n\t\t\t\t\tsearch_by_group   : false\n\t\t\t\t}\n\n\t\t\t}\n\t\t)\n\t}\n\n\tgetAllPriceBases(){\n\t\treturn this.price_bases;\n\t}\n\tgetAllKeyboardStyles(){\n\t\treturn this.keyboard_styles;\n\t}\n\n\t//PriceItemBasedOn\n\tgetPriceBase(){\n\t\treturn this.settings.itemPriceBasedOn;\n\t}\n\tsetPriceItemBasedOn(base , onSuccess , onFailure){\n\t\tif(this.price_bases.includes(base)){\n\t\t\tthis.settings.itemPriceBasedOn = base\n\t\t\tthis.db.updateSettings_callback(\n\t\t\t\tthis.settings,\n\t\t\t\t()=>{\n\t\t\t\t\t//saved\n\t\t\t\t\tonSuccess();\n\t\t\t\t\tconsole.log(\"settings update is save successfuly\")\n\t\t\t\t},()=>{\n\t\t\t\t\tconsole.error(\"error occured when trying to save settings\")\n\t\t\t\t}\n\t\t\t)\n\t\t}else{\n\t\t\tconsole.error(\"invalide base : \" , base , \"there are just : \" , this.price_bases)\n\t\t}\n\t}\n\n\t//show item details\n\tgetShowItemDetails(){\n\t\treturn this.settings.showItemDetails;\n\t}\n\tsetShowItemDetails(show , onSuccess , onFailure){\n\t\tthis.settings.showItemDetails = show\n\t\tthis.db.updateSettings_callback(\n\t\t\tthis.settings,\n\t\t\t()=>{\n\t\t\t\t//saved\n\t\t\t\tonSuccess();\n\t\t\t\tconsole.log(\"settings update is save successfuly\")\n\t\t\t},()=>{\n\t\t\t\tconsole.error(\"error occured when trying to save settings\")\n\t\t\t}\n\t\t)\n\n\t}\n\n\n\tsetSettings( settings , onSuccess , onFailure){\n\t\tthis.settings  = settings\n\t\tthis.db.updateSettings_callback(\n\t\t\tthis.settings,\n\t\t\t()=>{\n\t\t\t\t//saved\n\t\t\t\tonSuccess();\n\t\t\t\tconsole.log(\"settings update is save successfuly\")\n\t\t\t},()=>{\n\t\t\t\tconsole.error(\"error occured when trying to save settings\")\n\t\t\t}\n\t\t)\n\n\t}\n\n\n}\n", "pos_ar.PointOfSale.posAppData = class {\n\n\tconstructor(\n\t\tdb,\n\t\tapiHandler\n\t){\n\t\tthis.db          = db;\n\t\tthis.api_handler = apiHandler;\n\n\t\tthis.since = localStorage.getItem('lastTime');\n\n\n\t\tthis.appData = {} ;\n\t}\n\n\n\tasync getAllData(){\n\t\ttry{\n\t\t\tfrappe.show_progress('Please Wait', 0, 12, 'loading deleted documents');\n\t\t\tawait this.getDeletedDocs()\n\t\t\tfrappe.show_progress('Please Wait', 1, 12, 'loading customers...');\n\t\t\tawait this.getCustomers();\n\t\t\tfrappe.show_progress('Please Wait', 2, 12, 'loading items...');\n\t\t\tawait this.getItems();\n\t\t\tfrappe.show_progress('Please Wait', 3, 12, 'loading pos profiles');\n\t\t\tawait this.getPosProfiles();\n\t\t\tfrappe.show_progress('Please Wait', 4, 12, 'loading mode of payment');\n\t\t\tawait this.getPosProfileModeOfPayments(this.appData.pos_profile)\n\t\t\tawait this.getBins();\n\t\t\tfrappe.show_progress('Please Wait', 5, 12, 'loading warehouses');\n\t\t\tawait this.getWarehouses();\n\t\t\tfrappe.show_progress('Please Wait', 6, 12, 'loading price lists');\n\t\t\tawait this.getPriceLists();\n\t\t\tfrappe.show_progress('Please Wait', 7, 12, 'loading item prices');\n\t\t\tawait this.getItemPrices();\n\t\t\tfrappe.show_progress('Please Wait', 8, 12, 'loading item groups');\n\t\t\tawait this.getItemGroups();\n\t\t\tfrappe.show_progress('Please Wait', 9, 12, 'loading invoices');\n\t\t\tawait this.getPosInvoices();\n\t\t\tfrappe.show_progress('Please Wait', 10, 12, 'loading check in out');\n\t\t\tawait this.getCheckInOuts();\n\t\t\tfrappe.show_progress('Please Wait', 11, 12, 'loading barcodes');\n\t\t\tawait this.getItemBarcodes()\n\t\t\tfrappe.show_progress('Please Wait', 12, 12, 'Completed');\n\t\t\tfrappe.hide_progress();\n\t\t\tfrappe.hide_progress();\n\t\t\tfrappe.hide_progress();\n\t\t\tfrappe.hide_progress();\n\n\t\t\tthis.since = frappe.datetime.now_datetime()\n\t\t\tlocalStorage.setItem('lastTime', frappe.datetime.now_datetime());\n\n\n\t\t\tconsole.log(\"app data : \" , this.appData)\n\t\t}catch(err){\n\t\t\tconsole.error(\"appData Class Error  : \" , err)\n\t\t\tfrappe.hide_progress();\n\t\t}\n\t\t\tfrappe.hide_progress();\n\n\n\t}\n\n\n\tasync getCustomers(){\n\t\t/*the function should combine the two the logic didnt complite yet we still working on it*/\n\t\t//get local\n\t\t//const localCustomers = await this.db.getAllCustomers();\n\t\tconst localCustomers = [];\n\t\t//get remote\n\t\tconst updatedCustomers = await this.api_handler.fetchCustomers(this.since)\n\t\t//save new customers\n\t\tawait this.db.saveCustomerList(updatedCustomers)\n\n\t\tthis.appData.customers = this.combineLocalAndUpdated(localCustomers,updatedCustomers)\n\n\t}\n\tasync getBrands(){\n\t\t//get local\n\t\t//get remote\n\t\tthis.appData.brands = await this.api_handler.fetchBrands(this.since)\n\t}\n\tasync getItems(){\n\t\t//get local\n\t\t//const localItems   = await this.db.getAllItems();\n\t\tconst localItems   = [];\n\t\t//get remote\n\t\tconst updatedItems = await this.api_handler.fetchItems(this.since)\n\t\t//save new items\n\t\tawait this.db.saveItemList(updatedItems)\n\n\t\tthis.appData.items = this.combineLocalAndUpdated(localItems,updatedItems)\n\t}\n\tasync getPosProfiles(){\n\t\tthis.appData.pos_profile  =  await this.api_handler.fetchPosProfile(this.since)\n\t}\n\tasync getPosProfileModeOfPayments(posProfile){\n\t\tlet modeOfPaymentsIds = []\n\t\tposProfile.payments.forEach(modeId=>{\n\t\t\tmodeOfPaymentsIds.push(modeId.mode_of_payment)\n\t\t})\n\t\tthis.appData.posProfileModeOfPayments = await this.api_handler.fetchPosProfileModeOfPayments(modeOfPaymentsIds , posProfile.company)\n\t}\n\tasync getBins(){\n\t\t//get local\n\t\t//const localBins   = await this.db.getAllBin();\n\t\tconst localBins   = [];\n\t\t//get remote\n\t\tconst updatedBins = await this.api_handler.fetchBinList(this.since)\n\t\t//save new bins\n\t\tawait this.db.saveBinList(updatedBins)\n\n\t\tthis.appData.bins = this.combineLocalAndUpdated(localBins,updatedBins)\n\t}\n\tasync getWarehouses(){\n\t\t//get local\n\t\t//const localWarehouses   = await this.db.getAllWarehouse();\n\t\tconst localWarehouses   = [];\n\t\t//warehouse\n\t\tconst updatedWarehouses = await this.api_handler.fetchWarehouseList(this.since)\n\t\t//save new warehouse\n\t\tawait this.db.saveWarehouseList(updatedWarehouses);\n\t\tthis.appData.warehouses = this.combineLocalAndUpdated(localWarehouses,updatedWarehouses)\n\t}\n\tasync getPriceLists(){\n\t\t//get local\n\t\t//const localPriceLists  = await this.db.getAllPriceList();\n\t\tconst localPriceLists  = [];\n\t\t//get remote\n\t\tconst updatedPriceList = await this.api_handler.fetchPriceList(this.since)\n\t\t//save new price list\n\t\tawait this.db.savePriceLists(updatedPriceList)\n\n\t\tthis.appData.price_lists = this.combineLocalAndUpdated(localPriceLists,updatedPriceList)\n\t}\n\tasync getItemPrices(){\n\t\t//get local\n\t\t//const localItemPrices = await this.db.getAllItemPrice();\n\t\tconst localItemPrices = [];\n\t\t//get remote\n\t\tconst updateItemPrices = await this.api_handler.fetchItemPrice(this.since)\n\t\tawait this.db.saveItemPriceList(updateItemPrices);\n\n\t\tthis.appData.item_prices = this.combineLocalAndUpdated(localItemPrices,updateItemPrices)\n\t\tconsole.log()\n\t}\n\tasync getItemGroups(){\n\t\t//get local\n\t\t//const localItemGroups = await this.db.getAllItemGroup();\n\t\tconst localItemGroups = [];\n\t\t//get remote\n\t\tconst updatedItemGroups = await this.api_handler.fetchItemGroups(this.since)\n\t\tawait this.db.saveItemGroupList(updatedItemGroups)\n\n\t\tthis.appData.item_groups = this.combineLocalAndUpdated(localItemGroups,updatedItemGroups)\n\t}\n\tasync getItemBarcodes(){\n\t\tthis.appData.item_barcodes = await this.api_handler.fetchItemBarCodes()\n\t}\n\tasync getPosInvoices(){\n\t\t//get local\n\t\tthis.appData.pos_invoices = await this.db.getAllPosInvoice();\n\t}\n\tasync getCheckInOuts(){\n\t\t//get local\n\t\tthis.appData.check_in_outs = await this.db.getAllCheckInOut();\n\t}\n\n\tasync getDeletedDocs(){\n\t\t//get local\n\t\tthis.appData.deleted_documents = await this.api_handler.fetchDeletedDocs(this.since);\n\t}\n\n\n\n\tsaveCheckInOut(checkInOut,onSuccess,onFailure){\n\t\tthis.db.saveCheckInOut(checkInOut,onSuccess,onFailure)\n\t}\n\tsavePosInvoice(posInvoice){\n\t\tthis.db.savePosInvoice(posInvoice)\n\t}\n\tupdatePosInvoice(posInvoice){\n\t\tthis.db.updatePosInvoice(posInvoice)\n\t}\n\tgetNotSyncedPos(onSuccess,onFailure){\n\t\tthis.db.getNotSyncedPos(\n\t\t\t(res)=>{\n\t\t\t\tonSuccess(res)\n\t\t\t},(err)=>{\n\t\t\t\tonFailure(err)\n\t\t\t}\n\t\t)\n\t}\n\tgetNotSyncedPosNumber(onSuccess,onFailure){\n\t\tthis.db.getNotSyncedPosNumber(\n\t\t\t(res)=>{\n\t\t\t\tonSuccess(res)\n\t\t\t},(err)=>{\n\t\t\t\tonFailure(err)\n\t\t\t}\n\t\t)\n\t}\n\n\n\tasync fetchDebts(customerName){\n\t\treturn await this.api_handler.fetchDebts(customerName)\n\t}\n\tasync fetchDebtsSalesInvoices(customerName){\n\t\treturn await this.api_handler.fetchDebtsSalesInvoices(customerName)\n\t}\n\n\n\n\tasync fetchCustomerDebt( customerName){\n\t\treturn await this.api_handler.fetchCustomerDebt( customerName )\n\t}\n\n\tasync update_invoice_payment(invoiceName , amount){\n\n\t\tconst rest = await this.api_handler.update_invoice_payment( invoiceName , amount)\n\n\n\t\tawait this.getPosInvoices()\n\n\t\tthis.appData.pos_invoices.forEach(invoice=>{\n\t\t\tif(invoice.real_name == invoiceName){\n\t\t\t\tlet newInvoice = structuredClone(invoice)\n\t\t\t\tnewInvoice.outstanding_amount = rest.outstanding_amount\n\t\t\t\tnewInvoice.paid_amount        = rest.paid_amount\n\t\t\t\tnewInvoice.status             = rest.paid\n\t\t\t\tnewInvoice.real_name          = rest.real_name\n\t\t\t\tthis.db.updatePosInvoice(newInvoice)\n\t\t\t}\n\t\t})\n\n\t\treturn rest\n\t}\n\tasync update_sales_invoice_payment(invoiceName , amount){\n\n\t\tconst rest = await this.api_handler.update_sales_invoice_payment( invoiceName , amount)\n\n\n\t\trest.invoices.forEach(invoice=>{\n\t\t\tthis.appData.pos_invoices.forEach(posInvoice=>{\n\t\t\t\tif(posInvoice.real_name == invoice.name){\n\t\t\t\t\tposInvoice.consolidated_invoice = invoiceName\n\t\t\t\t\tposInvoice.start_paying         = true\n\t\t\t\t\tif(rest.status == \"Paid\"){\n\t\t\t\t\t\tposInvoice.outstanding_amount = 0\n\t\t\t\t\t\tposInvoice.paid_amount        = invoice.total\n\t\t\t\t\t\tposInvoice.grand_paid_amount  = invoice.total\n\t\t\t\t\t\tposInvoice.status             = 'Paid'\n\t\t\t\t\t}\n\t\t\t\t\tthis.db.updatePosInvoice(posInvoice)\n\t\t\t\t}\n\t\t\t})\n\t\t})\n\n\t\t//update related data\n\t\tawait this.getPosInvoices()\n\n\t\treturn rest\n\t}\n\n\tasync paySelectedInvoice(invoices , amount){\n\t\tconst rest = await this.api_handler.pay_selected_invoice( invoices , amount)\n\n\t\trest.invoices_state_collection.forEach(invoices_status =>{\n\t\t\tinvoices_status.invoices.forEach(invoice=>{\n\t\t\t\tthis.appData.pos_invoices.forEach(posInvoice=>{\n\t\t\t\t\tif(posInvoice.real_name == invoice.name){\n\t\t\t\t\t\tposInvoice.consolidated_invoice = invoices_status.sales_invoice_name\n\t\t\t\t\t\tposInvoice.start_paying         = true\n\t\t\t\t\t\tif(invoices_status.status == \"Paid\"){\n\t\t\t\t\t\t\tposInvoice.outstanding_amount = 0\n\t\t\t\t\t\t\tposInvoice.paid_amount        = invoice.total\n\t\t\t\t\t\t\tposInvoice.grand_paid_amount  = invoice.total\n\t\t\t\t\t\t\tposInvoice.status             = 'Paid'\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.db.updatePosInvoice(posInvoice)\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t})\n\t\t})\n\n\t\treturn rest\n\t}\n\n\tasync getAllOpenedPosInvoice(){\n\t\treturn await this.db.getAllOpenedPosInvoice()\n\t}\n\n\tasync deletePosInvoice_callback(invoiceName,onSuccess,onFailure){\n\t\tthis.db.deletePosInvoice_callback(\n\t\t\tinvoiceName,\n\t\t\tonSuccess,\n\t\t\tonFailure\n\t\t)\n\t}\n\t/******************  function ***************************/\n\tcombineLocalAndUpdated(local,updated){\n\t\t// Create a map from the local data array using a unique identifier (name)\n\t\tconst combinedMap = new Map(local.map(item => [item.name, item]));\n\t\t// Loop through each item in the updated data\n\t\tthis.appData.deleted_documents.forEach(deleted=>{\n\t\t\tcombinedMap.delete( deleted.name )\n\t\t})\n\t\tupdated.forEach(updatedItem=>{\n\t\t\tcombinedMap.set(updatedItem.name , updatedItem)\n\t\t})\n\n\t\treturn Array.from(combinedMap.values())\n\t}\n\n}\n", "pos_ar.PointOfSale.FetchHandler = class FetchHandler{\n\n\tconstructor(){\n\n\t\tconsole.log(\"testing4\")\n\t}\n\n\n\tasync fetchCustomers(since) {\n\t\ttry {\n\t\t\tconst filter = { disabled : 0}\n\t\t\t/*if(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}*/\n\t\t\treturn await frappe.db.get_list('Customer', {\n                fields: ['name' , 'customer_name' , 'custom_debt' , 'default_price_list' ],\n\t\t\t\tfilters: filter,\n\t\t\t\tlimit : 100000,\n\t\t\t\torder_by : \"customer_name ASC\"\n\t\t\t})\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching customers:', error);\n\t\t\treturn []\n\t\t}\n\t}\n\n\n\tasync fetchBrands(since) {\n\t\ttry {\n\t\t\tconst filter = {}\n\t\t\t/*if(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}*/\n\t\t\treturn await frappe.db.get_list('Brand', {\n\t\t\t\tfields: ['brand' ],\n\t\t\t\tfilters: filter,\n\t\t\t\tlimit : 100000\n\t\t\t})\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching customers:', error);\n\t\t\treturn []\n\t\t}\n\t}\n\n\tasync fetchItemGroups(since) {\n\t\ttry {\n\t\t\tconst filter = {}\n\t\t\t/*if(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}*/\n\t\t\treturn await frappe.db.get_list('Item Group', {\n\t\t\t\tfields: ['name', 'item_group_name' , 'parent_item_group' , 'is_group' ],\n\t\t\t\tfilters: filter,\n\t\t\t\tlimit : 100000,\n\t\t\t\torder_by: 'item_group_name ASC',\n\t\t\t})\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching Item Group :', error);\n\t\t\treturn []\n\t\t}\n\t}\n\n\n\tasync fetchItems(since) {\n\t\ttry {\n\t\t\tconst filter = {disabled : 0}\n\t\t\t/*if(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}*/\n\t\t\treturn await frappe.db.get_list('Item', {\n\t\t\t\tfields: ['name', 'item_name' , 'image' , 'brand' ,'item_group' , 'description' , 'stock_uom' , 'barcodes' ],\n\t\t\t\tfilters: filter,\n\t\t\t\tlimit : 100000,\n\t\t\t\torder_by: 'item_name ASC',\n\t\t\t})\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching Item Group :', error);\n\t\t\treturn []\n\t\t}\n\t}\n\n\n\n\tasync fetchItemBarCodes() {\n\t\ttry {\n\t\t\tconst response = await frappe.call({\n\t\t\t\tmethod: 'pos_ar.pos_ar.doctype.pos_info.pos_info.get_item_barcodes',\n\t\t\t\targs: { }\n\t\t\t});\n\t\t\treturn response.message;  // The fetched item barcodes\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching Item Barcodes:', error);\n\t\t\treturn [];\n\t\t}\n\t}\n\n\n\tasync fetchCustomerDebt( name ) {\n\t\ttry {\n\t\t\tconst response = await frappe.call({\n\t\t\t\tmethod: 'pos_ar.pos_ar.doctype.pos_info.pos_info.get_customer_debt',\n\t\t\t\targs: { name }\n\t\t\t});\n\t\t\treturn response.message;  // The fetched item barcodes\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching Item Barcodes:', error);\n\t\t\treturn [];\n\t\t}\n\t}\n\n\n\n\tasync fetchItemPrice(since) {\n\t\ttry {\n\t\t\tconst filter = {}\n\t\t\t/*if(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}*/\n\t\t\treturn await frappe.db.get_list('Item Price', {\n\t\t\t\tfields: ['name', 'item_code' , 'item_name' , 'price_list', 'price_list_rate' , 'brand'],\n\t\t\t\tfilters: filter,\n\t\t\t\tlimit : 100000\n\t\t\t})\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching Item Group :', error);\n\t\t\treturn []\n\t\t}\n\t}\n\n\n\tasync fetchPriceList(since) {\n\t\ttry {\n\t\t\tconst filter = {selling : 1 , enabled : 1}\n\t\t\t/*if(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}*/\n\t\t\treturn await frappe.db.get_list('Price List', {\n\t\t\t\tfields: ['name', 'price_list_name' , 'currency' ],\n\t\t\t\tfilters: filter,\n\t\t\t\tlimit : 100000\n\t\t\t})\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching Item Group :', error);\n\t\t\treturn []\n\t\t}\n\t}\n\n\n\tasync fetchWarehouseList(since){\n\t\ttry{\n\t\t\tconst filter = {}\n\t\t\t/*if(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}*/\n\t\t\treturn await frappe.db.get_list('Warehouse' , {\n\t\t\t\tfields  : ['name' , 'warehouse_name'],\n\t\t\t\tfilters : filter,\n\t\t\t\tlimit : 100000\n\t\t\t})\n\t\t}\n\t\tcatch(error){\n\t\t\tconsole.error('Error fetching Warehouse list : ' , error)\n\t\t\treturn [];\n\t\t}\n\t}\n\n\n\tasync fetchPosProfile(){\n\t\ttry{\n\t\t\tconst filter = {disabled : 0}\n\t\t\t/*if(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}*/\n\t\t\tconst pos = await frappe.db.get_list('POS Profile' , {\n\t\t\t\tfields  : ['name'],\n\t\t\t\tfilters : filter ,\n\t\t\t\tlimit   : 1\n\t\t\t})\n\t\t\tconst r = await frappe.db.get_doc('POS Profile', pos[0].name  )\n\t\t\treturn r\n\t\t}\n\t\tcatch(error){\n\t\t\tconsole.error('Error fetching pos profile list : ' , error)\n\t\t\treturn null;\n\t\t}\n\t}\n\n\n\n\tasync fetchPosProfileModeOfPayments(modeOfPaymentsIds , company) {\n\t\ttry {\n\t\t\tconst response = await frappe.call({\n\t\t\t\tmethod: 'pos_ar.pos_ar.doctype.pos_info.pos_info.get_mode_of_payments',\n\t\t\t\targs: { }\n\t\t\t});\n\t\t\treturn response.message;  // The fetched item barcodes\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching mode_of_payments', error);\n\t\t\treturn [];\n\t\t}\n\t}\n\n\n\n\n\tasync fetchCompany(companyId){\n\t\ttry{\n\t\t\treturn await frappe.db.get_doc('Company' , companyId)\n\t\t}\n\t\tcatch(error){\n\t\t\tconsole.error('Error fetching company by companyId from the profile list : ' , error)\n\t\t\treturn [];\n\t\t}\n\t}\n\n\tasync fetchSalesTaxesAndChargesTemplate(templateId){\n\t\ttry{\n\t\t\treturn await frappe.db.get_doc('Sales Taxes and Charges Template' , templateId)\n\t\t}\n\t\tcatch(error){\n\t\t\tconsole.error('Error fetching Warehouse list : ' , error)\n\t\t\treturn [];\n\t\t}\n\t}\n\n\tasync fetchBinList(since){\n\t\ttry{\n\t\t\tconst filter = {}\n\t\t\t/*if(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}*/\n\t\t\treturn await frappe.db.get_list('Bin' , {\n\t\t\t\tfields  : ['name' , 'actual_qty' , 'item_code' , 'warehouse'],\n\t\t\t\tfilters : filter,\n\t\t\t\tlimit   : 1\n\t\t\t})\n\t\t}\n\t\tcatch(error){\n\t\t\tconsole.error('Error fetching Bin list : ' , error)\n\t\t\treturn [];\n\t\t}\n\t}\n\n\tasync fetchDeletedDocs(since) {\n\t\ttry {\n\t\t\tconst filter = {}\n\t\t\tif(since){\n\t\t\t\tfilter.modified = ['>',since]\n\t\t\t}\n\t\t\treturn await frappe.db.get_list('Deleted Document', {\n\t\t\t\tfields: ['name', 'deleted_name'  ,'deleted_doctype' , 'restored' ],\n\t\t\t\tfilters: filter,\n\t\t\t\tlimit : 100000\n\t\t\t})\n\t\t} catch (error) {\n\t\t\tconsole.error('Error fetching deleted documents :', error);\n\t\t\treturn []\n\t\t}\n\t\treturn []\n\t}\n\n\n\tasync fetchDebts(customer_name) {\n\t\ttry {\n\t\t\tconst response = await frappe.call({\n\t\t\t\tmethod: \"pos_ar.pos_ar.doctype.pos_info.pos_info.get_customer_debts\",\n\t\t\t\targs: { customer_name },\n\t\t\t});\n\n\t\t\tif (response.message && !response.message.error) {\n\t\t\t\treturn response.message\n\t\t\t} else {\n\t\t\t\treturn []\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Error fetching debts:\", error);\n\t\t\tfrappe.msgprint(__('Error fetching debts.'));\n\t\t}\n\t}\n\n\tasync fetchDebtsSalesInvoices(customer_name) {\n\t\ttry {\n\t\t\tconst response = await frappe.call({\n\t\t\t\tmethod: \"pos_ar.pos_ar.doctype.pos_info.pos_info.get_customer_debts_sales_invoices\",\n\t\t\t\targs: { customer_name },\n\t\t\t});\n\n\t\t\tif (response.message && !response.message.error) {\n\t\t\t\tconsole.log(\"customer debts : \" , response.message)\n\t\t\t\treturn response.message\n\t\t\t} else {\n\t\t\t\treturn []\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Error fetching debts:\", error);\n\t\t\tfrappe.msgprint(__('Error fetching debts.'));\n\t\t}\n\t}\n\n\n\n\n\tasync update_invoice_payment(invoice_name , payment_amount) {\n\t\ttry {\n\t\t\tconst response = await frappe.call({\n\t\t\t\tmethod: \"pos_ar.pos_ar.doctype.pos_info.pos_info.update_invoice_payment\",\n\t\t\t\targs: { invoice_name , payment_amount },\n\t\t\t});\n\t\t\tif (response.message && !response.message.error) {\n\t\t\t\treturn response.message\n\t\t\t} else {\n\t\t\t\treturn []\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Error fetching debts:\", error);\n\t\t\tfrappe.msgprint(__('Error fetching debts.'));\n\t\t}\n\t}\n\n\n\tasync update_sales_invoice_payment(invoice_name , payment_amount) {\n\t\ttry {\n\t\t\tconst response = await frappe.call({\n\t\t\t\tmethod: \"pos_ar.pos_ar.doctype.pos_info.pos_info.update_sales_invoice_payment\",\n\t\t\t\targs: { invoice_name , payment_amount },\n\t\t\t});\n\t\t\tif (response.message && !response.message.error) {\n\t\t\t\treturn response.message\n\t\t\t} else {\n\t\t\t\treturn []\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Error fetching debts:\", error);\n\t\t\tfrappe.msgprint(__('Error fetching debts.'));\n\t\t}\n\t}\n\n\tasync pay_selected_invoice(invoices , payment_amount) {\n\t\ttry {\n\t\t\tconst response = await frappe.call({\n\t\t\t\tmethod: \"pos_ar.pos_ar.doctype.pos_info.pos_info.pay_selected_invoice\",\n\t\t\t\targs: { invoices , payment_amount },\n\t\t\t});\n\t\t\tif (response.message && !response.message.error) {\n\t\t\t\treturn response.message\n\t\t\t} else {\n\t\t\t\treturn []\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.error(\"Error fetching debts:\", error);\n\t\t\tfrappe.msgprint(__('Error fetching debts.'));\n\t\t}\n\t}\n\n\n}\n", "pos_ar.PointOfSale.ScreenManager  = class {\n\n    constructor(settings_data) {\n\t\tthis.settings_data = settings_data;\n\n        this.screens = new Map();\n        this.activeScreen = null;\n    }\n\n    registerScreen(screenId, screenComponent) {\n        this.screens.set(screenId, screenComponent);\n    }\n\n    navigate(screenId) {\n        console.log(\"debuging 1 \" , screenId)\n\n        switch (screenId) {\n            case 'history_cart':\n                console.log(\"history_cart\")\n                //show\n\t\t\t    this.history_cart.show_cart()\n                this.customer_box.showHomeBar();\n                //hide\n\t\t\t    this.payment_cart.hideCart();\n\t\t\t    this.item_details.hide_cart();\n                this.item_selector.hideCart();\n                this.selected_item_cart.hideCart();\n\t\t\t    this.customer_box.hideSyncBar();\n                this.settings_cart.hideCart();\n\t\t\t    this.check_in_out_cart.hideCart();\n                this.debt_cart.hideCart();\n                this.unsynced_pos_cart.hide_cart();\n                break;\n            case 'settings_cart':\n                //show settings\n\t\t\t    this.settings_cart.showCart()\n    \t\t\tthis.customer_box.showHomeBar();\n\t    \t\t//hide\n\t\t    \tthis.item_selector.hideCart();\n\t\t\t    this.selected_item_cart.hideCart();\n    \t\t\tthis.item_details.hide_cart() ;\n\t    \t\tthis.payment_cart.hideCart()  ;\n\t\t    \tthis.history_cart.hide_cart() ;\n                this.check_in_out_cart.hideCart();\n    \t\t\tthis.debt_cart.hideCart();\n                this.unsynced_pos_cart.hide_cart();\n                //hide section\n                this.customer_box.hideSyncBar();\n                break;\n            case 'check_in_out_cart':\n                //show\n                this.check_in_out_cart.showCart();\n                this.customer_box.showHomeBar();\n\n                //hide\n                this.item_selector.hideCart();\n                this.selected_item_cart.hideCart();\n    \t\t\tthis.item_details.hide_cart() ;\n\t    \t\tthis.payment_cart.hideCart()  ;\n\t\t    \tthis.history_cart.hide_cart() ;\n\t\t\t    this.settings_cart.hideCart() ;\n                this.debt_cart.hideCart();\n                this.unsynced_pos_cart.hide_cart();\n\n                //hide section\n                this.customer_box.hideSyncBar();\n                break;\n            case 'home':\n                //show\n\t\t        this.item_selector.showCart()      ;\n\t\t        this.customer_box.showSyncBar()    ;\n        \t\tthis.selected_item_cart.showCart() ;\n\n\t     \t    //hide\n    \t    \tthis.payment_cart.hideCart()   ;\n        \t\tthis.customer_box.hideHomeBar();\n    \t    \tthis.item_details.hide_cart()  ;\n\t    \t    this.history_cart.hide_cart()  ;\n    \t\t    this.settings_cart.hideCart()  ;\n    \t    \tthis.debt_cart.hideCart();\n\t    \t    this.check_in_out_cart.hideCart();\n\t\t\t\tif(this.settings_data.settings.showItemDetails){\n\t\t\t\t\tthis.selected_item_cart.hideKeyboard();\n\t\t\t\t}\n                this.unsynced_pos_cart.hide_cart();\n\n\t\t\t\t//update ui\n\t\t\t\tthis.selected_item_cart.setKeyboardOrientation(\"portrait\");\n\t\t\t\tthis.selected_item_cart.cleanHeighlight();\n\n\t\t\t\t//refresh the data :\n\t\t\t\tthis.selected_item_cart.refreshTabs()\n\t\t\t\tthis.selected_item_cart.refreshSelectedItem()\n\n                break;\n\t\t\tcase 'debt_cart':\n                //show\n                this.debt_cart.showCart();\n                this.customer_box.showHomeBar();\n\n                //hide\n                this.item_selector.hideCart();\n                this.selected_item_cart.hideCart();\n                this.item_details.hide_cart();\n                this.history_cart.hide_cart();\n                this.settings_cart.hideCart();\n\t\t\t\tthis.payment_cart.hideCart();\n                this.check_in_out_cart.hideCart();\n                this.unsynced_pos_cart.hide_cart();\n                break;\n\t\t\tcase 'payment_cart':\n                //show\n\t\t\t\tthis.payment_cart.showCart();\n                //hide\n                this.item_selector.hideCart();\n                this.item_details.hide_cart();\n                this.settings_cart.hideCart();\n                this.debt_cart.hideCart();\n\t\t\t\t//change displayk\n\t\t\t\tthis.payment_cart.calculateGrandTotal()\n                this.selected_item_cart.setKeyboardOrientation(\"landscape\");\n                this.selected_item_cart.cleanHeighlight();\n                this.selected_item_cart.showKeyboard();\n                this.unsynced_pos_cart.hide_cart();\n                break;\n\t\t\tcase 'item_details':\n\t\t\t\t//show details depend on settings\n\t\t\t\tif(this.settings_data.settings.showItemDetails){\n\t\t\t\t\tthis.item_details.show_cart();\n                this.item_selector.hideCart();\n\t\t\t\t\tthis.selected_item_cart.showKeyboard();\n\t\t\t\t\t//close\n\t\t\t\t\tthis.payment_cart.hideCart();\n                this.settings_cart.hideCart();\n                this.unsynced_pos_cart.hide_cart();\n\n                //change display\n                this.selected_item_cart.setKeyboardOrientation(\"landscape\");\n\t\t\t\t}\n\n                this.selected_item_cart.makeSelectedButtonHighlighted();\n\n                break;\n            case 'unsynced_pos_cart':\n                //show\n                this.unsynced_pos_cart.show_cart();\n    \t\t\tthis.customer_box.showHomeBar();\n                //hide\n                this.history_cart.hide_cart()      ;\n                this.check_in_out_cart.hideCart()  ;\n\t\t\t\tthis.item_selector.hideCart()      ;\n\t\t        this.customer_box.hideSyncBar()    ;\n        \t\tthis.selected_item_cart.hideCart() ;\n\t\t\t\tthis.payment_cart.hideCart();\n                this.item_selector.hideCart();\n                this.item_details.hide_cart();\n                this.settings_cart.hideCart();\n                this.debt_cart.hideCart();\n\t\t\t\t//change displayk\n\t\t\t\tthis.payment_cart.calculateGrandTotal()\n\t\t\t\tthis.selected_item_cart.setKeyboardOrientation(\"landscape\");\n\t\t\t\tthis.selected_item_cart.cleanHeighlight();\n\t\t\t\tthis.selected_item_cart.showKeyboard();\n\t\n                break;\n            default:\n                break;\n        }\n\n        // Hide all screens first\n        //this.screens.forEach(screen => screen.hideCart());\n        \n        // Show the requested screen\n        //const targetScreen = this.screens.get(screenId);\n        //if (targetScreen) {\n        //    targetScreen.showCart();\n        //    this.activeScreen = screenId;\n        //}\n    }\n}"],
  "mappings": "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",
  "names": ["event", "newValue", "itemPrice", "event", "event", "event", "itemPrice", "event", "field", "itemPrice", "bin", "event", "event", "customer", "event", "itemPrice", "event", "tab", "event", "event", "header"]
}
